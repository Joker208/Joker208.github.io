<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Joker208çš„åšå®¢</title>
  <subtitle>æœ‰æ¢¦æƒ³çš„å’¸é±¼</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://jiaotingyu.me/"/>
  <updated>2020-05-19T08:40:18.712Z</updated>
  <id>http://jiaotingyu.me/</id>
  
  <author>
    <name>Joker208</name>
    <email>772090298@qq.com</email>
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Golang Docker host</title>
    <link href="http://jiaotingyu.me/2020/05/16/Golang%20docker%20host/"/>
    <id>http://jiaotingyu.me/2020/05/16/Golang docker host/</id>
    <published>2020-05-15T16:00:00.000Z</published>
    <updated>2020-05-19T08:40:18.712Z</updated>
    
    <content type="html"><![CDATA[<h3 id="é—®é¢˜æè¿°"><a href="#é—®é¢˜æè¿°" class="headerlink" title="é—®é¢˜æè¿°"></a><strong>é—®é¢˜æè¿°</strong></h3><p>åœ¨dockerçš„alpineå®¹å™¨ä¸­ä½¿ç”¨httpclientå‘å¦ä¸€ä¸ªå®¹å™¨å‘èµ·httpè¯·æ±‚</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">response, err := httpClient.Do(request)</div></pre></td></tr></table></figure>
<p>ç¨‹åºåº”è¯¥ä¼šä½¿ç”¨/etc/hostsä¸­é…ç½®çš„IPï¼Œä½†å®é™…ä½¿å¹¶æ²¡æœ‰ï¼Œå¯¼è‡´æ²¡æœ‰è¿”å›ç»“æœ</p>
<p>ç»æŸ¥è¯å‘ç°ç¨‹åºä½¿ç”¨äº†ä»dns serverä¸­æŸ¥è¯¢åˆ°çš„ip</p>
<a id="more"></a>
<h3 id="è§£å†³æ–¹æ³•"><a href="#è§£å†³æ–¹æ³•" class="headerlink" title="è§£å†³æ–¹æ³•"></a><strong>è§£å†³æ–¹æ³•</strong></h3><p>è¿›å…¥å®¹å™¨æ·»åŠ nsswitch.confæ–‡ä»¶</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">echo &quot;hosts: files dns&quot; &gt; /etc/nsswitch.conf</div></pre></td></tr></table></figure>
<p>é—®é¢˜åŸå› </p>
<p>golangç¨‹åºè§£æåŸŸåæ—¶é»˜è®¤ä½¿ç”¨/etc/nsswitch.confæ–‡ä»¶ä¸­çš„è§£æé¡ºåºï¼Œå¦‚æœnsswitch.confæ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ™ä¼˜å…ˆä½¿ç”¨dnsæœåŠ¡å™¨è§£æåŸŸå</p>
<p>golangç¨‹åºè§£æåŸŸåæ—¶æŒ‰ç…§etc/nsswitch.confæ–‡ä»¶ä¸­çš„é¡ºåºè§£æï¼Œå¦‚æœnsswitch.confä¸å­˜åœ¨ï¼Œåˆ™ä¼˜å…ˆä½¿ç”¨dnsè§£æåŸŸå</p>
<blockquote>
<p><strong>å‚è€ƒèµ„æ–™</strong></p>
<p><a href="https://github.com/golang/go/issues/22846" target="_blank" rel="external">https://github.com/golang/go/issues/22846</a></p>
<p><a href="https://www.lijiaocn.com/é—®é¢˜/2017/11/09/problem-docker-not-use-hosts-file.html" target="_blank" rel="external">https://www.lijiaocn.com/%E9%97%AE%E9%A2%98/2017/11/09/problem-docker-not-use-hosts-file.html</a></p>
<p><a href="https://blog.csdn.net/u010278923/article/details/79179779" target="_blank" rel="external">https://blog.csdn.net/u010278923/article/details/79179779</a></p>
<p><a href="https://blog.csdn.net/huangruifeng/article/details/96594065" target="_blank" rel="external">https://blog.csdn.net/huangruifeng/article/details/96594065</a></p>
</blockquote>
]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;é—®é¢˜æè¿°&quot;&gt;&lt;a href=&quot;#é—®é¢˜æè¿°&quot; class=&quot;headerlink&quot; title=&quot;é—®é¢˜æè¿°&quot;&gt;&lt;/a&gt;&lt;strong&gt;é—®é¢˜æè¿°&lt;/strong&gt;&lt;/h3&gt;&lt;p&gt;åœ¨dockerçš„alpineå®¹å™¨ä¸­ä½¿ç”¨httpclientå‘å¦ä¸€ä¸ªå®¹å™¨å‘èµ·httpè¯·æ±‚&lt;/p&gt;
&lt;figure class=&quot;highlight go&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;response, err := httpClient.Do(request)&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;ç¨‹åºåº”è¯¥ä¼šä½¿ç”¨/etc/hostsä¸­é…ç½®çš„IPï¼Œä½†å®é™…ä½¿å¹¶æ²¡æœ‰ï¼Œå¯¼è‡´æ²¡æœ‰è¿”å›ç»“æœ&lt;/p&gt;
&lt;p&gt;ç»æŸ¥è¯å‘ç°ç¨‹åºä½¿ç”¨äº†ä»dns serverä¸­æŸ¥è¯¢åˆ°çš„ip&lt;/p&gt;
    
    </summary>
    
      <category term="æŠ€æœ¯" scheme="http://jiaotingyu.me/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
      <category term="Golang" scheme="http://jiaotingyu.me/tags/Golang/"/>
    
      <category term="Docker" scheme="http://jiaotingyu.me/tags/Docker/"/>
    
      <category term="host" scheme="http://jiaotingyu.me/tags/host/"/>
    
  </entry>
  
  <entry>
    <title>gorm save updateåŒºåˆ«</title>
    <link href="http://jiaotingyu.me/2020/03/23/gorm%20save%20update%E5%8C%BA%E5%88%AB/"/>
    <id>http://jiaotingyu.me/2020/03/23/gorm save updateåŒºåˆ«/</id>
    <published>2020-03-22T16:00:00.000Z</published>
    <updated>2020-05-19T08:37:42.391Z</updated>
    
    <content type="html"><![CDATA[<p>åœ¨ç¨‹åºé‡Œä½¿ç”¨gormçš„updateæ›´æ–°æ•°æ®çš„æ—¶å€™ï¼Œå‘ç°æœ‰éƒ¨åˆ†æ•°æ®æ²¡æœ‰ä¿®æ”¹æˆåŠŸã€‚</p>
<p>å½“ä½¿ç”¨<strong>Updates</strong>æ›´æ–°ç»“æ„ä½“çš„æ—¶å€™ï¼Œå½“ç»“æ„ä½“çš„å€¼æ˜¯â€â€æˆ–è€…0ï¼Œfalseç­‰ï¼Œè¿™äº›å€¼ä¼šè¢«å¿½ç•¥æ‰ã€‚</p>
<p>å¦‚æœéœ€è¦æ›´æ–°å…¨éƒ¨å­—æ®µå»ºè®®ä½¿ç”¨<strong>Save</strong>æ–¹æ³•ã€‚</p>
<a id="more"></a>
<p>ä¸‹é¢æ˜¯å®˜æ–¹çš„è¯´æ˜æ–‡æ¡£ï¼š</p>
<p><strong>Update Changed Fields</strong></p>
<p>If you only want to update changed Fields, you could use <strong>Update</strong>, <strong>Updates</strong></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Update single attribute if it is changed </span></div><div class="line">db.Model(&amp;user).Update(<span class="string">"name"</span>, <span class="string">"hello"</span>) </div><div class="line"><span class="comment">//// UPDATE users SET name='hello', updated_at='2013-11-17 21:34:10' WHERE id=111; </span></div><div class="line"></div><div class="line"><span class="comment">// Update single attribute with combined conditions </span></div><div class="line">db.Model(&amp;user).Where(<span class="string">"active = ?"</span>, <span class="literal">true</span>).Update(<span class="string">"name"</span>, <span class="string">"hello"</span>) </div><div class="line"><span class="comment">//// UPDATE users SET name='hello', updated_at='2013-11-17 21:34:10' WHERE id=111 AND active=true; </span></div><div class="line"></div><div class="line"><span class="comment">// Update multiple attributes with `map`, will only update those changed fields</span></div><div class="line">db.Model(&amp;user).Updates(<span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">interface</span>&#123;&#125;&#123;<span class="string">"name"</span>: <span class="string">"hello"</span>, <span class="string">"age"</span>: <span class="number">18</span>, <span class="string">"actived"</span>: <span class="literal">false</span>&#125;) </div><div class="line"><span class="comment">//// UPDATE users SET name='hello', age=18, actived=false, updated_at='2013-11-17 21:34:10' WHERE id=111; </span></div><div class="line"></div><div class="line"><span class="comment">// Update multiple attributes with `struct`, will only update those changed &amp; non blank fields </span></div><div class="line">db.Model(&amp;user).Updates(User&#123;Name: <span class="string">"hello"</span>, Age: <span class="number">18</span>&#125;) </div><div class="line"><span class="comment">//// UPDATE users SET name='hello', age=18, updated_at = '2013-11-17 21:34:10' WHERE id = 111; </span></div><div class="line"></div><div class="line"><span class="comment">// WARNING when update with struct, GORM will only update those fields that with non blank value </span></div><div class="line"><span class="comment">// For below Update, nothing will be updated as "", 0, false are blank values of their types </span></div><div class="line">db.Model(&amp;user).Updates(User&#123;Name: <span class="string">""</span>, Age: <span class="number">0</span>, Actived: <span class="literal">false</span>&#125;)</div></pre></td></tr></table></figure>
<p><u><strong>// WARNING when update with struct, GORM will only update those fields that with non blank value</strong></u></p>
<p><u><strong>// For below Update, nothing will be updated as â€œâ€, 0, false are blank values of their types</strong></u></p>
<p>å½“ç”¨ç»“æ„ä½“æ›´æ–°çš„æ—¶å€™ï¼Œå½“ç»“æ„ä½“çš„å€¼æ˜¯â€â€æˆ–è€…0ï¼Œfalseç­‰ï¼Œè¿™äº›å€¼ä¼šè¢«å¿½ç•¥æ‰ã€‚</p>
<p>å¦‚æœéœ€è¦æ›´æ–°å…¨éƒ¨å­—æ®µå»ºè®®ä½¿ç”¨saveæ–¹æ³•</p>
<p><strong>Update All Fields</strong></p>
<p><strong>Save</strong> will include all fields when perform the Updating SQL, even it is not changed</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">db.First(&amp;user) </div><div class="line">user.Name = <span class="string">"jinzhu 2"</span> </div><div class="line">user.Age = <span class="number">100</span> </div><div class="line">db.Save(&amp;user) </div><div class="line"><span class="comment">//// UPDATE users SET name='jinzhu 2', age=100, birthday='2016-01-01', updated_at = '2013-11-17 21:34:10' WHERE id=11</span></div></pre></td></tr></table></figure>
<blockquote>
<p><strong>å‚è€ƒèµ„æ–™</strong></p>
<p>å®˜æ–¹æ–‡æ¡£ï¼š<a href="http://gorm.io/docs/update.html" target="_blank" rel="external">http://gorm.io/docs/update.html</a></p>
<p><a href="https://www.jianshu.com/p/e8502adac645" target="_blank" rel="external">https://www.jianshu.com/p/e8502adac645</a></p>
<p><a href="https://www.cnblogs.com/oxspirt/p/11240527.html" target="_blank" rel="external">https://www.cnblogs.com/oxspirt/p/11240527.html</a></p>
</blockquote>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;åœ¨ç¨‹åºé‡Œä½¿ç”¨gormçš„updateæ›´æ–°æ•°æ®çš„æ—¶å€™ï¼Œå‘ç°æœ‰éƒ¨åˆ†æ•°æ®æ²¡æœ‰ä¿®æ”¹æˆåŠŸã€‚&lt;/p&gt;
&lt;p&gt;å½“ä½¿ç”¨&lt;strong&gt;Updates&lt;/strong&gt;æ›´æ–°ç»“æ„ä½“çš„æ—¶å€™ï¼Œå½“ç»“æ„ä½“çš„å€¼æ˜¯â€â€æˆ–è€…0ï¼Œfalseç­‰ï¼Œè¿™äº›å€¼ä¼šè¢«å¿½ç•¥æ‰ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœéœ€è¦æ›´æ–°å…¨éƒ¨å­—æ®µå»ºè®®ä½¿ç”¨&lt;strong&gt;Save&lt;/strong&gt;æ–¹æ³•ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="æŠ€æœ¯" scheme="http://jiaotingyu.me/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
      <category term="Golang" scheme="http://jiaotingyu.me/tags/Golang/"/>
    
      <category term="gorm" scheme="http://jiaotingyu.me/tags/gorm/"/>
    
  </entry>
  
  <entry>
    <title>ERROR 2059(HY000) Authentication plugin &#39;caching_sha2_password&#39; cannot be loaded</title>
    <link href="http://jiaotingyu.me/2020/03/18/ERROR%202059/"/>
    <id>http://jiaotingyu.me/2020/03/18/ERROR 2059/</id>
    <published>2020-03-17T16:00:00.000Z</published>
    <updated>2020-05-19T08:47:40.784Z</updated>
    
    <content type="html"><![CDATA[<p>å‡ºç°è¿™ä¸ªåŸå› æ˜¯mysql8 ä¹‹å‰çš„ç‰ˆæœ¬ä¸­åŠ å¯†è§„åˆ™æ˜¯mysql_native_passwordï¼Œè€Œåœ¨mysql8ä¹‹å,åŠ å¯†è§„åˆ™æ˜¯caching_sha2_passwordï¼Œè§£å†³é—®é¢˜æ–¹æ³•æœ‰ä¸¤ç§ï¼Œä¸€ç§æ˜¯å‡çº§navicaté©±åŠ¨ï¼Œä¸€ç§æ˜¯æŠŠmysqlç”¨æˆ·ç™»å½•å¯†ç åŠ å¯†è§„åˆ™è¿˜åŸæˆmysql_native_passwordã€‚</p>
<a id="more"></a>
<h3 id="é—®é¢˜ï¼š"><a href="#é—®é¢˜ï¼š" class="headerlink" title="é—®é¢˜ï¼š"></a>é—®é¢˜ï¼š</h3><p>è¿æ¥Dockerå¯åŠ¨çš„mysqlå‡ºç°ï¼š<strong>ERROR 2059 (HY000): Authentication plugin â€˜caching_sha2_passwordâ€™ cannot be loaded</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">C:\mysqldata&gt;mysql -h 127.0.0.1 -P 13306 -uroot -p</div><div class="line">Enter password: ****</div><div class="line"></div><div class="line">ERROR 2059 (HY000): Authentication plugin &apos;caching_sha2_password&apos; cannot be loaded: Ã•Ã’Â²Â»ÂµÂ½Ã–Â¸Â¶Â¨ÂµÃ„Ã„Â£Â¿Ã©Â¡Â£</div></pre></td></tr></table></figure>
<p>è§£å†³ä¹Ÿå¾ˆç®€å•</p>
<h3 id="è§£å†³æ–¹æ¡ˆï¼š"><a href="#è§£å†³æ–¹æ¡ˆï¼š" class="headerlink" title="è§£å†³æ–¹æ¡ˆï¼š"></a>è§£å†³æ–¹æ¡ˆï¼š</h3><ol>
<li>è¿›å…¥mysqlå®¹å™¨</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">docker exec -it mysql01 /bin/bash</div></pre></td></tr></table></figure>
<ol>
<li>è¿›å…¥mysql</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mysql -uroot -pxxx</div></pre></td></tr></table></figure>
<ol>
<li>ä¿®æ”¹å¯†ç </li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ALTER USER &apos;root&apos;@&apos;%&apos; IDENTIFIED WITH mysql_native_password BY &apos;xxxx&apos;;</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å‡ºç°è¿™ä¸ªåŸå› æ˜¯mysql8 ä¹‹å‰çš„ç‰ˆæœ¬ä¸­åŠ å¯†è§„åˆ™æ˜¯mysql_native_passwordï¼Œè€Œåœ¨mysql8ä¹‹å,åŠ å¯†è§„åˆ™æ˜¯caching_sha2_passwordï¼Œè§£å†³é—®é¢˜æ–¹æ³•æœ‰ä¸¤ç§ï¼Œä¸€ç§æ˜¯å‡çº§navicaté©±åŠ¨ï¼Œä¸€ç§æ˜¯æŠŠmysqlç”¨æˆ·ç™»å½•å¯†ç åŠ å¯†è§„åˆ™è¿˜åŸæˆmysql_native_passwordã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="æŠ€æœ¯" scheme="http://jiaotingyu.me/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
      <category term="MySQL" scheme="http://jiaotingyu.me/tags/MySQL/"/>
    
  </entry>
  
  <entry>
    <title>openvpné…ç½®</title>
    <link href="http://jiaotingyu.me/2020/03/16/openvpn%E9%85%8D%E7%BD%AE/"/>
    <id>http://jiaotingyu.me/2020/03/16/openvpné…ç½®/</id>
    <published>2020-03-15T16:00:00.000Z</published>
    <updated>2020-05-19T08:19:14.440Z</updated>
    
    <content type="html"><![CDATA[<p>æ­å»ºå¥½æœåŠ¡å™¨ä»¥åéœ€è¦ç»å¸¸ç»´æŠ¤ï¼Œæœ‰æ—¶å€™æœåŠ¡å™¨å¾ˆéš¾è¿œç¨‹è®¿é—®åˆ°ï¼Œå¯ä»¥æ­å»ºopenVPNä»£ç†ï¼Œè¿™æ ·ç»´æŠ¤æœåŠ¡å™¨å°±å¾ˆæ–¹ä¾¿äº†ï¼Œè¿™é‡Œä»‹ç»ä¸€ä¸‹openVPNå®¢æˆ·ç«¯çš„å®‰è£…æ–¹æ³•ã€‚</p>
<a id="more"></a>
<h3 id="Windowså¹³å°"><a href="#Windowså¹³å°" class="headerlink" title="Windowså¹³å°"></a><strong>Windowså¹³å°</strong></h3><p><strong>ä¸‹è½½å®¢æˆ·ç«¯</strong></p>
<ul>
<li><a href="https://openvpn.net/community-downloads/" target="_blank" rel="external">å®˜æ–¹ä¸‹è½½åœ°å€é¡µé¢</a></li>
</ul>
<p><strong>å®¢æˆ·ç«¯é€‰æ‹©</strong></p>
<p>å®˜ç½‘æä¾›ä¸¤ç§Windowsçš„å®¢æˆ·ç«¯ï¼Œæ ¹æ®è‡ªå·±çš„Windowsç‰ˆæœ¬å®‰è£…å³å¯</p>
<p><a href="https://swupdate.openvpn.org/community/releases/openvpn-install-2.4.8-I602-Win7.exe" target="_blank" rel="external">openvpn-install-2.4.8-I602-Win7.exe</a></p>
<p><a href="https://swupdate.openvpn.org/community/releases/openvpn-install-2.4.8-I602-Win10.exe" target="_blank" rel="external">openvpn-install-2.4.8-I602-Win10.exe</a></p>
<p><strong>å®‰è£…OpenVPN</strong></p>
<ul>
<li>åŒå‡»ä¸‹è½½å¥½çš„exeæ–‡ä»¶</li>
<li>ä¸€è·¯ä¸‹ä¸€æ­¥ç›´è‡³å®‰è£…å®Œæˆ</li>
</ul>
<p><strong>è·å–OpenVPNé…ç½®æ–‡ä»¶</strong></p>
<ul>
<li>OpenVPNçš„å®¢æˆ·ç«¯é…ç½®æ–‡ä»¶ä¸º*.ovpn</li>
<li><p>åœ¨ä½¿ç”¨è¯ä¹¦è®¤è¯çš„æƒ…å†µä¸‹ï¼Œåœ¨ovpnæ–‡ä»¶åŒä¸€ä¸ªç›®å½•ä¸‹é¢ä¼šæœ‰</p>
</li>
<li><ul>
<li>*.crt</li>
<li>*.key</li>
<li>ca.crt</li>
<li>å†å¼€å¯äº†tls-authæ—¶è¿˜ä¼šæœ‰ta.keyæ–‡ä»¶</li>
</ul>
</li>
<li><p>è¯ä¹¦æ–‡ä»¶å¯ä»¥å†…åµŒåˆ°ovpnæ–‡ä»¶ä¸­ï¼Œå› æ­¤æœ‰æ—¶å€™ä¼šåªæœ‰ä¸€ä¸ªovpnæ–‡ä»¶</p>
</li>
</ul>
<p><strong>é…ç½®æ–‡ä»¶ä½¿ç”¨æ–¹å¼</strong></p>
<p><strong>ç›´æ¥åŒå‡»ovpnæ–‡ä»¶</strong></p>
<p>Windowsç‰ˆOpenVPNå®¢æˆ·ç«¯å®‰è£…å®Œæˆä¹‹åï¼Œä¼šè‡ªåŠ¨å…³è”ovpnæ–‡ä»¶ï¼ŒåŒå‡»å³å¯æ‰“å¼€OpenVPN</p>
<p><strong>å¤åˆ¶åˆ°é…ç½®ç›®å½•</strong></p>
<p>OpenVPNé»˜è®¤ä¼šä»è¿™ä¸¤ä¸ªç›®å½•æ‰¾é…ç½®æ–‡ä»¶ï¼Œå¯ä»¥å­˜åœ¨å¤šä¸ªä¸åŒçš„ovpné…ç½®</p>
<ul>
<li>C:\Program Files\OpenVPN\config</li>
<li>C:\User\ç”¨æˆ·å\OpenVPN\configï¼ˆé€šè¿‡åŒå‡»ovpnçš„æ–¹å¼ä¼šæŠŠovpnæ‹·è´åˆ°è¿™ä¸ªç›®å½•ï¼‰</li>
</ul>
<p><strong>è¿æ¥OpenVPNæœåŠ¡å™¨</strong></p>
<ul>
<li>åŒå‡»æ¡Œé¢çš„OpenVPN GUIå›¾æ ‡</li>
<li>åœ¨ä»»åŠ¡æ å³ä¸‹è§’é€šçŸ¥æ ä¸­æ‰¾åˆ°OpenVPNçš„å›¾æ ‡ï¼Œå³é”®</li>
<li>ç‚¹å‡»è¿æ¥ï¼Œåœ¨æœ‰å¤šä¸ªovpné…ç½®æ—¶ï¼Œå¯ä»¥æ ¹æ®åå­—é€‰æ‹©ä¸åŒçš„ovpné…ç½®ï¼Œç„¶åç‚¹å‡»è¿æ¥</li>
<li>è¿æ¥è¿‡ç¨‹ä¼šå‡ºç°å¾ˆå¤šæ—¥å¿—ï¼Œè¿æ¥æˆåŠŸåï¼Œå³ä¸‹è§’ä¼šæç¤ºè¿æ¥æˆåŠŸ</li>
</ul>
<p><strong>å¼€æœºè‡ªå¯åŠ¨</strong></p>
<ul>
<li>æŠŠ <strong>ovpn</strong> é…ç½®æ–‡ä»¶æ”¾åœ¨ <strong>C:\Program Files\OpenVPN\config</strong></li>
<li>è¿è¡Œ <strong>services.msc</strong></li>
<li>æ‰¾åˆ° <strong>OpenVPNService</strong> ï¼Œç‚¹å‡» <strong>å³é”®</strong> ï¼Œé€‰æ‹© <strong>å±æ€§</strong></li>
<li>æŠŠå¯åŠ¨ç±»å‹æ”¹ä¸º <strong>è‡ªåŠ¨</strong> ï¼Œç‚¹å‡» <strong>å¯åŠ¨</strong> ï¼Œç‚¹å‡» <strong>ç¡®å®š</strong></li>
</ul>
<p><strong>Linuxå¹³å°</strong></p>
<p>è¿™é‡Œä»¥CentOS-7.7ä¸ºä¾‹ï¼ŒYUMæºè‡ªå¸¦äº†OpenVPN-2.4.8</p>
<p><strong>å®‰è£…å®¢æˆ·ç«¯</strong></p>
<p>yum install -y openvpn</p>
<p><strong>è·å–é…ç½®æ–‡ä»¶</strong></p>
<ul>
<li>CentOS-7.7å®‰è£…OpenVPNä¹‹åç³»ç»ŸæœåŠ¡ä¼šè¯†åˆ«*.confçš„æ–‡ä»¶</li>
<li>é…ç½®æ–‡ä»¶è·ŸWindowså¹³å°åªæœ‰æ‰©å±•åçš„åŒºåˆ«ï¼Œå¯ä»¥ç›´æ¥æŠŠWindowså¹³å°çš„ovpnæ–‡ä»¶æ”¹åä¸ºconfæ–‡ä»¶</li>
</ul>
<p><strong>å¤åˆ¶åˆ°é…ç½®ç›®å½•</strong></p>
<p>CentOS-7.7å®‰è£…OpenVPNä¹‹åä¼šåœ¨/etc/openvpnä¸‹åˆ›å»ºclientå’Œserverç›®å½•</p>
<p><strong>å¯åŠ¨OpenVPNå®¢æˆ·ç«¯æœåŠ¡</strong></p>
<p>ä»¥é…ç½®æ–‡ä»¶abc.confä¸ºä¾‹</p>
<p>systemctl start openvpn-client@abc.service</p>
<p><strong>å¼€æœºè‡ªå¯åŠ¨</strong></p>
<p>systemctl enable openvpn-client@abc.service</p>
<h3 id="MacOSå¹³å°"><a href="#MacOSå¹³å°" class="headerlink" title="MacOSå¹³å°"></a><strong>MacOSå¹³å°</strong></h3><p><strong>ç³»ç»Ÿè¦æ±‚</strong></p>
<ul>
<li>OS X 10.8 Mountain Lion</li>
<li>OS X 10.9 Mavericks</li>
<li>OS X 10.10 Yosemite</li>
<li>OS X 10.11 El Capitan</li>
<li>macOS 10.12 Sierra</li>
<li>macOS 10.13 High Sierra</li>
<li>macOS 10.14 Mojave</li>
</ul>
<p><strong>ä¸‹è½½å®¢æˆ·ç«¯</strong></p>
<p><a href="https://openvpn.net/vpn-server-resources/connecting-to-access-server-with-macos/" target="_blank" rel="external">å®˜ç½‘ä¸‹è½½é¡µé¢</a></p>
<p>é‡Œé¢æœ‰å‡ ä¸ªå®¢æˆ·ç«¯å¯ä»¥é€‰æ‹©</p>
<ul>
<li><a href="https://openvpn.net/downloads/openvpn-connect-v2-macos.dmg" target="_blank" rel="external">OpenVPN Connect Client for macOS version 2.7.1.100</a></li>
<li><a href="https://openvpn.net/downloads/openvpn-connect-v3-macos.dmg" target="_blank" rel="external">OpenVPN Connect for macOS version 3.1.0 (885) beta</a></li>
<li><a href="https://tunnelblick.net/downloads.html" target="_blank" rel="external">Tunnelblick</a></li>
</ul>
<p>ä»¥ä¸Šä¸‹è½½åˆ°çš„éƒ½æ˜¯dmgæ–‡ä»¶ï¼Œç›´æ¥å®‰è£…</p>
<blockquote>
<p><strong>æ–‡ç« å‚è€ƒ</strong></p>
<p><a href="https://luanlengli.github.io/2019/11/25/OpenVPNå®¢æˆ·ç«¯-Windows-Linux-MacOS-è¿æ¥OpenVPNæœåŠ¡å™¨.html" target="_blank" rel="external">OpenVPNå®¢æˆ·ç«¯(Windows/Linux/MacOS)è¿æ¥OpenVPNæœåŠ¡å™¨</a></p>
</blockquote>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æ­å»ºå¥½æœåŠ¡å™¨ä»¥åéœ€è¦ç»å¸¸ç»´æŠ¤ï¼Œæœ‰æ—¶å€™æœåŠ¡å™¨å¾ˆéš¾è¿œç¨‹è®¿é—®åˆ°ï¼Œå¯ä»¥æ­å»ºopenVPNä»£ç†ï¼Œè¿™æ ·ç»´æŠ¤æœåŠ¡å™¨å°±å¾ˆæ–¹ä¾¿äº†ï¼Œè¿™é‡Œä»‹ç»ä¸€ä¸‹openVPNå®¢æˆ·ç«¯çš„å®‰è£…æ–¹æ³•ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="æŠ€æœ¯" scheme="http://jiaotingyu.me/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
      <category term="Linux" scheme="http://jiaotingyu.me/tags/Linux/"/>
    
      <category term="openVPN" scheme="http://jiaotingyu.me/tags/openVPN/"/>
    
  </entry>
  
  <entry>
    <title>sshç™»é™†å¿½ç•¥known_hostsæ–‡ä»¶</title>
    <link href="http://jiaotingyu.me/2020/03/05/ssh%E7%99%BB%E9%99%86%E5%BF%BD%E7%95%A5known_hosts%E6%96%87%E4%BB%B6/"/>
    <id>http://jiaotingyu.me/2020/03/05/sshç™»é™†å¿½ç•¥known_hostsæ–‡ä»¶/</id>
    <published>2020-03-04T16:00:00.000Z</published>
    <updated>2020-05-19T08:11:44.299Z</updated>
    
    <content type="html"><![CDATA[<p>åœ¨å¹³æ—¶å·¥ä½œä¸­ï¼Œéœ€è¦SSHç™»é™†åˆ°åˆ«çš„Linuxä¸»æœºä¸Šå»ï¼Œä½†æœ‰æ—¶å€™SSHç™»é™†ä¼šè¢«ç¦æ­¢</p>
<a id="more"></a>
<p>å¹¶å¼¹å‡ºå¦‚ä¸‹ç±»ä¼¼æç¤ºï¼š</p>
<p>@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ WARNING: REMOTE HOST IDENTIFICATION HAS CHANGED! @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@IT IS POSSIBLE THAT SOMEONE IS DOING SOMETHING NASTY!Someone could be eavesdropping on you right now (man-in-the-middle attack)!It is also possible that the RSA host key has just been changed.The fingerprint for the RSA key sent by the remote host is36:68:a6:e6:43:34:6b:82:d7:f4:df:1f:c2:e7:37:cc.Please contact your system administrator.Add correct host key in /u/xlian008/.ssh/known_hosts to get rid of this message.Offending key in /u/xlian008/.ssh/known_hosts:2RSA host key for 135.1.35.130 has changed and you have requested strict checking.Host key verification failed.</p>
<p>æ¯”è¾ƒå¥‡æ€ªï¼Œäºæ˜¯ç ”ç©¶äº†ä¸€ä¸‹ã€‚ sshä¼šæŠŠä½ æ¯ä¸ªä½ è®¿é—®è¿‡è®¡ç®—æœºçš„å…¬é’¥(public key)éƒ½è®°å½•åœ¨~/.ssh/known_hostsã€‚å½“ä¸‹æ¬¡è®¿é—®ç›¸åŒè®¡ç®—æœºæ—¶ï¼ŒOpenSSHä¼šæ ¸å¯¹å…¬é’¥ã€‚å¦‚æœå…¬é’¥ä¸åŒï¼ŒOpenSSHä¼šå‘å‡ºè­¦å‘Šï¼Œ é¿å…ä½ å—åˆ°DNS Hijackä¹‹ç±»çš„æ”»å‡»ã€‚æˆ‘åœ¨ä¸Šé¢åˆ—å‡ºçš„æƒ…å†µï¼Œå°±æ˜¯è¿™ç§æƒ…å†µã€‚</p>
<p>åŸå› ï¼šä¸€å°ä¸»æœºä¸Šæœ‰å¤šä¸ªLinuxç³»ç»Ÿï¼Œä¼šç»å¸¸åˆ‡æ¢ï¼Œé‚£ä¹ˆè¿™äº›ç³»ç»Ÿä½¿ç”¨åŒä¸€ipï¼Œç™»å½•è¿‡ä¸€æ¬¡åå°±ä¼šæŠŠsshä¿¡æ¯è®°å½•åœ¨æœ¬åœ°çš„~/.ssh/known_hsotsæ–‡ä»¶ä¸­ï¼Œåˆ‡æ¢è¯¥ç³»ç»Ÿåå†ç”¨sshè®¿é—®è¿™å°ä¸»æœºå°±ä¼šå‡ºç°å†²çªè­¦å‘Šï¼Œéœ€è¦æ‰‹åŠ¨åˆ é™¤ä¿®æ”¹known_hsotsé‡Œé¢çš„å†…å®¹ã€‚</p>
<p>æœ‰ä»¥ä¸‹ä¸¤ä¸ªè§£å†³æ–¹æ¡ˆï¼š</p>
<ol>
<li><p>æ‰‹åŠ¨åˆ é™¤ä¿®æ”¹known_hsotsé‡Œé¢çš„å†…å®¹ï¼›</p>
</li>
<li><p>ä¿®æ”¹é…ç½®æ–‡ä»¶â€œ~/.ssh/configâ€ï¼ŒåŠ ä¸Šè¿™ä¸¤è¡Œï¼Œé‡å¯æœåŠ¡å™¨ã€‚</p>
<p>StrictHostKeyChecking no</p>
<p>UserKnownHostsFile /dev/null</p>
</li>
</ol>
<p>ä¼˜ç¼ºç‚¹ï¼š</p>
<ol>
<li><p>éœ€è¦æ¯æ¬¡æ‰‹åŠ¨åˆ é™¤æ–‡ä»¶å†…å®¹ï¼Œä¸€äº›è‡ªåŠ¨åŒ–è„šæœ¬çš„æ— æ³•è¿è¡Œï¼ˆåœ¨SSHç™»é™†æ—¶å¤±è´¥ï¼‰ï¼Œä½†æ˜¯å®‰å…¨æ€§é«˜ï¼›</p>
</li>
<li><p>SSHç™»é™†æ—¶ä¼šå¿½ç•¥known_hsotsçš„è®¿é—®ï¼Œä½†æ˜¯å®‰å…¨æ€§ä½ï¼›</p>
</li>
</ol>
<blockquote>
<p><strong>æ–‡ç« å‚è€ƒ</strong></p>
<p><a href="https://blog.csdn.net/yasaken/article/details/7348441" target="_blank" rel="external">https://blog.csdn.net/yasaken/article/details/7348441</a></p>
</blockquote>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;åœ¨å¹³æ—¶å·¥ä½œä¸­ï¼Œéœ€è¦SSHç™»é™†åˆ°åˆ«çš„Linuxä¸»æœºä¸Šå»ï¼Œä½†æœ‰æ—¶å€™SSHç™»é™†ä¼šè¢«ç¦æ­¢&lt;/p&gt;
    
    </summary>
    
      <category term="æŠ€æœ¯" scheme="http://jiaotingyu.me/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
      <category term="Linux" scheme="http://jiaotingyu.me/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>crontabç”¨æ³•æ€»ç»“</title>
    <link href="http://jiaotingyu.me/2020/02/03/crontab%E7%94%A8%E6%B3%95%E6%80%BB%E7%BB%93/"/>
    <id>http://jiaotingyu.me/2020/02/03/crontabç”¨æ³•æ€»ç»“/</id>
    <published>2020-02-03T06:25:08.000Z</published>
    <updated>2020-05-19T08:02:06.229Z</updated>
    
    <content type="html"><![CDATA[<p>æ­å»ºå¥½æœåŠ¡å™¨ä»¥åï¼Œç»å¸¸éœ€è¦å¼€å¯ä¸€äº›å®šæ—¶ä»»åŠ¡ï¼Œä¾‹å¦‚å®šæ—¶æ ¡å¯¹æ—¶é—´</p>
<p>å€Ÿç€è¿™ä¸ªæœºä¼šæ€»ç»“ä¸€ä¸‹crontabå®šæ—¶ä»»åŠ¡çš„ç”¨æ³•</p>
<a id="more"></a>
<h3 id="crondä»‹ç»"><a href="#crondä»‹ç»" class="headerlink" title="crondä»‹ç»"></a>crondä»‹ç»</h3><p>crond å’Œcrontabæ˜¯ä¸å¯åˆ†å‰²çš„ã€‚crontabæ˜¯ä¸€ä¸ªå‘½ä»¤ï¼Œå¸¸è§äºUnixå’Œç±»Unixçš„æ“ä½œç³»ç»Ÿä¹‹ä¸­ï¼Œç”¨äºè®¾ç½®å‘¨æœŸæ€§è¢«æ‰§è¡Œçš„æŒ‡ä»¤ã€‚è¯¥å‘½ä»¤ä»æ ‡å‡†è¾“å…¥è®¾å¤‡è¯»å–æŒ‡ä»¤ï¼Œå¹¶å°†å…¶å­˜æ”¾äºâ€œcrontabâ€æ–‡ä»¶ä¸­ï¼Œä»¥ä¾›ä¹‹åè¯»å–å’Œæ‰§è¡Œã€‚è¯¥è¯æ¥æºäºå¸Œè…Šè¯­chronos(Ï‡ÏÏŒÎ½Î¿Ï‚)ï¼ŒåŸæ„æ˜¯æ—¶é—´ã€‚</p>
<p>è€Œcrondæ­£æ˜¯å®ƒçš„å®ˆæŠ¤è¿›ç¨‹ã€‚cronæœåŠ¡æ˜¯ä¸€ä¸ªå®šæ—¶æ‰§è¡Œçš„æœåŠ¡ï¼Œå¯ä»¥é€šè¿‡crontab å‘½ä»¤æ·»åŠ æˆ–è€…ç¼–è¾‘éœ€è¦å®šæ—¶æ‰§è¡Œçš„ä»»åŠ¡ã€‚</p>
<p><strong>å®‰è£… å¹¶è®¾ç½®å¼€æœºè‡ªå¯</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">yum install crontabs </div><div class="line">systemctl enable crond </div><div class="line">systemctl start crond </div><div class="line">systemctl stop crond</div></pre></td></tr></table></figure>
<p><strong>è®¾ç½®å®šæ—¶ä»»åŠ¡</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">vi /etc/crontab</div></pre></td></tr></table></figure>
<p>æ‰“å¼€åæ˜¾ç¤º</p>
<blockquote>
<p>SHELL=/bin/bash</p>
<p>PATH=/sbin:/bin:/usr/sbin:/usr/bin</p>
<p>MAILTO=root</p>
<p># For details see man 4 crontabs</p>
<p># Example of job definition:</p>
<p># .â€”â€”â€”â€”â€”- minute (0 - 59)   è¡¨ç¤ºåˆ†é’Ÿ1ï½59 æ¯åˆ†é’Ÿç”¨<em>æˆ–è€… </em>/1è¡¨ç¤º</p>
<p># |  .â€”â€”â€”â€”- hour (0 - 23)  è¡¨ç¤ºå°æ—¶1ï½23ï¼ˆ0è¡¨ç¤º0ç‚¹ï¼‰</p>
<p># |  |  .â€”â€”â€”- day of month (1 - 31)  è¡¨ç¤ºæ—¥æœŸ1ï½31</p>
<p># |  |  |  .â€”â€”- month (1 - 12) OR jan,feb,mar,apr â€¦  æœˆä»½1ï½12(å¯ä»¥ä½¿ç”¨è‹±æ–‡ç®€å†™)</p>
<p># |  |  |  |  .â€”- day of week (0 - 6) (Sunday=0 or 7)OR sun,mon,tue,wed,thu,fri,satæ˜ŸæœŸ0ï½6(0æˆ–7è¡¨ç¤ºæ˜ŸæœŸå¤©)(å¯ä»¥ä½¿ç”¨è‹±æ–‡ç®€å†™)</p>
<p># |  |  |  |  |</p>
<p># <em>  </em>  <em>  </em>  * user-name  command to be executed  è¡¨ç¤ºè¿è¡Œçš„å‘½ä»¤</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">#åŠ è½½ä»»åŠ¡,ä½¿ä¹‹ç”Ÿæ•ˆ </div><div class="line">crontab /etc/crontab</div></pre></td></tr></table></figure>
<p>crontab /etc/crontab åŠ è½½ä»»åŠ¡çš„åŸç†å¯ä»¥ç†è§£ä¸º</p>
<p><u>æŠŠ/etc/crontabæ–‡ä»¶é‡Œé¢çš„å†…å®¹å¤åˆ¶åˆ°crontabçš„æ‰§è¡Œåˆ—è¡¨é‡Œï¼Œæ‰§è¡Œåˆ—è¡¨é‡Œçš„å†…å®¹å¯èƒ½å’Œ/etc/crontabæ–‡ä»¶çš„å†…å®¹ä¸€æ ·ï¼Œä½†æ˜¯è¿™ä¸¤ä¸ªä¸œè¥¿æ­£å¸¸æƒ…å†µä¸‹ä¸ä¼šäº’ç›¸å½±å“ï¼Œåªæœ‰åœ¨æ‰§è¡Œcrontab /etc/crontabæ—¶æ‰ä¼šæŠŠå†…å®¹å¤åˆ¶è¿‡å»</u></p>
<p>crontabçš„æ‰§è¡Œåˆ—è¡¨ä¸­çš„å†…å®¹å¯ä»¥ä½¿ç”¨ä»¥ä¸‹è¯­å¥ç›´æ¥æ“ä½œ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">#æŸ¥çœ‹ä»»åŠ¡ </div><div class="line">crontab -l </div><div class="line">#ç¼–è¾‘crontab </div><div class="line">crontab -e </div><div class="line">#åˆ é™¤ï¼ˆä¸ä¼šåˆ é™¤/etc/crontabå†…å®¹ï¼Œåªåˆ é™¤å½“å‰å·²åŠ è½½çš„ä»»åŠ¡ï¼‰ </div><div class="line">crontab -r </div><div class="line">#æ·»åŠ ï¼ˆä¸ä¼šæ·»åŠ /etc/crontabå†…å®¹ï¼Œç›´æ¥æ·»åŠ ä»»åŠ¡ï¼‰</div><div class="line">crontab -e</div></pre></td></tr></table></figure>
<p><strong>crondä¸‰ç§è®¾ç½®æ–¹å¼</strong></p>
<ul>
<li><p>ç¬¬ä¸€ç§</p>
<p>åœ¨/etc/crontabä¸‹è®¾ç½®ï¼ŒæŒ‡å®šç”¨æˆ·åçš„</p>
</li>
</ul>
<ol>
<li>vimå‘½ä»¤è¿›å…¥/etc/crontab</li>
<li>åœ¨æœ€åä¸€è¡ŒåŠ ä¸Šæ‰§è¡Œçš„å‘½ä»¤ï¼ˆéœ€è¦æŒ‡å®šç”¨æˆ·åï¼‰</li>
<li>crontab /etc/crontabæˆ–è€…é‡å¯crontabï¼Œä½¿é…ç½®ç”Ÿæ•ˆ</li>
</ol>
<ul>
<li><p>ç¬¬äºŒç§</p>
<p>ç›´æ¥ç”¨crontab -eï¼Œä¸éœ€è¦æŒ‡å®šç”¨æˆ·ï¼Œå¦‚æœæ˜¯rootæƒé™ï¼Œé»˜è®¤æ˜¯rootå®šæ—¶çš„</p>
</li>
</ul>
<ol>
<li>crontab -eè¿›å…¥</li>
<li>ç›´æ¥è¾“å…¥æ‰§è¡Œçš„å‘½ä»¤ ï¼ˆå¯ä»¥ä¸æŒ‡å®šç”¨æˆ·ï¼‰</li>
<li>ä¿å­˜é€€å‡ºï¼ˆé…ç½®å·²ç»ç”Ÿæ•ˆï¼‰</li>
</ol>
<ul>
<li><p>ç¬¬ä¸‰ç§</p>
<p>ç›´æ¥å†™å…¥/var/spool/cron/root</p>
</li>
</ul>
<ol>
<li>vi /var/spool/cron/root</li>
<li>ä¿å­˜é€€å‡ºï¼ˆé…ç½®å·²ç»ç”Ÿæ•ˆï¼‰</li>
</ol>
<p><strong>è®¾ç½®æ—¶é—´æ ¼å¼ä¸¾ä¾‹</strong></p>
<p>å‘ç°ç½‘ä¸Šæœ‰å¾ˆå¤šé”™è¯¯çš„å†™æ³•</p>
<p>é”™è¯¯è¯´æ³•ï¼š</p>
<p>æ¯ä¸€å°æ—¶é‡å¯apache</p>
<p>* <em>/1 </em> <em> </em> /usr/local/etc/rc.d/lighttpd restart</p>
<p>æ­£ç¡®è¯´æ³•ï¼š</p>
<p>æ¯ä¸€å°æ—¶é‡å¯apache(é”™è¯¯çš„)</p>
<p>*ä»£è¡¨æ¯åˆ†é’Ÿå°±æ‰§è¡Œä¸€æ¬¡ï¼Œè¯­å¥çš„æ„æ€ä¸ºæ¯å°æ—¶çš„æ¯åˆ†é’Ÿéƒ½åœ¨æ‰§è¡Œé‡å¯apache</p>
<p>* <em>/1 </em> <em> </em> /usr/local/etc/rc.d/lighttpd restart</p>
<p>å…¶å®ï¼Œä¸‹é¢çš„ä¸¤ç§å†™æ³•æ•ˆæœç›¸åŒ</p>
<p>* <em>/1 </em> <em> </em> /usr/local/etc/rc.d/lighttpd restart <em> </em> <em> </em> * /usr/local/etc/rc.d/lighttpd restart</p>
<p>å¦å¤–ï¼Œæ³¨æ„åŒºåˆ†æ¯å°æ—¶æ‰§è¡Œä»»åŠ¡çš„å†™æ³•</p>
<p>0 <em> </em> <em> </em>  # é”™è¯¯ <em>/60 </em> <em> </em> * # æ­£ç¡®</p>
<p>ç¬¬ä¸€ä¸ªå†™æ³•æ˜¯åœ¨æ¯å°æ—¶çš„0åˆ†æ‰§è¡Œï¼Œä¸ä»»åŠ¡çš„å¼€å§‹æ—¶é—´æ— å…³</p>
<p>ç¬¬äºŒä¸ªå†™æ³•æ˜¯ä»æ‰§è¡Œä»»åŠ¡çš„æ—¶é—´ç‚¹å¼€å§‹ï¼Œæ¯éš”ä¸€å°æ—¶æ‰§è¡Œä¸€æ¬¡</p>
<p>å…¶ä»–ç”¨æ³•</p>
<p>#æ¯å¤©ï¼Œæ¯30åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡ mycommandå‘½ä»¤ <em>/30 </em> <em> </em> root /usr/local/mycommand.sh  #æ¯å¤©å‡Œæ™¨ä¸‰ç‚¹ï¼Œæ‰§è¡Œå‘½ä»¤è„šæœ¬ï¼ŒPS:è¿™é‡Œç”±äºç¬¬ä¸€ä¸ªçš„åˆ†é’Ÿæ²¡æœ‰è®¾ç½®ï¼Œé‚£ä¹ˆå°±ä¼šæ¯å¤©å‡Œæ™¨3ç‚¹çš„æ¯åˆ†é’Ÿéƒ½æ‰§è¡Œä¸€æ¬¡å‘½ä»¤ <em> 3 </em> <em> </em> root /usr/local/mycommand.sh #è¿™æ ·å°±æ˜¯æ¯å¤©å‡Œæ™¨ä¸‰ç‚¹æ•´æ‰§è¡Œä¸€æ¬¡å‘½ä»¤è„šæœ¬ 0 3 <em> </em> <em> root /usr/local/mycommand.sh #æ¯å¤©11ç‚¹åˆ°13ç‚¹ä¹‹é—´ï¼Œæ¯10åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡å‘½ä»¤è„šæœ¬ </em>/10 11-13 <em> </em> <em> root /usr/local/mycommand.sh  #æ¯å°æ—¶çš„10-30åˆ†é’Ÿï¼Œæ¯åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡å‘½ä»¤è„šæœ¬ï¼Œå…±æ‰§è¡Œ20æ¬¡ 10-30 </em> <em> </em> <em> root /usr/local/mycommand.sh #æ¯å°æ—¶çš„10,30åˆ†é’Ÿï¼Œåˆ†åˆ«æ‰§è¡Œä¸€æ¬¡å‘½ä»¤è„šæœ¬ï¼Œå…±æ‰§è¡Œ2æ¬¡ 10,30 </em> <em> </em> <em> </em> root /usr/local/mycommand.sh </p>
<p><strong>é™„ä¸Šcrontabæµ‹è¯•æ–¹æ³•</strong></p>
<p>æ€è·¯ï¼šå°†å½“å‰æ—¶é—´è¾“å…¥åˆ°æ—¥å¿—ä¸­</p>
<p>DATEVAR=date <em> </em> <em> </em> * root /bin/echo $($DATEVAR) &gt;&gt; /tmp/crontab.log</p>
<blockquote>
<p><strong>æ–‡ç« å‚è€ƒ</strong></p>
<p><a href="https://www.cnblogs.com/emanlee/p/10293762.html" target="_blank" rel="external">https://www.cnblogs.com/emanlee/p/10293762.html</a></p>
<p><a href="https://www.jb51.net/article/117241.htm" target="_blank" rel="external">https://www.jb51.net/article/117241.htm</a></p>
<p><a href="https://www.cnblogs.com/p0st/p/9482167.html" target="_blank" rel="external">https://www.cnblogs.com/p0st/p/9482167.html</a></p>
<p><a href="https://blog.csdn.net/liu0808/article/details/80668705" target="_blank" rel="external">https://blog.csdn.net/liu0808/article/details/80668705</a></p>
<p><a href="https://www.cnblogs.com/p0st/p/9482167.html" target="_blank" rel="external">https://www.cnblogs.com/p0st/p/9482167.html</a></p>
<p><a href="http://www.voidcn.com/article/p-epupsmuh-bty.html" target="_blank" rel="external">http://www.voidcn.com/article/p-epupsmuh-bty.html</a></p>
</blockquote>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æ­å»ºå¥½æœåŠ¡å™¨ä»¥åï¼Œç»å¸¸éœ€è¦å¼€å¯ä¸€äº›å®šæ—¶ä»»åŠ¡ï¼Œä¾‹å¦‚å®šæ—¶æ ¡å¯¹æ—¶é—´&lt;/p&gt;
&lt;p&gt;å€Ÿç€è¿™ä¸ªæœºä¼šæ€»ç»“ä¸€ä¸‹crontabå®šæ—¶ä»»åŠ¡çš„ç”¨æ³•&lt;/p&gt;
    
    </summary>
    
      <category term="è¿ç»´" scheme="http://jiaotingyu.me/categories/%E8%BF%90%E7%BB%B4/"/>
    
    
      <category term="crontab" scheme="http://jiaotingyu.me/tags/crontab/"/>
    
      <category term="Linux" scheme="http://jiaotingyu.me/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>Dockerè®¿é—®å®¿ä¸»æœºç«¯å£</title>
    <link href="http://jiaotingyu.me/2019/12/19/Docker%E8%AE%BF%E9%97%AE%E5%AE%BF%E4%B8%BB%E6%9C%BA%E7%AB%AF%E5%8F%A3/"/>
    <id>http://jiaotingyu.me/2019/12/19/Dockerè®¿é—®å®¿ä¸»æœºç«¯å£/</id>
    <published>2019-12-19T06:25:08.000Z</published>
    <updated>2020-05-19T04:45:18.305Z</updated>
    
    <content type="html"><![CDATA[<p>Dockerå®¹å™¨æœ‰çš„æ—¶å€™éœ€è¦è®¿é—®å®¿ä¸»æœºçš„æœåŠ¡ï¼Œä½†æ˜¯127.0.0.1å¹¶ä¸æ˜¯å®¿ä¸»æœºè€Œæ˜¯Dockerè‡ªå·±çš„æœåŠ¡ï¼Œå¯ä»¥ç”¨ä¸‹é¢çš„è¯­å¥æŸ¥è¯¢å®¿ä¸»æœºçš„ipï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ip addr show docker0 | grep -Po &apos;inet \K[\d.]+&apos;</div></pre></td></tr></table></figure>
<p>å¾—åˆ°çš„ipåœ°å€ä¸º<strong>172.17.42.1</strong></p>
<p>ç»è¿‡æµ‹è¯•å‘ç°è¿™ä¸ªåœ°å€æ˜¯å›ºå®šçš„ï¼Œæ¯ä¸€ä¸ªDockerå®¹å™¨éƒ½æ˜¯è¿™ä¸ªip</p>
<a id="more"></a>
<p>ä»¥ä¸‹ä¸ºstackoverflowåŸæ–‡çš„é—®é¢˜å’Œè§£ç­”ï¼š</p>
<p>I have a docker container running jenkins. As part of the build process, I need to access a web server that is run locally on the host machine. Is there a way the host web server (which can be configured to run on a port) can be exposed to the jenkins container?</p>
<p>EDIT: Iâ€™m running docker natively on a Linux machine.</p>
<p>UPDATE:</p>
<p>In addition to @larsks answer below, to get the IP address of the Host IP from the host machine, I do the following:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ip addr show docker0 | grep -Po &apos;inet \K[\d.]+&apos;</div></pre></td></tr></table></figure>
<p><strong>172.17.42.1</strong></p>
<p>When running Docker natively on Linux, you can access host services using the IP address of the docker0 interface. From inside the container, this will be your default route.</p>
<p>For example, on my system:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">$ ip addr show docker0 </div><div class="line"></div><div class="line">7: docker0: &lt;NO-CARRIER,BROADCAST,MULTICAST,UP&gt; mtu 1500 qdisc noqueue state DOWN group default    </div><div class="line"></div><div class="line">link/ether 00:00:00:00:00:00 brd ff:ff:ff:ff:ff:ff    </div><div class="line"></div><div class="line">inet 172.17.0.1/16 brd 172.17.255.255 scope global docker0       </div><div class="line"></div><div class="line">valid_lft forever preferred_lft forever   </div><div class="line"></div><div class="line">inet6 fe80::f4d2:49ff:fedd:28a0/64 scope link        </div><div class="line"></div><div class="line">valid_lft forever preferred_lft forever</div></pre></td></tr></table></figure>
<p>And inside a container:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"># ip route show </div><div class="line">default via 172.17.0.1 dev eth0  </div><div class="line">172.17.0.0/16 dev eth0  src 172.17.0.4</div></pre></td></tr></table></figure>
<p>Itâ€™s fairly easy to extract this IP address using a simple shell script:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">#!/bin/sh </div><div class="line">hostip=$(ip route show | awk &apos;/default/ &#123;print $3&#125;&apos;) </div><div class="line">echo $hostip</div></pre></td></tr></table></figure>
<p>You may need to modify the iptables rules on your host to permit connections from Docker containers. Something like this will do the trick:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">\# iptables -A INPUT -i docker0 -j ACCEPT</div></pre></td></tr></table></figure>
<p>This would permit access to any ports on the host from Docker containers. Note that:</p>
<ul>
<li>iptables rules are ordered, and this rule may or may not do the right thing depending on what other rules come before it.</li>
<li>you will only be able to access host services that are either (a) listening on INADDR_ANY (aka 0.0.0.0) or that are explicitly listening on the docker0 interface.</li>
</ul>
<blockquote>
<p>æ–‡ç« å‚è€ƒ</p>
<p> <a href="https://stackoverflow.com/questions/31324981/how-to-access-host-port-from-docker-container" target="_blank" rel="external">https://stackoverflow.com/questions/31324981/how-to-access-host-port-from-docker-container</a></p>
</blockquote>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Dockerå®¹å™¨æœ‰çš„æ—¶å€™éœ€è¦è®¿é—®å®¿ä¸»æœºçš„æœåŠ¡ï¼Œä½†æ˜¯127.0.0.1å¹¶ä¸æ˜¯å®¿ä¸»æœºè€Œæ˜¯Dockerè‡ªå·±çš„æœåŠ¡ï¼Œå¯ä»¥ç”¨ä¸‹é¢çš„è¯­å¥æŸ¥è¯¢å®¿ä¸»æœºçš„ipï¼š&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;ip addr show docker0 | grep -Po &amp;apos;inet \K[\d.]+&amp;apos;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;å¾—åˆ°çš„ipåœ°å€ä¸º&lt;strong&gt;172.17.42.1&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ç»è¿‡æµ‹è¯•å‘ç°è¿™ä¸ªåœ°å€æ˜¯å›ºå®šçš„ï¼Œæ¯ä¸€ä¸ªDockerå®¹å™¨éƒ½æ˜¯è¿™ä¸ªip&lt;/p&gt;
    
    </summary>
    
      <category term="è¿ç»´" scheme="http://jiaotingyu.me/categories/%E8%BF%90%E7%BB%B4/"/>
    
    
      <category term="docker" scheme="http://jiaotingyu.me/tags/docker/"/>
    
  </entry>
  
  <entry>
    <title>æœåŠ¡å™¨å…¨å±€ä»£ç†</title>
    <link href="http://jiaotingyu.me/2019/08/15/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%85%A8%E5%B1%80%E4%BB%A3%E7%90%86/"/>
    <id>http://jiaotingyu.me/2019/08/15/æœåŠ¡å™¨å…¨å±€ä»£ç†/</id>
    <published>2019-08-15T06:25:08.000Z</published>
    <updated>2020-05-19T04:01:06.694Z</updated>
    
    <content type="html"><![CDATA[<p>ä¸ºäº†ç»™æœåŠ¡å™¨æ›´æ–°ä¸€äº›åº”ç”¨</p>
<p>éœ€è¦ç»™æœåŠ¡å™¨ç§‘å­¦ä¸Šç½‘å¹¶å¼€å¯å…¨å±€ä»£ç†</p>
 <a id="more"></a>
<h4 id="sså®¢æˆ·ç«¯å®‰è£…"><a href="#sså®¢æˆ·ç«¯å®‰è£…" class="headerlink" title="sså®¢æˆ·ç«¯å®‰è£…"></a>sså®¢æˆ·ç«¯å®‰è£…</h4><p> pip install shadowsocks</p>
<p>sudo vi /etc/shadowsocks.json</p>
<p>{</p>
<p>â€‹    â€œserverâ€:â€103.16.229.46â€,</p>
<p>â€‹    â€œserver_portâ€:5432,</p>
<p>â€‹    â€œlocal_addressâ€: â€œ127.0.0.1â€,</p>
<p>â€‹    â€œlocal_portâ€:1080,</p>
<p>â€‹    â€œpasswordâ€:â€biubiubiu~â€,</p>
<p>â€‹    â€œtimeoutâ€:300,</p>
<p>â€‹    â€œmethodâ€:â€aes-256-cfbâ€</p>
<p>}</p>
<p>å®¢æˆ¶ç«¯å¯åŠ¨æˆ–è€…åœæ­¢ssæœåŠ¡ã€‚ </p>
<p>sslocal -c /etc/shadowsocks.json -d start</p>
<p>sslocal -c /etc/shadowsocks.json -d stop</p>
<h4 id="privoxyå®‰è£…"><a href="#privoxyå®‰è£…" class="headerlink" title="privoxyå®‰è£…"></a>privoxyå®‰è£…</h4><p>wget <a href="https://nchc.dl.sourceforge.net/project/ijbswa/Sources/3.0.26%20%28stable%29/privoxy-3.0.26-stable-src.tar.gz" target="_blank" rel="external">https://nchc.dl.sourceforge.net/project/ijbswa/Sources/3.0.26%20%28stable%29/privoxy-3.0.26-stable-src.tar.gz</a></p>
<p>tar xf privoxy-3.0.26-stable-src.tar.gz</p>
<p>cd privoxy-3.0.26-stable</p>
<p>useradd privoxy</p>
<p>autoheader &amp;&amp; autoconf</p>
<p>./configure</p>
<p>make &amp;&amp; make install</p>
<p>sudo vim /usr/local/etc/privoxy/config</p>
<p>ä¿®æ”¹</p>
<p>listen-address 127.0.0.1:8118</p>
<p>forward-socks5t / 127.0.0.1:1080 .</p>
<p>sudo vim /etc/profile</p>
<p>æ·»åŠ ä»¥ä¸‹å‡ è¡Œï¼š</p>
<p>export http_proxy=<a href="http://127.0.0.1:8118" target="_blank" rel="external">http://127.0.0.1:8118</a></p>
<p>export ftp_proxy=<a href="http://127.0.0.1:8118" target="_blank" rel="external">http://127.0.0.1:8118</a></p>
<p>source /etc/profile</p>
<p>service privoxy start</p>
<h4 id="éªŒè¯"><a href="#éªŒè¯" class="headerlink" title="éªŒè¯"></a>éªŒè¯</h4><p>curl <a href="http://httpbin.org/ip" target="_blank" rel="external">http://httpbin.org/ip</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ä¸ºäº†ç»™æœåŠ¡å™¨æ›´æ–°ä¸€äº›åº”ç”¨&lt;/p&gt;
&lt;p&gt;éœ€è¦ç»™æœåŠ¡å™¨ç§‘å­¦ä¸Šç½‘å¹¶å¼€å¯å…¨å±€ä»£ç†&lt;/p&gt;
    
    </summary>
    
      <category term="è¿ç»´" scheme="http://jiaotingyu.me/categories/%E8%BF%90%E7%BB%B4/"/>
    
    
      <category term="ss" scheme="http://jiaotingyu.me/tags/ss/"/>
    
      <category term="ä»£ç†" scheme="http://jiaotingyu.me/tags/%E4%BB%A3%E7%90%86/"/>
    
  </entry>
  
  <entry>
    <title>é©¬æ¥è¥¿äºšæ—…æ¸¸æ”»ç•¥</title>
    <link href="http://jiaotingyu.me/2019/07/08/%E9%A9%AC%E6%9D%A5%E8%A5%BF%E4%BA%9A%E6%97%85%E8%A1%8C%E6%94%BB%E7%95%A5/"/>
    <id>http://jiaotingyu.me/2019/07/08/é©¬æ¥è¥¿äºšæ—…è¡Œæ”»ç•¥/</id>
    <published>2019-07-08T07:08:21.000Z</published>
    <updated>2020-05-19T08:02:45.298Z</updated>
    
    <content type="html"><![CDATA[<h2 id="é©¬æ¥è¥¿äºšåŒäººæ—…è¡Œ"><a href="#é©¬æ¥è¥¿äºšåŒäººæ—…è¡Œ" class="headerlink" title="é©¬æ¥è¥¿äºšåŒäººæ—…è¡Œ"></a><strong>é©¬æ¥è¥¿äºšåŒäººæ—…è¡Œ</strong></h2><p>æ³¨æ„äº‹é¡¹ï¼š</p>
<ol>
<li>æ’å¤´ä¸åŒ</li>
<li>æ²¡æœ‰æ—¶å·®</li>
<li>è´§å¸å…‘æ¢ï¼š1MYR=1.7RMB</li>
<li>åœ°é“ä¹˜åä»·æ ¼ï¼Œäº¤é€šä»·æ ¼</li>
<li>äºšè¡Œé£æœºå¼€çš„å¾ˆè¶³ï¼Œåé£æœºéœ€è¦å¸¦è¡£æœ</li>
<li>ç­¾è¯/æœºç¥¨é¢„å®š</li>
<li>æå‰å‡†å¤‡ç”µè¯å¡</li>
<li><p>æ½œæ°´æå‰å‡†å¤‡ï¼ˆæ°´æ¯æœã€è„šè¹¼ç­‰ï¼‰</p>
<a id="more"></a>
</li>
</ol>
<p><strong>æ•´ä½“è¡Œç¨‹æ¦‚è§ˆï¼š</strong></p>
<p>9/30-10/1 å¹¿å·-&gt;å‰éš†å¡  é£æœº</p>
<p>10/2   å‰éš†å¡-&gt;æ–—æ¹– é£æœº</p>
<p>10/2   æ–— æ¹–-&gt;ä»™æœ¬é‚£ åè½¦ï¼ˆæœºåœºæ‰“è½¦ï¼Œ25MYR/äººï¼‰</p>
<p>10/6-10/7 å‰éš†å¡-&gt;å¹¿å·</p>
<p>ä»·æ ¼ï¼šÂ¥2100*2=Â¥4200ï¼ˆå¾€è¿”ï¼‰</p>
<p><strong>å‰éš†å¡ï¼š**</strong>è´¹ç”¨æ€»è®¡ï¼šÂ¥1000**</p>
<ol>
<li><strong>åŒå­å¡”</strong>ï¼š ç”¨æ—¶1-3å°æ—¶</li>
</ol>
<p><strong>äº¤é€š</strong>ï¼šå‰å¾€å›½å®¶çŸ³æ²¹å…¬å¸åŒå­å¡”ï¼Œå¯ä¹˜Putraçº¿è½»è½¨ç›´è¾¾åº•å±‚ï¼›æˆ–ä¹˜LRTåˆ°KLCCç«™ï¼Œå‡ºç«™ä¾¿å¯åˆ°è¾¾KLCCå•†åœºå†…</p>
<p><strong>é—¨ç¥¨ï¼š</strong> MYR 80 = Â¥140 *2=Â¥280</p>
<p><strong>å¼€æ”¾æ—¶é—´ï¼š</strong>09:00-21:00,åœæ­¢å…¥åœºæ—¶é—´:20:30</p>
<p><strong>å†å²</strong>ï¼šå»ºæˆäº1997å¹´ï¼Œæ˜¯ä¸€åº§è¶…ç»å…¸ç°ä»£çš„å»ºç­‘ç‰©ï¼Œä¹Ÿæ˜¯ç›®å‰å…¨ä¸–ç•Œæœ€é«˜çš„ä¸¤åº§ç›¸è¿å»ºç­‘ç‰©ã€‚è¿™åº§ç¾è½®ç¾å¥‚çš„ç‰¹å‡ºå»ºç­‘ç‰©çš„å»ºç­‘ç†å¿µæ˜¯ç”±ä¼Šæ–¯å…°5å¤§æ”¯æŸ±æ€æƒ³æ‰€æ¿€å‘è€Œæ¥çš„ï¼Œå…±88å±‚æ¥¼é«˜ã€‚åŒå³°å¡”å†…è®¾æœ‰å›½æ²¹äº¤å“ä¹å…ï¼Œæ˜¯é©¬æ¥è¥¿äºšäº¤å“ä¹é˜ŸåŠå›½æ²¹è¡¨æ¼”è‰ºæœ¯å›¢ä¾‹å¸¸ç»ƒä¹ åŠè¡¨æ¼”çš„åœºæ‰€ã€‚ç™»ä¸ŠåŒå¡”å¤§æ¥¼ï¼Œæ•´ä¸ªå‰éš†å¡å¸‚ç§€ä¸½é£å…‰å°½æ”¶çœ¼åº•ï¼Œå°¤å…¶æ˜¯åœ¨æ™šä¸Šç¯å…‰ç’€ç’¨çš„æ—¶å€™ï¼Œæ™¯è‰²å°¤ä¸ºå£®ç¾ã€‚</p>
<p><strong>å®‰æ’ï¼š</strong>çœ‹çœ‹å‰éš†å¡æ™¯è‰²ï¼Œé€›é€›è¡—ã€‚åˆé¤å°±åœ¨è¿™å„¿åƒå•¦</p>
<ol>
<li><strong>å›½å®¶æ¸…çœŸå¯º</strong>ï¼šç”¨æ—¶1-3å°æ—¶ï¼ˆç”·å£«ã€å¥³å£«éœ€ç©¿é•¿è¡£ï¼‰</li>
</ol>
<p><strong>äº¤é€š</strong>ï¼šå›½å®¶æ¸…çœŸå¯ºä½äºå‰éš†å¡çš„Jl Perdanaè¡—ï¼Œå‰éš†å¡è€ç«è½¦ç«™è¾¹ä¸Šï¼Œå¯æ­¥è¡Œå‰å¾€</p>
<p><strong>é—¨ç¥¨</strong>ï¼šå…è´¹ï¼ˆtips: åœ¨æ­£é—¨å…¥å£å¤„ä½œè®¿å®¢ç™»è®°ï¼‰</p>
<p><strong>å¼€æ”¾æ—¶é—´</strong>ï¼šå‘¨ä¸€-å‘¨å››ï¼š09:00-12:00ï¼›å‘¨äº”ï¼š17:30-18:30ï¼›å‘¨å…­-å‘¨æ—¥ï¼š15:00-16:00</p>
<p><strong>å†å²</strong>ï¼šå»ºäº1974å¹´ï¼Œå¯å®¹çº³8000äººåŒæ—¶ç¥ˆç¥·ï¼Œæœ€ä»¤äººç©ç›®ä¹‹å¤„åˆ™åœ¨äºå…¶å±‚å çš„ä¼çŠ¶å±‹é¡¶ã€‚å›æ•™å ‚çš„ä¸»è¦åœ†é¡¶å¤„æœ‰18é¢—æ˜Ÿï¼Œä»£è¡¨é©¬æ¥13å·å±åŠå›æ•™çš„5å¤§æ”¯æŸ±ã€‚ä»¤äººæƒŠå¹çš„æ˜¯å…¶å¤šè¤¶ä¼å½¢å±‹é¡¶ï¼Œ73å…¬å°ºé«˜å°–å¡”æ›´ç›´æŒ‡è“å¤©ï¼Œç²¾è‡´å·ç„¶ã€‚å¯ºå†…ç»å ‚ã€èµ°å»Šã€å›¾ä¹¦å®¤ç­‰çš„è£…æ½¢ä¸éº¦åŠ çš„ä¸‰å¤§æ¸…çœŸå¯ºç›¸ä»¿ã€‚æ¯é€¢æ˜ŸæœŸäº”ä¸»éº»æ—¥ï¼Œè™”è¯šçš„æ•™å¾’ä»¬ä¾¿æ¶Œå‘è¿™é‡Œåšç¥ˆç¥·ã€‚</p>
<p><strong>å®‰æ’ï¼š</strong>æ„Ÿå—å®—æ•™æ–‡åŒ–ï¼Œä½“ä¼šå½“åœ°å®—æ•™ç‰¹è‰²</p>
<ol>
<li><strong>ç‹¬ç«‹å¹¿åœºï¼š</strong>ç”¨æ—¶1å°æ—¶ä»¥ä¸‹</li>
</ol>
<p><strong>äº¤é€š</strong>ï¼šç‹¬ç«‹å¹¿åœºä½äºè‹ä¸¹é˜¿éƒ½æ²™æœ«å¤§å¦å¯¹é¢ï¼Œå¯ä¹˜åLRTé»„çº¿åˆ°Masjid Jamekç«™ï¼Œå†å‘è¥¿æ­¥è¡Œçº¦10-15åˆ†é’Ÿå³è¾¾ã€‚</p>
<p><strong>é—¨ç¥¨</strong>ï¼šå…è´¹</p>
<p><strong>å¼€æ”¾æ—¶é—´</strong>ï¼šå…¨å¤©</p>
<p><strong>å†å²ï¼š</strong>ç‹¬ç«‹å¹¿åœºåè½äºè‹ä¸¹é˜¿éƒ½æ²™æœ«å¤§å¦å¯¹é¢ï¼Œç»¿è‰å¦‚èŒµçš„å¹¿åœºæå…·å†å²ä»·å€¼ã€‚ä¸ºçºªå¿µé©¬æ¥è¥¿äºšè„±ç¦»è‹±å›½ç»Ÿæ²»ç‹¬ç«‹è€Œå»ºï¼Œæ¯å¹´ä¼šåœ¨æ­¤ä¸¾åŠå›½åº†æ´»åŠ¨ã€‚å¹¿åœºå¯¹é¢æ˜¯åŸå¸‚é•¿å»Šï¼Œé—¨å£çš„â€œI LOVE KLâ€æ˜¯å…¶æ ‡å¿—æ€§logoã€‚å‘¨è¾¹æœ‰åœ£ç›ä¸½æ•™å ‚ã€å†å²åšç‰©é¦†ã€é›ªå…°èªä¿±ä¹éƒ¨ç­‰å¾ˆå¤šæ··åˆå„å›½ç‰¹è‰²çš„è€å¼å»ºç­‘ã€‚</p>
<p><strong>å®‰æ’ï¼š</strong>éšä¾¿èµ°èµ°</p>
<ol>
<li><strong>ä¸­å¤®å¸‚åœº</strong></li>
</ol>
<p><strong>äº¤é€š</strong>ï¼šä¹˜åLRTé»„çº¿åˆ°Pasar Seniç«™ï¼Œå†å¾€åŒ—æ­¥è¡Œçº¦10åˆ†é’Ÿï¼›æˆ–ä¹˜åLRTé»„çº¿ï¼ˆæˆ–çº¢çº¿ï¼‰åˆ°Masjid Jamekç«™ï¼Œå†å¾€å—æ­¥è¡Œçº¦10åˆ†é’Ÿ</p>
<p><strong>æ— é—¨ç¥¨</strong></p>
<p><strong>å¼€æ”¾æ—¶é—´</strong>ï¼šæ—©ä¸Š10ç‚¹è‡³æ™šä¸Š10ç‚¹</p>
<p><strong>å†å²ï¼š</strong>è¿‡å»æ˜¯å‰éš†å¡ä¸»è¦â€œæ¹¿å¸‚åœºâ€ï¼Œç°åœ¨è¿™ä¸ªéœ²å¤©é›†å¼çš„è‰ºæœ¯åŠæ‰‹å·¥è‰ºå“ä¸­å¿ƒï¼Œåˆ™æ±‡é›†äº†æœ¬åœ°è‰ºæœ¯å®¶ä¸å·¥åŒ çš„æ°ä½œï¼›æ—¢å¯å³æ—¶è®©ç”»å®¶ç»™ä½ ç”»å¼ è‚–åƒç”»ï¼Œä¹Ÿå¯æ…¢æ…¢æ¬£èµå’ŒæŒ‘é€‰çºªå¿µå“ï¼Œæ›´å¯åˆ°ä¼ ç»Ÿè¯æåº—æœç½—çè´µçš„è¯å“ã€‚</p>
<p><strong>å®‰æ’</strong>ï¼šåˆ°å¤„çœ‹çœ‹é€›é€›ï¼Œä¹°ç‚¹ç‰¹è‰²å•†å“ã€‚åƒæ™šé¤</p>
<ol>
<li><strong>ä½å®¿ï¼ˆåŒå­å¡”å¯¹é¢æ°‘å®¿ï¼Œæ— è¾¹æ³³æ± ï¼‰</strong></li>
</ol>
<p><strong>ä»·æ ¼ï¼š</strong>Â¥500</p>
<p><strong>å®‰æ’</strong>ï¼šæ™šä¸Šçœ‹ç²¾åŠ›ï¼Œæœ‰æ—¶é—´çš„è¯ï¼Œå°±å»æ— è¾¹æ³³æ± ç©ï¼Œæ²¡æ—¶é—´çš„è¯ç¬¬äºŒå¤©æ—©ä¸Šå»ï¼Œåœ¨æ— è¾¹æ³³æ± ç…§æ—¥å‡º</p>
<p><strong>10/2å‰éš†å¡-&gt;æ–—æ¹–-&gt;ä»™æœ¬é‚£ è´¹ç”¨æ€»è®¡ï¼šÂ¥2000</strong></p>
<p><strong>è·¯ç¨‹ï¼š</strong>å‰éš†å¡-&gt;æ–—æ¹– é£æœºä¸¤å°æ—¶ï¼›æ–—æ¹–-&gt;ä»™æœ¬é‚£ æ±½è½¦1-2å°æ—¶</p>
<p><strong>ä»·æ ¼ï¼š</strong>æœºç¥¨å¾€è¿”ï¼šÂ¥800*2=Â¥1600</p>
<p><strong>è½¦è´¹ï¼š</strong>å•ç¨‹Â¥45*2=Â¥90ï¼›</p>
<p><strong>ä»™æœ¬é‚£</strong></p>
<p><strong>10/2-10/3</strong>é•‡ä¸Šå‘†ä¸€å¤©ï¼Œé€›é€› ä½å®¿ï¼šÂ¥300</p>
<p><strong>10/3-10/5</strong>ä»™æœ¬é‚£æ°´å±‹ï¼Œæ½œæ°´ ä½å®¿ï¼šÂ¥4500ï¼ˆä½¿ç”¨ä¿¡ç”¨å¡æœ‰1%æ‰‹ç»­è´¹ï¼‰</p>
<p><strong>10/5</strong> å›å‰éš†å¡ è½¦è´¹ï¼šÂ¥100</p>
<p><strong>10/6-10/7</strong> å›å¹¿å·</p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;é©¬æ¥è¥¿äºšåŒäººæ—…è¡Œ&quot;&gt;&lt;a href=&quot;#é©¬æ¥è¥¿äºšåŒäººæ—…è¡Œ&quot; class=&quot;headerlink&quot; title=&quot;é©¬æ¥è¥¿äºšåŒäººæ—…è¡Œ&quot;&gt;&lt;/a&gt;&lt;strong&gt;é©¬æ¥è¥¿äºšåŒäººæ—…è¡Œ&lt;/strong&gt;&lt;/h2&gt;&lt;p&gt;æ³¨æ„äº‹é¡¹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;æ’å¤´ä¸åŒ&lt;/li&gt;
&lt;li&gt;æ²¡æœ‰æ—¶å·®&lt;/li&gt;
&lt;li&gt;è´§å¸å…‘æ¢ï¼š1MYR=1.7RMB&lt;/li&gt;
&lt;li&gt;åœ°é“ä¹˜åä»·æ ¼ï¼Œäº¤é€šä»·æ ¼&lt;/li&gt;
&lt;li&gt;äºšè¡Œé£æœºå¼€çš„å¾ˆè¶³ï¼Œåé£æœºéœ€è¦å¸¦è¡£æœ&lt;/li&gt;
&lt;li&gt;ç­¾è¯/æœºç¥¨é¢„å®š&lt;/li&gt;
&lt;li&gt;æå‰å‡†å¤‡ç”µè¯å¡&lt;/li&gt;
&lt;li&gt;&lt;p&gt;æ½œæ°´æå‰å‡†å¤‡ï¼ˆæ°´æ¯æœã€è„šè¹¼ç­‰ï¼‰&lt;/p&gt;
    
    </summary>
    
      <category term="æ—…æ¸¸" scheme="http://jiaotingyu.me/categories/%E6%97%85%E6%B8%B8/"/>
    
    
      <category term="é©¬æ¥è¥¿äºšğŸ‡²ğŸ‡¾" scheme="http://jiaotingyu.me/tags/%E9%A9%AC%E6%9D%A5%E8%A5%BF%E4%BA%9A%F0%9F%87%B2%F0%9F%87%BE/"/>
    
  </entry>
  
  <entry>
    <title>ä»¥å¤ªåŠå­¦ä¹ ç¬”è®°ï¼ˆåå…­ï¼‰</title>
    <link href="http://jiaotingyu.me/2018/09/26/%E4%BB%A5%E5%A4%AA%E5%9D%8A%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%88%E5%8D%81%E5%85%AD%EF%BC%89/"/>
    <id>http://jiaotingyu.me/2018/09/26/ä»¥å¤ªåŠå­¦ä¹ ç¬”è®°ï¼ˆåå…­ï¼‰/</id>
    <published>2018-09-25T16:00:00.000Z</published>
    <updated>2020-05-18T15:27:56.475Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ä»¥å¤ªåŠæºç åˆ†æ"><a href="#ä»¥å¤ªåŠæºç åˆ†æ" class="headerlink" title="ä»¥å¤ªåŠæºç åˆ†æ"></a>ä»¥å¤ªåŠæºç åˆ†æ</h2><h3 id="ä»¥å¤ªåŠå…±è¯†ç®—æ³•åˆ†ä¸ºä¸¤ç±»"><a href="#ä»¥å¤ªåŠå…±è¯†ç®—æ³•åˆ†ä¸ºä¸¤ç±»" class="headerlink" title="ä»¥å¤ªåŠå…±è¯†ç®—æ³•åˆ†ä¸ºä¸¤ç±»"></a>ä»¥å¤ªåŠå…±è¯†ç®—æ³•åˆ†ä¸ºä¸¤ç±»</h3><ul>
<li><p><strong>Ethashç®—æ³•</strong></p>
</li>
<li><p><strong>Cliqueç®—æ³•</strong></p>
<a id="more"></a>
</li>
</ul>
<h3 id="Ethash"><a href="#Ethash" class="headerlink" title="Ethash"></a>Ethash</h3><p>Ethashç®—æ³•ä¹Ÿå«åšæŒ–çŸ¿ç®—æ³•ï¼Œæ˜¯ä»¥å¤ªåŠåŸºäºPOWå·¥ä½œé‡è¯æ˜çš„å…±è¯†å¼•æ“</p>
<p>Ethashç®—æ³•è¿‡ç¨‹ï¼š</p>
<ul>
<li><p>é€šè¿‡æ‰«æå—å¤´ä¸ºæ¯ä¸ªåŒºå—è®¡ç®—å‡ºä¸€ä¸ªseed</p>
</li>
<li><p>æ ¹æ®seedè®¡ç®—ä¸€ä¸ª16MBçš„ä¼ªéšæœºç¼“å­˜cacheï¼Œä¾›è½»å®¢æˆ·ç«¯ç¼“å­˜</p>
</li>
<li><p>ä»ç¼“å­˜cacheä¸­ç”Ÿæˆä¸€ä¸ªæ•°æ®é›†ï¼Œå®Œæ•´çš„å®¢æˆ·ç«¯å­˜å‚¨è¿™ä¸ªæ•°æ®é›†</p>
</li>
</ul>
<p>Ethashç®—æ³•åœ¨ä»¥å¤ªåŠä¸­ä½¿ç”¨Sealæ–¹æ³•å®ç°</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Seal(chain ChainReader, block *types.Block, stop &lt;-<span class="keyword">chan</span> <span class="keyword">struct</span>&#123;&#125;) (*types.Block, error)<span class="comment">//è¯¥æ–¹æ³•é€šè¿‡è¾“å…¥ä¸€ä¸ªåŒ…å«æœ¬åœ°çŸ¿å·¥æŒ–å‡ºçš„æœ€é«˜åŒºå—åœ¨ä¸»å¹²ä¸Šç”Ÿæˆä¸€ä¸ªæ–°å—</span></div></pre></td></tr></table></figure>
<p>è¯¥æ–¹æ³•åŒ…å«çš„å‚æ•°æœ‰ChainReader Block stop</p>
<ul>
<li><p>ChainReader</p>
  <figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// å®šä¹‰äº†ä¸€äº›æ–¹æ³•ï¼Œç”¨äºåœ¨åŒºå—å¤´éªŒè¯ä»¥åŠå”å—éªŒè¯æœŸé—´ï¼Œè®¿é—®æœ¬åœ°åŒºå—é“¾ã€‚</span></div><div class="line"><span class="keyword">type</span> ChainReader <span class="keyword">interface</span> &#123;</div><div class="line">    <span class="comment">// è·å–åŒºå—é“¾çš„é“¾é…ç½®</span></div><div class="line">    Config() *params.ChainConfig</div><div class="line"></div><div class="line">    <span class="comment">// ä»æœ¬åœ°é“¾è·å–å½“å‰å—å¤´</span></div><div class="line">    CurrentHeader() *types.Header</div><div class="line"></div><div class="line">    <span class="comment">// é€šè¿‡hashå’Œnumberä»ä¸»é“¾ä¸­è·å–ä¸€ä¸ªåŒºå—å¤´</span></div><div class="line">    GetHeader(hash common.Hash, number <span class="keyword">uint64</span>) *types.Header</div><div class="line"></div><div class="line">    <span class="comment">// é€šè¿‡numberä»ä¸»é“¾ä¸­è·å–ä¸€ä¸ªåŒºå—å¤´</span></div><div class="line">    GetHeaderByNumber(number <span class="keyword">uint64</span>) *types.Header</div><div class="line"></div><div class="line">    <span class="comment">// é€šè¿‡hashä»ä¸»é“¾ä¸­è·å–ä¸€ä¸ªåŒºå—å¤´</span></div><div class="line">    GetHeaderByHash(hash common.Hash) *types.Header</div><div class="line"></div><div class="line">    <span class="comment">// é€šè¿‡hashå’Œnumberä»ä¸»é“¾ä¸­è·å–ä¸€ä¸ªåŒºå—</span></div><div class="line">    GetBlock(hash common.Hash, number <span class="keyword">uint64</span>) *types.Block</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>  ChainReaderä¸»è¦ä½œç”¨æ˜¯è·å–header</p>
</li>
<li><p>Block</p>
  <figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Blockä»£è¡¨ä»¥å¤ªåŠåŒºå—é“¾ä¸­çš„ä¸€ä¸ªå®Œæ•´çš„åŒºå—</span></div><div class="line"><span class="keyword">type</span> Block <span class="keyword">struct</span> &#123;</div><div class="line">    header       *Header <span class="comment">// åŒºå—åŒ…æ‹¬å¤´</span></div><div class="line">    uncles       []*Header <span class="comment">// å”å—</span></div><div class="line">    transactions Transactions <span class="comment">// äº¤æ˜“é›†åˆ</span></div><div class="line"></div><div class="line">    <span class="comment">// cachesç¼“å­˜</span></div><div class="line">    hash atomic.Value</div><div class="line">    size atomic.Value</div><div class="line"></div><div class="line">    <span class="comment">// Tdç”¨äºcoreåŒ…å­˜å‚¨æ‰€æœ‰çš„é“¾ä¸Šçš„éš¾åº¦</span></div><div class="line">    td *big.Int</div><div class="line"></div><div class="line">    <span class="comment">// è¿™äº›å­—æ®µç”¨äºethåŒ…æ¥è·Ÿè¸ªinter-peerå†…éƒ¨ç«¯ç‚¹åŒºå—çš„æ¥æ›¿</span></div><div class="line">    ReceivedAt   time.Time</div><div class="line">    ReceivedFrom <span class="keyword">interface</span>&#123;&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>  Blockå°±æ˜¯ä¸€ä¸ªå®Œæ•´çš„åŒºå—ï¼ŒåŒ…æ‹¬header uncles transactionç­‰é‡è¦ä¿¡æ¯</p>
</li>
<li><p>stop</p>
<p>  stopæ˜¯ä¸€ä¸ªç©ºç»“æ„ä½“ä½œä¸ºä¿¡å·æº</p>
</li>
</ul>
<pre><code>Sealæ–¹æ³•çš„å®Œæ•´ä»£ç 
</code></pre><figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="params">(ethash *Ethash)</span> <span class="title">Seal</span><span class="params">(chain consensus.ChainReader, block *types.Block, stop &lt;-<span class="keyword">chan</span> <span class="keyword">struct</span>&#123;&#125;)</span> <span class="params">(*types.Block, error)</span></span> &#123;</div><div class="line">    <span class="comment">// fakeæ¨¡å¼ç«‹å³è¿”å›0 nonce</span></div><div class="line">    <span class="keyword">if</span> ethash.fakeMode &#123;</div><div class="line">        header := block.Header()</div><div class="line">        header.Nonce, header.MixDigest = types.BlockNonce&#123;&#125;, common.Hash&#123;&#125;</div><div class="line">        <span class="keyword">return</span> block.WithSeal(header), <span class="literal">nil</span></div><div class="line">    &#125;</div><div class="line">    <span class="comment">// å…±äº«powçš„è¯ï¼Œåˆ™è½¬åˆ°å®ƒçš„å…±äº«å¯¹è±¡æ‰§è¡ŒSealæ“ä½œ</span></div><div class="line">    <span class="keyword">if</span> ethash.shared != <span class="literal">nil</span> &#123;</div><div class="line">        <span class="keyword">return</span> ethash.shared.Seal(chain, block, stop)</div><div class="line">    &#125;</div><div class="line">    <span class="comment">// åˆ›å»ºä¸€ä¸ªrunnerä»¥åŠå®ƒæŒ‡æŒ¥çš„å¤šé‡æœç´¢çº¿ç¨‹</span></div><div class="line">    abort := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">struct</span>&#123;&#125;)</div><div class="line">    found := <span class="built_in">make</span>(<span class="keyword">chan</span> *types.Block)</div><div class="line"></div><div class="line">    ethash.lock.Lock() <span class="comment">// çº¿ç¨‹ä¸Šé”ï¼Œä¿è¯å†…å­˜çš„ç¼“å­˜ï¼ˆåŒ…å«æŒ–çŸ¿å­—æ®µï¼‰å®‰å…¨</span></div><div class="line">    threads := ethash.threads <span class="comment">// æŒ–çŸ¿çš„çº¿ç¨‹s</span></div><div class="line">    <span class="keyword">if</span> ethash.rand == <span class="literal">nil</span> &#123;<span class="comment">// randä¸ºç©ºï¼Œåˆ™ä¸ºethashçš„å­—æ®µrandèµ‹å€¼</span></div><div class="line">        <span class="comment">// è·å¾—ç§å­</span></div><div class="line">        seed, err := crand.Int(crand.Reader, big.NewInt(math.MaxInt64))</div><div class="line">        <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;<span class="comment">// æ‰§è¡Œå¤±è´¥ï¼Œæœ‰æŠ¥é”™</span></div><div class="line">            ethash.lock.Unlock() <span class="comment">// å…ˆè§£é”</span></div><div class="line">            <span class="keyword">return</span> <span class="literal">nil</span>, err <span class="comment">// ç¨‹åºä¸­æ­¢ï¼Œç›´æ¥è¿”å›ç©ºå—å’ŒæŠ¥é”™ä¿¡æ¯</span></div><div class="line">        &#125;</div><div class="line">        ethash.rand = rand.New(rand.NewSource(seed.Int64())) <span class="comment">// æ‰§è¡ŒæˆåŠŸï¼Œæ‹¿åˆ°åˆæ³•ç§å­seedï¼Œé€šè¿‡å…¶è·å¾—randå¯¹è±¡ï¼Œèµ‹å€¼ã€‚</span></div><div class="line">    &#125;</div><div class="line">    ethash.lock.Unlock() <span class="comment">// è§£é”</span></div><div class="line">    <span class="keyword">if</span> threads == <span class="number">0</span> &#123;<span class="comment">// æŒ–çŸ¿çº¿ç¨‹ç¼–å·ä¸º0ï¼Œåˆ™é€šè¿‡æ–¹æ³•è¿”å›å½“å‰ç‰©ç†ä¸Šå¯ç”¨CPUç¼–å·</span></div><div class="line">        threads = runtime.NumCPU()</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span> threads &lt; <span class="number">0</span> &#123; <span class="comment">// éæ³•ç»“æœ</span></div><div class="line">        threads = <span class="number">0</span> <span class="comment">// ç½®ä¸º0ï¼Œå…è®¸åœ¨æœ¬åœ°æˆ–è¿œç¨‹æ²¡æœ‰é¢å¤–é€»è¾‘çš„æƒ…å†µä¸‹ï¼Œå–æ¶ˆæœ¬åœ°æŒ–çŸ¿æ“ä½œ</span></div><div class="line">    &#125;</div><div class="line">    <span class="keyword">var</span> pend sync.WaitGroup <span class="comment">// åˆ›å»ºä¸€ä¸ªå€’è®¡æ—¶é”å¯¹è±¡ï¼Œgoè¯­æ³•å‚ç…§ http://www.cnblogs.com/Evsward/p/goPipeline.html#sync.waitgroup</span></div><div class="line">    <span class="keyword">for</span> i := <span class="number">0</span>; i &lt; threads; i++ &#123;</div><div class="line">        pend.Add(<span class="number">1</span>)</div><div class="line">        <span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">(id <span class="keyword">int</span>, nonce <span class="keyword">uint64</span>)</span></span> &#123;<span class="comment">// æ ¸å¿ƒä»£ç é€šè¿‡é—­åŒ…å¤šçº¿ç¨‹æŠ€æœ¯æ¥æ‰§è¡Œã€‚</span></div><div class="line">            <span class="keyword">defer</span> pend.Done()</div><div class="line">            ethash.mine(block, id, nonce, abort, found) <span class="comment">// Sealæ ¸å¿ƒå·¥ä½œ</span></div><div class="line">        &#125;(i, <span class="keyword">uint64</span>(ethash.rand.Int63()))<span class="comment">//é—­åŒ…ç¬¬äºŒä¸ªå‚æ•°è¡¨è¾¾å¼uint64(ethash.rand.Int63())é€šè¿‡ä¸Šé¢å‡†å¤‡å¥½çš„randå‡½æ•°éšæœºæ•°ç»“æœä½œä¸ºnonceå®å‚ä¼ å…¥æ–¹æ³•ä½“</span></div><div class="line">    &#125;</div><div class="line">    <span class="comment">// ç›´åˆ°sealæ“ä½œè¢«ä¸­æ­¢æˆ–è€…æ‰¾åˆ°äº†ä¸€ä¸ªnonceå€¼ï¼Œå¦åˆ™ä¸€ç›´ç­‰</span></div><div class="line">    <span class="keyword">var</span> result *types.Block <span class="comment">// å®šä¹‰ä¸€ä¸ªåŒºå—å¯¹è±¡resultï¼Œç”¨äºæ¥æ”¶æ“ä½œç»“æœå¹¶ä½œä¸ºè¿”å›å€¼è¿”å›ä¸Šä¸€å±‚</span></div><div class="line">    <span class="keyword">select</span> &#123; <span class="comment">// goè¯­æ³•å‚ç…§ http://www.cnblogs.com/Evsward/p/go.html#select</span></div><div class="line">    <span class="keyword">case</span> &lt;-stop:</div><div class="line">        <span class="comment">// å¤–éƒ¨æ„å¤–ä¸­æ­¢ï¼Œåœæ­¢æ‰€æœ‰æŒ–çŸ¿çº¿ç¨‹</span></div><div class="line">        <span class="built_in">close</span>(abort)</div><div class="line">    <span class="keyword">case</span> result = &lt;-found:</div><div class="line">        <span class="comment">// å…¶ä¸­ä¸€ä¸ªçº¿ç¨‹æŒ–åˆ°æ­£ç¡®å—ï¼Œä¸­æ­¢å…¶ä»–æ‰€æœ‰çº¿ç¨‹</span></div><div class="line">        <span class="built_in">close</span>(abort)</div><div class="line">    <span class="keyword">case</span> &lt;-ethash.update:</div><div class="line">        <span class="comment">// ethashå¯¹è±¡å‘ç”Ÿæ”¹å˜ï¼Œåœæ­¢å½“å‰æ‰€æœ‰æ“ä½œï¼Œé‡å¯å½“å‰æ–¹æ³•</span></div><div class="line">        <span class="built_in">close</span>(abort)</div><div class="line">        pend.Wait()</div><div class="line">        <span class="keyword">return</span> ethash.Seal(chain, block, stop)</div><div class="line">    &#125;</div><div class="line">    <span class="comment">// ç­‰å¾…æ‰€æœ‰çŸ¿å·¥åœæ­¢æˆ–è€…è¿”å›ä¸€ä¸ªåŒºå—</span></div><div class="line">    pend.Wait()</div><div class="line">    <span class="keyword">return</span> result, <span class="literal">nil</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>åœ¨sealä¸­é¦–å…ˆè¿›è¡Œäº†çŠ¶æ€æ ¡éªŒå¹¶è¿›è¡Œå¯¹åº”çš„æµç¨‹æ¢³ç†ï¼Œå…¶ä¸­æœ€é‡è¦çš„æ˜¯mineæ–¹æ³•</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// mineå‡½æ•°æ˜¯çœŸæ­£çš„powçŸ¿å·¥ï¼Œç”¨æ¥æœç´¢ä¸€ä¸ªnonceå€¼ï¼Œnonceå€¼å¼€å§‹äºseedå€¼ï¼Œseedå€¼æ˜¯èƒ½æœ€ç»ˆäº§ç”Ÿæ­£ç¡®çš„å¯åŒ¹é…å¯éªŒè¯çš„åŒºå—éš¾åº¦</span></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="params">(ethash *Ethash)</span> <span class="title">mine</span><span class="params">(block *types.Block, id <span class="keyword">int</span>, seed <span class="keyword">uint64</span>, abort <span class="keyword">chan</span> <span class="keyword">struct</span>&#123;&#125;, found <span class="keyword">chan</span> *types.Block)</span></span> &#123;</div><div class="line">    <span class="comment">// ä»åŒºå—å¤´ä¸­æå–å‡ºä¸€äº›æ•°æ®ï¼Œæ”¾åœ¨ä¸€ä¸ªå…¨å±€å˜é‡åŸŸä¸­</span></div><div class="line">    <span class="keyword">var</span> (</div><div class="line">        header = block.Header()</div><div class="line">        hash   = header.HashNoNonce().Bytes()</div><div class="line">        target = <span class="built_in">new</span>(big.Int).Div(maxUint256, header.Difficulty) <span class="comment">// ç”¨æ¥éªŒè¯çš„target</span></div><div class="line"></div><div class="line">        number  = header.Number.Uint64()</div><div class="line">        dataset = ethash.dataset(number)</div><div class="line">    )</div><div class="line">    <span class="comment">// å¼€å§‹ç”Ÿæˆéšæœºnonceå€¼çŸ¥é“æˆ‘ä»¬ä¸­æ­¢æˆ–è€…æˆåŠŸæ‰¾åˆ°äº†ä¸€ä¸ªåˆé€‚çš„å€¼</span></div><div class="line">    <span class="keyword">var</span> (</div><div class="line">        attempts = <span class="keyword">int64</span>(<span class="number">0</span>) <span class="comment">// åˆå§‹åŒ–ä¸€ä¸ªå°è¯•æ¬¡æ•°çš„å˜é‡ï¼Œä¸‹é¢ä¼šåˆ©ç”¨è¯¥å˜é‡è€ä¸€äº›èŠ±æª</span></div><div class="line">        nonce    = seed <span class="comment">// åˆå§‹åŒ–ä¸ºseedå€¼ï¼Œåé¢æ¯æ¬¡å°è¯•ä»¥åä¼šç´¯åŠ </span></div><div class="line">    )</div><div class="line">    logger := log.New(<span class="string">"miner"</span>, id)</div><div class="line">    logger.Trace(<span class="string">"Started ethash search for new nonces"</span>, <span class="string">"seed"</span>, seed)</div><div class="line">    <span class="keyword">for</span> &#123;</div><div class="line">        <span class="keyword">select</span> &#123;</div><div class="line">        <span class="keyword">case</span> &lt;-abort: <span class="comment">// ä¸­æ­¢å‘½ä»¤</span></div><div class="line">            <span class="comment">// æŒ–çŸ¿ä¸­æ­¢ï¼Œæ›´æ–°çŠ¶æ€ï¼Œä¸­æ­¢å½“å‰æ“ä½œï¼Œè¿”å›ç©º</span></div><div class="line">            logger.Trace(<span class="string">"Ethash nonce search aborted"</span>, <span class="string">"attempts"</span>, nonce-seed)</div><div class="line">            ethash.hashrate.Mark(attempts)</div><div class="line">            <span class="keyword">return</span></div><div class="line"></div><div class="line">        <span class="keyword">default</span>: <span class="comment">// é»˜è®¤æ‰§è¡Œ</span></div><div class="line">            <span class="comment">// æˆ‘ä»¬æ²¡å¿…è¦åœ¨æ¯ä¸€æ¬¡å°è¯•nonceå€¼çš„æ—¶å€™æ›´æ–°hashç‡ï¼Œå¯ä»¥åœ¨å°è¯•äº†2çš„Xæ¬¡æ–¹nonceå€¼ä»¥åå†æ›´æ–°å³å¯</span></div><div class="line">            attempts++ <span class="comment">// é€šè¿‡æ¬¡æ•°attempæ¥æ§åˆ¶</span></div><div class="line">            <span class="keyword">if</span> (attempts % (<span class="number">1</span> &lt;&lt; <span class="number">15</span>)) == <span class="number">0</span> &#123;<span class="comment">// è¿™é‡Œæ˜¯å®šçš„2çš„15æ¬¡æ–¹</span></div><div class="line">                ethash.hashrate.Mark(attempts) <span class="comment">// æ»¡è¶³æ¡ä»¶äº†ä»¥åï¼Œè¦æ›´æ–°ethashçš„hashç‡å­—æ®µçš„çŠ¶æ€å€¼</span></div><div class="line">                attempts = <span class="number">0</span> <span class="comment">// é‡ç½®å°è¯•æ¬¡æ•°</span></div><div class="line">            &#125;</div><div class="line">            <span class="comment">// ä¸ºè¿™ä¸ªnonceå€¼è®¡ç®—powå€¼</span></div><div class="line">            digest, result := hashimotoFull(dataset, hash, nonce) <span class="comment">// è°ƒç”¨çš„hashimotoFullå‡½æ•°åœ¨æœ¬åŒ…çš„ç®—æ³•åº“ä¸­</span></div><div class="line">            <span class="keyword">if</span> <span class="built_in">new</span>(big.Int).SetBytes(result).Cmp(target) &lt;= <span class="number">0</span> &#123; <span class="comment">// éªŒè¯æ ‡å‡†</span></div><div class="line">                <span class="comment">// æ‰¾åˆ°æ­£ç¡®nonceå€¼ï¼Œåˆ›å»ºä¸€ä¸ªåŸºäºå®ƒçš„æ–°çš„åŒºå—å¤´</span></div><div class="line">                header = types.CopyHeader(header)</div><div class="line">                header.Nonce = types.EncodeNonce(nonce) <span class="comment">// å°†è¾“å…¥çš„æ•´å‹å€¼è½¬æ¢ä¸ºä¸€ä¸ªåŒºå—nonceå€¼</span></div><div class="line">                header.MixDigest = common.BytesToHash(digest) <span class="comment">// å°†å­—èŠ‚æ•°ç»„è½¬æ¢ä¸ºHashå¯¹è±¡ã€Hashæ˜¯32ä½çš„æ ¹æ®ä»»æ„è¾“å…¥æ•°æ®çš„Keccak256å“ˆå¸Œç®—æ³•çš„è¿”å›å€¼ã€‘</span></div><div class="line"></div><div class="line">                <span class="comment">// å°è£…è¿”å›ä¸€ä¸ªåŒºå—</span></div><div class="line">                <span class="keyword">select</span> &#123;</div><div class="line">                <span class="keyword">case</span> found &lt;- block.WithSeal(header):</div><div class="line">                    logger.Trace(<span class="string">"Ethash nonce found and reported"</span>, <span class="string">"attempts"</span>, nonce-seed, <span class="string">"nonce"</span>, nonce)</div><div class="line">                <span class="keyword">case</span> &lt;-abort:</div><div class="line">                    logger.Trace(<span class="string">"Ethash nonce found but discarded"</span>, <span class="string">"attempts"</span>, nonce-seed, <span class="string">"nonce"</span>, nonce)</div><div class="line">                &#125;</div><div class="line">                <span class="keyword">return</span></div><div class="line">            &#125;</div><div class="line">            nonce++ <span class="comment">// ç´¯åŠ nonce</span></div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>mineæ–¹æ³•ä¸»è¦å°±æ˜¯å¯¹nonceçš„æ“ä½œï¼Œä»¥åŠå¯¹åŒºå—å¤´çš„é‡å»ºæ“ä½œ</p>
<h3 id="Clique"><a href="#Clique" class="headerlink" title="Clique"></a>Clique</h3><p>Cliqueæ˜¯ä»¥å¤ªåŠåŸºäºæƒåˆ©è¯æ˜çš„POAå…±è¯†ç®—æ³•</p>
<p>Cliqueé€šè¿‡å‡½æ•°Ethereum.StartMiningè¿›è¡Œåˆå§‹åŒ–</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="params">(s *Ethereum)</span> <span class="title">StartMining</span><span class="params">(local <span class="keyword">bool</span>)</span> <span class="title">error</span></span> &#123;</div><div class="line">    eb, err := s.Etherbase()<span class="comment">//ç”¨æˆ·åœ°å€</span></div><div class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</div><div class="line">        log.Error(<span class="string">"Cannot start mining without etherbase"</span>, <span class="string">"err"</span>, err)</div><div class="line">        <span class="keyword">return</span> fmt.Errorf(<span class="string">"etherbase missing: %v"</span>, err)</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">if</span> clique, ok := s.engine.(*clique.Clique); ok &#123;</div><div class="line">        <span class="comment">//å¦‚æœæ˜¯cliqueå…±è¯†ç®—æ³•</span></div><div class="line">        wallet, err := s.accountManager.Find(accounts.Account&#123;Address: eb&#125;)    <span class="comment">// æ ¹æ®ç”¨å®ƒèƒ¡åœ°å€è·å–walletå¯¹è±¡</span></div><div class="line">        <span class="keyword">if</span> wallet == <span class="literal">nil</span> || err != <span class="literal">nil</span> &#123;</div><div class="line">            log.Error(<span class="string">"Etherbase account unavailable locally"</span>, <span class="string">"err"</span>, err)</div><div class="line">            <span class="keyword">return</span> fmt.Errorf(<span class="string">"signer missing: %v"</span>, err)</div><div class="line">        &#125;</div><div class="line">        clique.Authorize(eb, wallet.SignHash) <span class="comment">// æ³¨å…¥ç­¾åè€…ä»¥åŠwalletå¯¹è±¡è·å–ç­¾åæ–¹æ³•</span></div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span> local &#123;</div><div class="line">        <span class="comment">// å¦‚æœæœ¬åœ°CPUå·²å¼€å§‹æŒ–çŸ¿ï¼Œæˆ‘ä»¬å¯ä»¥ç¦ç”¨å¼•å…¥çš„äº¤æ˜“æ‹’ç»æœºåˆ¶æ¥åŠ é€ŸåŒæ­¥æ—¶é—´ã€‚CPUæŒ–çŸ¿åœ¨ä¸»ç½‘æ˜¯è’è¯çš„ï¼Œæ‰€ä»¥æ²¡æœ‰äººèƒ½ç¢°åˆ°è¿™ä¸ªè·¯å¾„ï¼Œç„¶è€Œä¸€æ—¦CPUæŒ–çŸ¿åŒæ­¥æ ‡å¿—å®Œæˆä»¥åï¼Œå°†ä¿è¯ç§ç½‘å·¥ä½œä¹Ÿåœ¨ä¸€ä¸ªç‹¬ç«‹çŸ¿å·¥ç»“ç‚¹ã€‚</span></div><div class="line">        atomic.StoreUint32(&amp;s.protocolManager.acceptTxs, <span class="number">1</span>)</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">go</span> s.miner.Start(eb)</div><div class="line">    <span class="keyword">return</span> <span class="literal">nil</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Cliqueç®—æ³•åœ¨ä»¥å¤ªåŠä¸­ä¹Ÿæ˜¯é€šè¿‡sealæ¥å®ç°</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//é€šè¿‡æœ¬åœ°ç­¾åè®¤è¯åˆ›å»ºå·²å¯†å°çš„åŒºå—</span></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c *Clique)</span> <span class="title">Seal</span><span class="params">(chain consensus.ChainReader, block *types.Block, stop &lt;-<span class="keyword">chan</span> <span class="keyword">struct</span>&#123;&#125;)</span> <span class="params">(*types.Block, error)</span></span> &#123;</div><div class="line">        header := block.Header()</div><div class="line">    <span class="comment">// ä¸å¯†å°åˆ›ä¸–å—</span></div><div class="line">    number := header.Number.Uint64()</div><div class="line">    <span class="keyword">if</span> number == <span class="number">0</span> &#123;</div><div class="line">        <span class="keyword">return</span> <span class="literal">nil</span>, errUnknownBlock</div><div class="line">    &#125;</div><div class="line">    <span class="comment">// ä¸æ”¯æŒ0-periodçš„é“¾ï¼Œä¸æ”¯æŒç©ºå—å¯†å°ï¼Œæ²¡æœ‰å¥–åŠ±ä½†æ˜¯èƒ½å¤Ÿå¯†å°</span></div><div class="line">    <span class="keyword">if</span> c.config.Period == <span class="number">0</span> &amp;&amp; <span class="built_in">len</span>(block.Transactions()) == <span class="number">0</span> &#123;</div><div class="line">        <span class="keyword">return</span> <span class="literal">nil</span>, errWaitTransactions</div><div class="line">    &#125;</div><div class="line">    <span class="comment">// åœ¨æ•´ä¸ªå¯†å°åŒºå—çš„è¿‡ç¨‹ä¸­ä¸è¦æŒæœ‰signerç­¾åè€…å­—æ®µ</span></div><div class="line">    c.lock.RLock()</div><div class="line">    signer, signFn := c.signer, c.signFn <span class="comment">//è·å–ç­¾åè€…å’Œç­¾åæ–¹æ³•</span></div><div class="line">    c.lock.RUnlock()</div><div class="line"></div><div class="line">    snap, err := c.snapshot(chain, number<span class="number">-1</span>, header.ParentHash, <span class="literal">nil</span>) <span class="comment">//è°ƒç”¨è·å–å¿«ç…§</span></div><div class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</div><div class="line">        <span class="keyword">return</span> <span class="literal">nil</span>, err</div><div class="line">    &#125;</div><div class="line"><span class="comment">//æ£€æŸ¥æˆ‘ä»¬æ˜¯å¦è¢«æˆæƒå»ç­¾åä¸€ä¸ªåŒºå—</span></div><div class="line">    <span class="keyword">if</span> _, authorized := snap.Signers[signer]; !authorized &#123;</div><div class="line">        <span class="keyword">return</span> <span class="literal">nil</span>, errUnauthorized</div><div class="line">    &#125;</div><div class="line">    <span class="comment">// å¦‚æœæˆ‘ä»¬æ˜¯åœ¨â€˜æœ€è¿‘ç­¾åè€…â€™ä¸­åˆ™ç­‰å¾…ä¸‹ä¸€ä¸ªåŒºå—</span></div><div class="line">    <span class="keyword">for</span> seen, recent := <span class="keyword">range</span> snap.Recents &#123;</div><div class="line">        <span class="keyword">if</span> recent == signer &#123;</div><div class="line">            <span class="comment">// å½“å‰ç­¾åè€…åœ¨â€˜æœ€è¿‘ç­¾åè€…â€™ä¸­ï¼Œå¦‚æœå½“å‰åŒºå—æ²¡æœ‰å‰”é™¤ä»–çš„è¯åªèƒ½ç­‰å¾…ï¼ˆè¿™é‡Œæ¶‰åŠåˆ°æœºä¼šå‡ç­‰ï¼‰</span></div><div class="line">            <span class="keyword">if</span> limit := <span class="keyword">uint64</span>(<span class="built_in">len</span>(snap.Signers)/<span class="number">2</span> + <span class="number">1</span>); number &lt; limit || seen &gt; number-limit &#123;</div><div class="line">                log.Info(<span class="string">"Signed recently, must wait for others"</span>)</div><div class="line">                &lt;-stop</div><div class="line">                <span class="keyword">return</span> <span class="literal">nil</span>, <span class="literal">nil</span></div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="comment">// åè®®å·²ç»å…è®¸æˆ‘ä»¬æ¥ç­¾åè¿™ä¸ªåŒºå—ï¼Œç­‰å¾…æˆ‘ä»¬çš„æ—¶é—´</span></div><div class="line">    delay := time.Unix(header.Time.Int64(), <span class="number">0</span>).Sub(time.Now()) <span class="comment">// nolint: gosimple</span></div><div class="line">    <span class="keyword">if</span> header.Difficulty.Cmp(diffNoTurn) == <span class="number">0</span> &#123;</div><div class="line">        <span class="comment">// è¿™ä¸æ˜¯æˆ‘ä»¬çš„è½®æ¬¡æ¥ç­¾åï¼Œå»¶è¿Ÿä¸€ç‚¹ï¼Œéšæœºå»¶è¿Ÿï¼Œè¿™æ ·å¯¹äºæ¯ä¸€ä¸ªç­¾åè€…æ¥è¯´æ¥å…è®¸å¹¶å‘ç­¾å</span></div><div class="line">        wiggle := time.Duration(<span class="built_in">len</span>(snap.Signers)/<span class="number">2</span>+<span class="number">1</span>) * wiggleTime</div><div class="line">        delay += time.Duration(rand.Int63n(<span class="keyword">int64</span>(wiggle)))</div><div class="line"></div><div class="line">        log.Trace(<span class="string">"Out-of-turn signing requested"</span>, <span class="string">"wiggle"</span>, common.PrettyDuration(wiggle))</div><div class="line">    &#125;</div><div class="line">    log.Trace(<span class="string">"Waiting for slot to sign and propagate"</span>, <span class="string">"delay"</span>, common.PrettyDuration(delay))</div><div class="line"></div><div class="line">    <span class="keyword">select</span> &#123;</div><div class="line">    <span class="keyword">case</span> &lt;-stop:</div><div class="line">        <span class="keyword">return</span> <span class="literal">nil</span>, <span class="literal">nil</span></div><div class="line">    <span class="keyword">case</span> &lt;-time.After(delay):</div><div class="line">    &#125;</div><div class="line">    <span class="comment">// é€šè¿‡signFnç­¾åå‡½æ•°å¼€å§‹ç­¾å</span></div><div class="line">    sighash, err := signFn(accounts.Account&#123;Address: signer&#125;, sigHash(header).Bytes())</div><div class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</div><div class="line">        <span class="keyword">return</span> <span class="literal">nil</span>, err</div><div class="line">    &#125;</div><div class="line">    <span class="comment">//å°†ç­¾åç»“æœæ›¿æ¢ä¿å­˜åœ¨åŒºå—å¤´çš„Extraå­—æ®µä¸­</span></div><div class="line">    <span class="built_in">copy</span>(header.Extra[<span class="built_in">len</span>(header.Extra)-extraSeal:], sighash)</div><div class="line">    <span class="comment">//é€šè¿‡åŒºå—å¤´é‡æ–°ç»„è£…ç”Ÿæˆä¸€ä¸ªåŒºå—</span></div><div class="line">    <span class="keyword">return</span> block.WithSeal(header), <span class="literal">nil</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>æ³¨æ„ä»¥ä¸‹å‡ ç‚¹ï¼š</strong></p>
<ul>
<li>signerä¸åœ¨snapshotçš„signerä¸­ä¸å…è®¸ç­¾å</li>
<li>signerä¸æ˜¯æœ¬åŒºå—çš„ç­¾åè€…éœ€è¦å»¶æ—¶éšæœºä¸€æ®µæ—¶å€™åå†ç­¾åï¼Œæ˜¯æœ¬åŒºå—çš„ç­¾åè€…åˆ™ç›´æ¥ç­¾å</li>
<li>ç­¾åå­˜æ”¾åœ¨Extraçš„extraSealçš„65ä¸ªå­—èŠ‚ä¸­</li>
<li>ä¸ºäº†ä¿è¯æœºä¼šå‡ç­‰ï¼Œcliqueä¸­è§„å®šæ¯ä¸€ä¸ªè®¤è¯èŠ‚ç‚¹åœ¨è¿ç»­SIGNER_LIMITä¸ªåŒºå—ä¸­ï¼Œæœ€å¤šåªèƒ½ç­¾å‘ä¸€ä¸ªåŒºå—ï¼Œæ¯ä¸€è½®ä¸­ï¼Œæœ€å¤šåªæœ‰SIGNER_COUNT - SIGNER_LIMITä¸ªè®¤è¯èŠ‚ç‚¹å¯ä»¥å‚ä¸åŒºå—ç­¾å‘</li>
<li>ä¸ºäº†ä¿è¯è®¡ç®—éš¾åº¦ç›¸åŒï¼Œæ¯ä¸ªèŠ‚ç‚¹åœ¨ç­¾å‘æ—¶éƒ½ä¼šåˆ¤æ–­æœ¬èŠ‚ç‚¹æ˜¯ä¸æ˜¯æœ¬è½®çš„inturnèŠ‚ç‚¹ï¼Œè‹¥æ˜¯inturnèŠ‚ç‚¹ï¼Œåˆ™è¯¥èŠ‚ç‚¹äº§ç”Ÿçš„åŒºå—éš¾åº¦ä¸º2ï¼Œå¦åˆ™ä¸º1</li>
</ul>
<h3 id="æ–‡ç« æ¥æº"><a href="#æ–‡ç« æ¥æº" class="headerlink" title="æ–‡ç« æ¥æº"></a>æ–‡ç« æ¥æº</h3><blockquote>
<p><a href="https://blog.csdn.net/sportshark/article/details/51905955" target="_blank" rel="external">https://blog.csdn.net/sportshark/article/details/51905955</a></p>
<p><a href="https://blog.csdn.net/sportshark/article/details/51905965" target="_blank" rel="external">https://blog.csdn.net/sportshark/article/details/51905965</a></p>
<p><a href="https://blog.csdn.net/itcastcpp/article/details/80304343" target="_blank" rel="external">https://blog.csdn.net/itcastcpp/article/details/80304343</a></p>
<p><a href="https://www.cnblogs.com/Evsward/p/ethash.html" target="_blank" rel="external">https://www.cnblogs.com/Evsward/p/ethash.html</a></p>
<p><a href="https://www.cnblogs.com/Evsward/p/miner.html" target="_blank" rel="external">https://www.cnblogs.com/Evsward/p/miner.html</a></p>
<p><a href="https://blog.csdn.net/ddffr/article/details/78773961" target="_blank" rel="external">https://blog.csdn.net/ddffr/article/details/78773961</a></p>
<p><a href="https://ethfans.org/posts/Clique-Consensus-Algorithm" target="_blank" rel="external">https://ethfans.org/posts/Clique-Consensus-Algorithm</a></p>
<p><a href="https://segmentfault.com/a/1190000014544347" target="_blank" rel="external">https://segmentfault.com/a/1190000014544347</a></p>
</blockquote>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;ä»¥å¤ªåŠæºç åˆ†æ&quot;&gt;&lt;a href=&quot;#ä»¥å¤ªåŠæºç åˆ†æ&quot; class=&quot;headerlink&quot; title=&quot;ä»¥å¤ªåŠæºç åˆ†æ&quot;&gt;&lt;/a&gt;ä»¥å¤ªåŠæºç åˆ†æ&lt;/h2&gt;&lt;h3 id=&quot;ä»¥å¤ªåŠå…±è¯†ç®—æ³•åˆ†ä¸ºä¸¤ç±»&quot;&gt;&lt;a href=&quot;#ä»¥å¤ªåŠå…±è¯†ç®—æ³•åˆ†ä¸ºä¸¤ç±»&quot; class=&quot;headerlink&quot; title=&quot;ä»¥å¤ªåŠå…±è¯†ç®—æ³•åˆ†ä¸ºä¸¤ç±»&quot;&gt;&lt;/a&gt;ä»¥å¤ªåŠå…±è¯†ç®—æ³•åˆ†ä¸ºä¸¤ç±»&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;Ethashç®—æ³•&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;Cliqueç®—æ³•&lt;/strong&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="æŠ€æœ¯" scheme="http://jiaotingyu.me/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
      <category term="Golang" scheme="http://jiaotingyu.me/tags/Golang/"/>
    
      <category term="ä»¥å¤ªåŠ" scheme="http://jiaotingyu.me/tags/%E4%BB%A5%E5%A4%AA%E5%9D%8A/"/>
    
  </entry>
  
  <entry>
    <title>ä»¥å¤ªåŠå­¦ä¹ ç¬”è®°ï¼ˆåäº”ï¼‰</title>
    <link href="http://jiaotingyu.me/2018/09/24/%E4%BB%A5%E5%A4%AA%E5%9D%8A%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%88%E5%8D%81%E4%BA%94%EF%BC%89/"/>
    <id>http://jiaotingyu.me/2018/09/24/ä»¥å¤ªåŠå­¦ä¹ ç¬”è®°ï¼ˆåäº”ï¼‰/</id>
    <published>2018-09-23T16:00:00.000Z</published>
    <updated>2020-05-18T15:28:23.355Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ä»¥å¤ªåŠæ•°æ®å­˜å‚¨"><a href="#ä»¥å¤ªåŠæ•°æ®å­˜å‚¨" class="headerlink" title="ä»¥å¤ªåŠæ•°æ®å­˜å‚¨"></a>ä»¥å¤ªåŠæ•°æ®å­˜å‚¨</h2><h3 id="åŒºå—"><a href="#åŒºå—" class="headerlink" title="åŒºå—"></a>åŒºå—</h3><p>åŒºå—blockä¸»è¦ç”±headerå’Œbodyä¸¤éƒ¨åˆ†ç»„æˆ</p>
<a id="more"></a>
<p>blockæºç </p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">type</span> Block <span class="keyword">struct</span> &#123;</div><div class="line">    header       *Header            <span class="comment">//åŒºå—å¤´</span></div><div class="line">    uncles       []*Header          <span class="comment">//å”èŠ‚ç‚¹</span></div><div class="line">    transactions Transactions       <span class="comment">//äº¤æ˜“æ•°ç»„</span></div><div class="line">    hash atomic.Value</div><div class="line">    size atomic.Value</div><div class="line">    td *big.Int                      <span class="comment">//æ‰€æœ‰åŒºå—Difficultyä¹‹å’Œ</span></div><div class="line">    ReceivedAt   time.Time</div><div class="line">    ReceivedFrom <span class="keyword">interface</span>&#123;&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">type</span> Header <span class="keyword">struct</span> &#123;</div><div class="line">    ParentHash  common.Hash    <span class="comment">//æŒ‡å‘çˆ¶åŒºå—çš„æŒ‡é’ˆ</span></div><div class="line">    UncleHash   common.Hash    <span class="comment">//blockä¸­å”å—æ•°ç»„çš„RLPå“ˆå¸Œå€¼</span></div><div class="line">    Coinbase    common.Address <span class="comment">//æŒ–å‡ºè¯¥åŒºå—çš„äººçš„åœ°å€</span></div><div class="line">    Root        common.Hash    <span class="comment">//StateDBä¸­çš„stat trieçš„æ ¹èŠ‚ç‚¹çš„RLPå“ˆå¸Œå€¼</span></div><div class="line">    TxHash      common.Hash    <span class="comment">//tx trieçš„æ ¹èŠ‚ç‚¹çš„å“ˆå¸Œå€¼</span></div><div class="line">    ReceiptHash common.Hash    <span class="comment">//receipt trieçš„æ ¹èŠ‚ç‚¹çš„å“ˆå¸Œå€¼</span></div><div class="line">    Bloom       Bloom          <span class="comment">//å¸ƒéš†è¿‡æ»¤å™¨ï¼Œç”¨æ¥åˆ¤æ–­Logå¯¹è±¡æ˜¯å¦å­˜åœ¨</span></div><div class="line">    Difficulty  *big.Int       <span class="comment">//éš¾åº¦ç³»æ•°</span></div><div class="line">    Number      *big.Int       <span class="comment">//åŒºå—åºå·</span></div><div class="line">    GasLimit    <span class="keyword">uint64</span>         <span class="comment">//åŒºå—å†…æ‰€æœ‰Gasæ¶ˆè€—çš„ç†è®ºä¸Šé™</span></div><div class="line">    GasUsed     <span class="keyword">uint64</span>         <span class="comment">//åŒºå—å†…æ¶ˆè€—çš„æ€»Gas</span></div><div class="line">    Time        *big.Int       <span class="comment">//åŒºå—åº”è¯¥è¢«åˆ›å»ºçš„æ—¶é—´</span></div><div class="line">    Nonce       BlockNonce     <span class="comment">//æŒ–çŸ¿å¿…é¡»çš„å€¼</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">type</span> Body <span class="keyword">struct</span> &#123;</div><div class="line">    Transactions []*Transaction <span class="comment">//äº¤æ˜“çš„æ•°ç»„</span></div><div class="line">    Uncles       []*Header</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="MPTæ ‘"><a href="#MPTæ ‘" class="headerlink" title="MPTæ ‘"></a>MPTæ ‘</h3><p>MPTæ˜¯ä»¥å¤ªåŠè‡ªå®šä¹‰çš„æ ‘å½¢æ•°æ®ç»“æ„</p>
<p>Trieæ ‘</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">type</span> Trie <span class="keyword">struct</span> &#123;</div><div class="line">    root         node   <span class="comment">//æ ¹èŠ‚ç‚¹</span></div><div class="line">    db           Database   <span class="comment">//æ•°æ®åº“ç›¸å…³</span></div><div class="line">    originalRoot common.Hash    <span class="comment">//åˆæ¬¡åˆ›å»ºtrieæ—¶å€™éœ€è¦ç”¨åˆ°</span></div><div class="line">    cachegen, cachelimit <span class="keyword">uint16</span> <span class="comment">//cacheæ¬¡æ•°çš„è®¡æ•°å™¨ï¼Œæ¯æ¬¡Trieçš„å˜åŠ¨æäº¤åè‡ªå¢</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>åœ¨Trieç»“æ„ä½“ä¸­ï¼Œrootä½œä¸ºæ•´ä¸ªMPTçš„æ ¹èŠ‚ç‚¹ï¼Œrootæ¥å£æœ‰å››ç§å®ç°ç±»</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">type</span> (</div><div class="line">    fullNode <span class="keyword">struct</span> &#123;</div><div class="line">        Children [<span class="number">17</span>]node</div><div class="line">        flags    nodeFlag</div><div class="line">    &#125;</div><div class="line">    shortNode <span class="keyword">struct</span> &#123;</div><div class="line">        Key   []<span class="keyword">byte</span></div><div class="line">        Val   node</div><div class="line">        flags nodeFlag</div><div class="line">    &#125;</div><div class="line">    hashNode  []<span class="keyword">byte</span></div><div class="line">    valueNode []<span class="keyword">byte</span></div><div class="line">)</div></pre></td></tr></table></figure>
<ul>
<li><p>fullNodeï¼šæœ‰ä¸€ä¸ªå®¹é‡ä¸º17çš„nodeæ•°ç»„æˆå‘˜å˜é‡Childrenï¼Œæ•°ç»„ä¸­å‰16ä¸ªç©ºä½åˆ†åˆ«å¯¹åº”16è¿›åˆ¶(hex)ä¸‹çš„0-9a-fï¼Œæ ¹æ®å­èŠ‚ç‚¹çš„keyå€¼16è¿›åˆ¶å½¢å¼ä¸‹çš„ç¬¬ä¸€ä½çš„å€¼ï¼Œåˆ†åˆ«å¯¹åº”åˆ°16ä¸ªç©ºä½ä¸Šï¼ŒChildrençš„ç¬¬17ä½ç•™ç»™fullNodeçš„æ•°æ®éƒ¨åˆ†</p>
</li>
<li><p>shortNodeï¼šä»…æœ‰ä¸€ä¸ªå­èŠ‚ç‚¹ï¼Œæˆå‘˜Valå¯¹åº”çš„è¯¥å­èŠ‚ç‚¹ï¼Œkeyæ˜¯ä»»æ„é•¿åº¦çš„å­—ç¬¦ä¸²ã€‚MPTä¼šé€šè¿‡åˆå¹¶åªæœ‰ä¸€ä¸ªå­èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹å’Œå…¶å­èŠ‚ç‚¹æ¥ç¼©çŸ­trieçš„æ·±åº¦ï¼Œæ‰€ä»¥æœ‰äº›èŠ‚ç‚¹ä¼šæœ‰é•¿åº¦æ›´é•¿çš„key</p>
</li>
<li><p>valueNodeï¼šæ˜¯MPTçš„å¶å­èŠ‚ç‚¹ï¼ŒvalueNodeå°±æ˜¯æ‰€æºå¸¦æ•°æ®éƒ¨åˆ†çš„RLPå“ˆå¸Œå€¼ï¼Œé•¿åº¦32byteï¼Œæ•°æ®çš„RLPç¼–ç å€¼ä½œä¸ºvalueNodeçš„åŒ¹é…é¡¹å­˜å‚¨åœ¨æ•°æ®åº“é‡Œ</p>
</li>
<li><p>hashNodeï¼šå­˜æ”¾32byteçš„å“ˆå¸Œå€¼ï¼Œä¹Ÿæ²¡æœ‰å­èŠ‚ç‚¹ï¼Œæ˜¯fullNodeæˆ–è€…shortNodeå¯¹è±¡çš„RLPå“ˆå¸Œå€¼</p>
</li>
</ul>
<p><strong>æ¯ä¸ªçˆ¶èŠ‚ç‚¹çš„å“ˆå¸Œå€¼æ¥æºäºæ‰€æœ‰å­èŠ‚ç‚¹å“ˆå¸Œå€¼çš„ç»„åˆï¼Œä¸€ä¸ªé¡¶ç‚¹çš„å“ˆå¸Œå€¼èƒ½å¤Ÿä»£è¡¨ä¸€æ•´ä¸ªæ ‘å½¢ç»“æ„</strong></p>
<h3 id="å­˜å‚¨"><a href="#å­˜å‚¨" class="headerlink" title="å­˜å‚¨"></a>å­˜å‚¨</h3><p>ä»¥å¤ªåŠä¸­ä½¿ç”¨levelDBæ•°æ®åº“</p>
<ul>
<li><p>headerå’Œblockå­˜å‚¨è§„åˆ™</p>
  <figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">    headerPrefix        = []<span class="keyword">byte</span>(<span class="string">"h"</span>) <span class="comment">// headerPrefix + num (uint64 big endian) + hash -&gt; header</span></div><div class="line">    tdSuffix            = []<span class="keyword">byte</span>(<span class="string">"t"</span>) <span class="comment">// headerPrefix + num (uint64 big endian) + hash + tdSuffix -&gt; td</span></div><div class="line">    numSuffix           = []<span class="keyword">byte</span>(<span class="string">"n"</span>) <span class="comment">// headerPrefix + num (uint64 big endian) + numSuffix -&gt; hash</span></div><div class="line">    blockHashPrefix     = []<span class="keyword">byte</span>(<span class="string">"H"</span>) <span class="comment">// blockHashPrefix + hash -&gt; num (uint64 big endian)</span></div><div class="line">    bodyPrefix          = []<span class="keyword">byte</span>(<span class="string">"b"</span>) <span class="comment">// bodyPrefix + num (uint64 big endian) + hash -&gt; block body</span></div><div class="line">    blockReceiptsPrefix = []<span class="keyword">byte</span>(<span class="string">"r"</span>) <span class="comment">// blockReceiptsPrefix + num (uint64 big endian) + hash -&gt; block receipts</span></div><div class="line">    lookupPrefix        = []<span class="keyword">byte</span>(<span class="string">"l"</span>) <span class="comment">// lookupPrefix + hash -&gt; transaction/receipt lookup metadata</span></div><div class="line">bloomBitsPrefix     = []<span class="keyword">byte</span>(<span class="string">"B"</span>) <span class="comment">// bloomBitsPrefix + bit (uint16 big endian) + section (uint64 big endian) + hash -&gt; bloom bits</span></div></pre></td></tr></table></figure>
<p>  å…¶ä¸­numä¸ºåŒºå—å· hashä¸ºåŒºå—å“ˆå¸Œå€¼</p>
<p>  Headerçš„çˆ¶æŒ‡é’ˆæ˜¯ä¸èƒ½ä¿®æ”¹çš„ï¼Œå½“æŠŠHeaderå†™å…¥æ•°æ®åº“æ˜¯å¿…é¡»æŠŠä»–çš„çˆ¶èŠ‚ç‚¹å’Œçˆ¶èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹ç­‰ç­‰å†™å…¥æ•°æ®åº“</p>
</li>
</ul>
<ul>
<li><p>äº¤æ˜“å­˜å‚¨</p>
  <figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">WriteTxLookupEntries</span><span class="params">(db ethdb.Putter, block *types.Block)</span> <span class="title">error</span></span> &#123;</div><div class="line">    <span class="comment">// éå†æ¯ä¸ªäº¤æ˜“å¹¶ä¸”ç¼–ç å…ƒæ•°æ®</span></div><div class="line">    <span class="keyword">for</span> i, tx := <span class="keyword">range</span> block.Transactions() &#123;</div><div class="line">        entry := TxLookupEntry&#123;</div><div class="line">            BlockHash:  block.Hash(),</div><div class="line">            BlockIndex: block.NumberU64(),</div><div class="line">            Index:      <span class="keyword">uint64</span>(i),</div><div class="line">        &#125;</div><div class="line">        data, err := rlp.EncodeToBytes(entry)</div><div class="line">        <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</div><div class="line">            <span class="keyword">return</span> err</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span> err := db.Put(<span class="built_in">append</span>(lookupPrefix, tx.Hash().Bytes()...), data); err != <span class="literal">nil</span> &#123;</div><div class="line">            <span class="keyword">return</span> err</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="literal">nil</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>  å°†åŒºå—å·ã€åŒºå—å“ˆå¸Œå€¼ç­‰æ•°æ®ç¼–ç è¿›è¡Œå­˜å‚¨</p>
</li>
<li><p>StateDBæ¨¡å—</p>
<p>  æ‰€æœ‰çš„è´¦æˆ·ç”±StateDBç®¡ç†ï¼ŒStateDBä¸­æœ‰ä¸€ä¸ªtrieç»“æ„å’Œä¸€ä¸ªmapç»“æ„ï¼Œéƒ½ç”¨æ¥å­˜å‚¨stateObjectï¼Œæ¯ä¸ªstateObjectæœ‰20bytesçš„åœ°å€ï¼Œå¯ä»¥ä½œä¸ºkeyä½¿ç”¨</p>
</li>
<li><p>å­˜å‚¨è´¦æˆ·(stateObject)</p>
<p>  ä¸€ä¸ªstateObjectå¯¹åº”ä¸€ä¸ªè´¦æˆ·ï¼Œä¸€ä¸ªè´¦æˆ·åŒ…å«ä½™é¢ã€åˆçº¦å‘èµ·æ¬¡æ•°ç­‰æ•°æ®ï¼ŒstateObjectè¿˜åŒ…å«äº†ä¸€ä¸ªtrieï¼Œç”¨æ¥å­˜å‚¨Stateæ•°æ®</p>
</li>
</ul>
<h3 id="æ–‡ç« æ¥æºï¼š"><a href="#æ–‡ç« æ¥æºï¼š" class="headerlink" title="æ–‡ç« æ¥æºï¼š"></a>æ–‡ç« æ¥æºï¼š</h3><blockquote>
<p><a href="http://www.blockchainbrother.com/article/805" target="_blank" rel="external">http://www.blockchainbrother.com/article/805</a></p>
<p><a href="https://blog.csdn.net/ddffr/article/details/74517608" target="_blank" rel="external">https://blog.csdn.net/ddffr/article/details/74517608</a></p>
<p><a href="https://juejin.im/post/5a4f3aa9f265da3e5468e08e" target="_blank" rel="external">https://juejin.im/post/5a4f3aa9f265da3e5468e08e</a></p>
<p><a href="https://blog.csdn.net/teaspring/article/details/75390210" target="_blank" rel="external">https://blog.csdn.net/teaspring/article/details/75390210</a></p>
</blockquote>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;ä»¥å¤ªåŠæ•°æ®å­˜å‚¨&quot;&gt;&lt;a href=&quot;#ä»¥å¤ªåŠæ•°æ®å­˜å‚¨&quot; class=&quot;headerlink&quot; title=&quot;ä»¥å¤ªåŠæ•°æ®å­˜å‚¨&quot;&gt;&lt;/a&gt;ä»¥å¤ªåŠæ•°æ®å­˜å‚¨&lt;/h2&gt;&lt;h3 id=&quot;åŒºå—&quot;&gt;&lt;a href=&quot;#åŒºå—&quot; class=&quot;headerlink&quot; title=&quot;åŒºå—&quot;&gt;&lt;/a&gt;åŒºå—&lt;/h3&gt;&lt;p&gt;åŒºå—blockä¸»è¦ç”±headerå’Œbodyä¸¤éƒ¨åˆ†ç»„æˆ&lt;/p&gt;
    
    </summary>
    
      <category term="æŠ€æœ¯" scheme="http://jiaotingyu.me/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
      <category term="Golang" scheme="http://jiaotingyu.me/tags/Golang/"/>
    
      <category term="ä»¥å¤ªåŠ" scheme="http://jiaotingyu.me/tags/%E4%BB%A5%E5%A4%AA%E5%9D%8A/"/>
    
  </entry>
  
  <entry>
    <title>ä»¥å¤ªåŠå­¦ä¹ ç¬”è®°ï¼ˆåå››ï¼‰</title>
    <link href="http://jiaotingyu.me/2018/09/22/%E4%BB%A5%E5%A4%AA%E5%9D%8A%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%88%E5%8D%81%E5%9B%9B%EF%BC%89/"/>
    <id>http://jiaotingyu.me/2018/09/22/ä»¥å¤ªåŠå­¦ä¹ ç¬”è®°ï¼ˆåå››ï¼‰/</id>
    <published>2018-09-21T16:00:00.000Z</published>
    <updated>2020-05-18T15:28:17.031Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ä»¥å¤ªåŠæºç åˆ†æ"><a href="#ä»¥å¤ªåŠæºç åˆ†æ" class="headerlink" title="ä»¥å¤ªåŠæºç åˆ†æ"></a>ä»¥å¤ªåŠæºç åˆ†æ</h2><h3 id="RLPxåŠ å¯†é€šä¿¡åè®®"><a href="#RLPxåŠ å¯†é€šä¿¡åè®®" class="headerlink" title="RLPxåŠ å¯†é€šä¿¡åè®®"></a>RLPxåŠ å¯†é€šä¿¡åè®®</h3><p>PLPxå±äºä¼šè¯å±‚åè®®ï¼Œä¸»è¦åŠŸèƒ½æ˜¯åœ¨èŠ‚ç‚¹ä¹‹é—´å»ºç«‹å¹¶ç»´æŒé€šä¿¡</p>
<p>RLPxåè®®æ¯æ¬¡å»ºç«‹è¿æ¥éƒ½ä½¿ç”¨ä¸åŒçš„å¯†é’¥ï¼Œå³ä½¿ç°æœ‰çš„å¯†é’¥æ³„éœ²ä¹Ÿä¸ä¼šå¯¼è‡´ä¹‹å‰çš„ä¿¡æ¯è¢«ç ´è§£</p>
<p>å®ç°åŸç†ï¼šè¿æ¥åŒæ–¹å„è‡ªç”Ÿæˆä¸€ä¸ªç§é’¥ï¼Œç„¶åå°†å¾—åˆ°çš„å…¬é’¥å‘é€ç»™å¯¹æ–¹ï¼ŒåŒæ–¹å†åˆ©ç”¨è‡ªå·±çš„ç§é’¥å’Œå¯¹æ–¹çš„å…¬é’¥ç”Ÿæˆä¸€ä¸ªå…±äº«å¯†é’¥ï¼Œæœ¬æ¬¡ä¼ è¾“å°†ä½¿ç”¨è¿™ä¸ªå…±äº«å¯†é’¥</p>
<a id="more"></a>
<p>ä¸»è¦æˆå‘˜ï¼š</p>
<ul>
<li><p>newRLPx()ï¼šè¿”å›ä¸€ä¸ªtransportå¯¹è±¡</p>
</li>
<li><p>ReadMsg()ï¼šè°ƒç”¨è¯»å†™å™¨çš„ReadMsg</p>
</li>
<li><p>WriteMsg()ï¼šè°ƒç”¨è¯»å†™å™¨çš„WriteMsgå†™ä¿¡æ¯</p>
</li>
<li><p>close()ï¼šå…³é—­è¿æ¥å¹¶è¿”å›å…³é—­åŸå› </p>
</li>
<li><p>doEncHandshake()ï¼š åŠ å¯†æ¡æ‰‹ï¼ŒæˆåŠŸåè¿”å›å¸¦æœ‰å…±äº«å¯†é’¥çš„secretså¯¹è±¡</p>
</li>
<li><p>doProtoHandshake()ï¼šåè®®æ¡æ‰‹ï¼Œè¾“å…¥è¾“å‡ºå‡æ˜¯protoHandshakeå¯¹è±¡</p>
</li>
<li><p>doEncHandshake()ï¼šåŠ å¯†æ¡æ‰‹ï¼Œæ¡æ‰‹è¿‡ç¨‹åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†</p>
<ul>
<li><p>å‘èµ·æ–¹ä½¿ç”¨è‡ªå·±çš„ç§é’¥å’Œå¯¹æ–¹çš„å…¬é’¥ç”Ÿæˆä¸€ä¸ªå…±äº«tokenï¼Œå¹¶ä½¿ç”¨ä¸€ä¸ªéšæœºæ•°å’Œä¸€ä¸ªéšæœºç”Ÿæˆçš„ç§é’¥å¯¹å…¶ç­¾åï¼Œå°†è¿™äº›ä¿¡æ¯å‘é€ç»™æ¥æ”¶æ–¹</p>
</li>
<li><p>æ¥æ”¶æ–¹ä¹Ÿä½¿ç”¨è‡ªå·±çš„ç§é’¥å’Œå¯¹æ–¹çš„å…¬é’¥ç”Ÿæˆä¸€ä¸ªtokenï¼Œå¹¶ä½¿ç”¨éšæœºæ•°å’Œå‘é€è¿‡æ¥çš„éšæœºæ•°è¿›è¡Œç­¾åï¼Œå°†ä¿¡æ¯å†æ¬¡è¿”å›</p>
</li>
<li><p>åŒæ–¹é€šè¿‡å„è‡ªå¾—åˆ°çš„ä¿¡æ¯ç”Ÿæˆä¸€ç»„å…±äº«å¯†é’¥</p>
</li>
</ul>
</li>
</ul>
<h3 id="Diffie-â€“-Hellman"><a href="#Diffie-â€“-Hellman" class="headerlink" title="Diffie â€“ Hellman"></a>Diffie â€“ Hellman</h3><p>RLPxåè®®çš„å®ç°è¿‡ç¨‹å…¶å®æ˜¯ä¸€æ¬¡Diffieâ€“Hellmanå¯†é’¥äº¤æ¢</p>
<p>Diffieâ€“Hellmanæ˜¯ä¸€ç§å®‰å…¨åè®®ï¼Œè®©åŒæ–¹åœ¨å®Œå…¨æ²¡æœ‰å¯¹æ–¹ä»»ä½•é¢„å…ˆä¿¡æ¯çš„æ¡ä»¶ä¸‹é€šè¿‡ä¸å®‰å…¨ä¿¡é“å»ºç«‹èµ·ä¸€ä¸ªå¯†é’¥ï¼Œè¿™ä¸ªå¯†é’¥ä¸€èˆ¬ä½œä¸ºâ€œå¯¹ç§°åŠ å¯†â€çš„å¯†é’¥è€Œè¢«åŒæ–¹åœ¨åç»­æ•°æ®ä¼ è¾“ä¸­ä½¿ç”¨</p>
<h3 id="ä»¥å¤ªåŠå…¬é’¥ç§é’¥"><a href="#ä»¥å¤ªåŠå…¬é’¥ç§é’¥" class="headerlink" title="ä»¥å¤ªåŠå…¬é’¥ç§é’¥"></a>ä»¥å¤ªåŠå…¬é’¥ç§é’¥</h3><p>ç§é’¥æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªåŒ…å«64ä½çš„éšæœºæ•°</p>
<p>ç§é’¥åªèƒ½ç”±é’±åŒ…è‡ªå·±æ¥ç”Ÿæˆï¼ŒåŠ å¯†å­˜å‚¨åœ¨keyStoreç›®å½•ä¸‹</p>
<p>ä¸€ä¸ªé’±åŒ…åœ°å€åªæœ‰ä¸€ä¸ªç§é’¥ï¼Œè°æ‹¥æœ‰ç§é’¥ï¼Œè°å°±æ‹¥æœ‰äº†è¿™äº›æ•°å­—è´§å¸çš„æ§åˆ¶æƒ</p>
<p>å…¬é’¥ç”±ç§é’¥é€šè¿‡æ¤­åœ†æ›²çº¿åŠ å¯†ç®—æ³•ç”Ÿæˆçš„ï¼Œå˜æ¢åæ˜¯ä¸€ä¸ª65ä¸ªbyteçš„æ•°ç»„</p>
<p>æ‹¥æœ‰ç§é’¥ï¼Œå°±å¯ä»¥ç®—å‡ºå…¬é’¥ï¼Œè€Œå…¬é’¥ä¸èƒ½è®¡ç®—ç§é’¥</p>
<h3 id="æ–‡ç« æ¥æº"><a href="#æ–‡ç« æ¥æº" class="headerlink" title="æ–‡ç« æ¥æº:"></a>æ–‡ç« æ¥æº:</h3><blockquote>
<p><a href="http://www.8btc.com/blockchain-11-rlpx" target="_blank" rel="external">http://www.8btc.com/blockchain-11-rlpx</a></p>
<p><a href="https://blog.csdn.net/itcastcpp/article/details/80305636" target="_blank" rel="external">https://blog.csdn.net/itcastcpp/article/details/80305636</a></p>
<p><a href="https://blog.csdn.net/weixin_41814722/article/details/80680749" target="_blank" rel="external">https://blog.csdn.net/weixin_41814722/article/details/80680749</a></p>
<p><a href="https://www.cnblogs.com/hyddd/p/7689132.html" target="_blank" rel="external">https://www.cnblogs.com/hyddd/p/7689132.html</a></p>
<p><a href="https://blog.csdn.net/lee244868149/article/details/51790397" target="_blank" rel="external">https://blog.csdn.net/lee244868149/article/details/51790397</a></p>
<p><a href="https://www.jianshu.com/p/61493dbe7cc3" target="_blank" rel="external">https://www.jianshu.com/p/61493dbe7cc3</a></p>
<p><a href="https://bitshuo.com/topic/58c7a1ef0a3de8932e6f753b" target="_blank" rel="external">https://bitshuo.com/topic/58c7a1ef0a3de8932e6f753b</a></p>
<p><a href="https://blog.csdn.net/luoyhang003/article/details/79970254" target="_blank" rel="external">https://blog.csdn.net/luoyhang003/article/details/79970254</a></p>
</blockquote>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;ä»¥å¤ªåŠæºç åˆ†æ&quot;&gt;&lt;a href=&quot;#ä»¥å¤ªåŠæºç åˆ†æ&quot; class=&quot;headerlink&quot; title=&quot;ä»¥å¤ªåŠæºç åˆ†æ&quot;&gt;&lt;/a&gt;ä»¥å¤ªåŠæºç åˆ†æ&lt;/h2&gt;&lt;h3 id=&quot;RLPxåŠ å¯†é€šä¿¡åè®®&quot;&gt;&lt;a href=&quot;#RLPxåŠ å¯†é€šä¿¡åè®®&quot; class=&quot;headerlink&quot; title=&quot;RLPxåŠ å¯†é€šä¿¡åè®®&quot;&gt;&lt;/a&gt;RLPxåŠ å¯†é€šä¿¡åè®®&lt;/h3&gt;&lt;p&gt;PLPxå±äºä¼šè¯å±‚åè®®ï¼Œä¸»è¦åŠŸèƒ½æ˜¯åœ¨èŠ‚ç‚¹ä¹‹é—´å»ºç«‹å¹¶ç»´æŒé€šä¿¡&lt;/p&gt;
&lt;p&gt;RLPxåè®®æ¯æ¬¡å»ºç«‹è¿æ¥éƒ½ä½¿ç”¨ä¸åŒçš„å¯†é’¥ï¼Œå³ä½¿ç°æœ‰çš„å¯†é’¥æ³„éœ²ä¹Ÿä¸ä¼šå¯¼è‡´ä¹‹å‰çš„ä¿¡æ¯è¢«ç ´è§£&lt;/p&gt;
&lt;p&gt;å®ç°åŸç†ï¼šè¿æ¥åŒæ–¹å„è‡ªç”Ÿæˆä¸€ä¸ªç§é’¥ï¼Œç„¶åå°†å¾—åˆ°çš„å…¬é’¥å‘é€ç»™å¯¹æ–¹ï¼ŒåŒæ–¹å†åˆ©ç”¨è‡ªå·±çš„ç§é’¥å’Œå¯¹æ–¹çš„å…¬é’¥ç”Ÿæˆä¸€ä¸ªå…±äº«å¯†é’¥ï¼Œæœ¬æ¬¡ä¼ è¾“å°†ä½¿ç”¨è¿™ä¸ªå…±äº«å¯†é’¥&lt;/p&gt;
    
    </summary>
    
      <category term="æŠ€æœ¯" scheme="http://jiaotingyu.me/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
      <category term="Golang" scheme="http://jiaotingyu.me/tags/Golang/"/>
    
      <category term="ä»¥å¤ªåŠ" scheme="http://jiaotingyu.me/tags/%E4%BB%A5%E5%A4%AA%E5%9D%8A/"/>
    
  </entry>
  
  <entry>
    <title>ä»¥å¤ªåŠå­¦ä¹ ç¬”è®°ï¼ˆåä¸‰ï¼‰</title>
    <link href="http://jiaotingyu.me/2018/09/21/%E4%BB%A5%E5%A4%AA%E5%9D%8A%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%88%E5%8D%81%E4%B8%89%EF%BC%89/"/>
    <id>http://jiaotingyu.me/2018/09/21/ä»¥å¤ªåŠå­¦ä¹ ç¬”è®°ï¼ˆåä¸‰ï¼‰/</id>
    <published>2018-09-20T16:00:00.000Z</published>
    <updated>2020-05-18T15:28:01.405Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ä»¥å¤ªåŠæºä»£ç åˆ†æ"><a href="#ä»¥å¤ªåŠæºä»£ç åˆ†æ" class="headerlink" title="ä»¥å¤ªåŠæºä»£ç åˆ†æ"></a>ä»¥å¤ªåŠæºä»£ç åˆ†æ</h2><h3 id="P2Påº•å±‚é€šä¿¡"><a href="#P2Påº•å±‚é€šä¿¡" class="headerlink" title="P2Påº•å±‚é€šä¿¡"></a>P2Påº•å±‚é€šä¿¡</h3><p>P2På³å¯¹ç­‰ç½‘ç»œï¼Œæ˜¯ä¸€ç§åœ¨å¯¹ç­‰è€…ï¼ˆPeerï¼‰ä¹‹é—´åˆ†é…ä»»åŠ¡å’Œå·¥ä½œè´Ÿè½½çš„åˆ†å¸ƒå¼åº”ç”¨æ¶æ„</p>
<p>ç½‘ç»œä¸­æ‰€æœ‰çš„ä¸ªä½“åœ°ä½å’ŒåŠŸèƒ½ä¸Šæ˜¯å¹³ç­‰çš„</p>
<p>å¦å¤–ç½‘ç»œä¸­çš„ä¸ªä½“ä¸éœ€è¦ä¸å…¶ä»–æ‰€æœ‰ä¸ªä½“ä¿æŒé€šä¿¡ï¼Œåªéœ€è¦ä¸ç›¸é‚»ä¸ªä½“ä¿æŒé€šä¿¡</p>
<p>ä»¥å¤ªåŠä½¿ç”¨äº†kademliaç½‘ç»œï¼Œæ˜¯ä¸€ç§åˆ†å¸ƒå¼æ•£åˆ—è¡¨(DHT)æŠ€æœ¯ï¼Œä»¥å¼‚æˆ–è¿ç®—ä¸ºè·ç¦»åº¦é‡åŸºç¡€</p>
<a id="more"></a>
<h3 id="ProtocolManager"><a href="#ProtocolManager" class="headerlink" title="ProtocolManager"></a>ProtocolManager</h3><p>ä»¥å¤ªåŠä¸­é€šè¿‡ProtocolManageræ¥ç®¡ç†ä¸ªä½“é—´çš„é€šä¿¡</p>
<p>ä¸»è¦æˆå‘˜åŒ…æ‹¬ï¼š</p>
<ul>
<li><p>peerSet()ï¼šæ¥ç¼“å­˜ç›¸é‚»ä¸ªä½“åˆ—è¡¨</p>
</li>
<li><p>é€šè¿‡é€šé“å’Œè®¢é˜…çš„æ–¹å¼è¿›è¡Œä¿¡æ¯æ›´æ–°</p>
</li>
<li><p>Fetcherï¼šæ”¶é›†å…¶ä»–æˆå‘˜çš„æ¶ˆæ¯ï¼Œæ¥å®‰æ’è·å–è¯·æ±‚</p>
</li>
<li><p>Downloaderï¼šè´Ÿè´£æ‰€æœ‰å‘ç›¸é‚»ä¸ªä½“ä¸»åŠ¨å‘èµ·çš„åŒæ­¥æµç¨‹</p>
</li>
<li><p>Start()ï¼šå¯åŠ¨p2pé€šä¿¡</p>
</li>
</ul>
<p>Startåˆ†åˆ«å¯åŠ¨å››ä¸ªå‡½æ•°</p>
<p><img src="https://s1.ax1x.com/2018/07/15/PQSKT1.png" alt="PQSKT1.png"></p>
<p>å››ä¸ªå‡½æ•°çš„é€»è¾‘åˆ†åˆ«æ˜¯ï¼š</p>
<ul>
<li><p>å¹¿æ’­æ–°å‡ºç°çš„äº¤æ˜“å¯¹è±¡</p>
</li>
<li><p>å¹¿æ’­æ–°æŒ–æ˜çš„åŒºå—</p>
</li>
<li><p>å®šæ—¶ä¸ç›¸é‚»ä¸ªä½“è¿›è¡ŒåŒºå—é“¾çš„åŒæ­¥</p>
</li>
<li><p>å°†æ–°å‡ºç°çš„äº¤æ˜“å¯¹è±¡å‡åŒ€çš„åŒæ­¥ç»™ç›¸é‚»ä¸ªä½“</p>
</li>
</ul>
<p>æ³¨æ„ï¼šæœ¬ä½“å‘å…¶ä»–ä¸ªä½“ä¸»åŠ¨å‘èµ·çš„é€šä¿¡ä¸­ï¼ŒæŒ‰ç…§æ•°æ®ç±»å‹å¯åˆ†ä¸¤ç±»ï¼šäº¤æ˜“txå’ŒåŒºå—blockï¼›è€ŒæŒ‰ç…§é€šä¿¡æ–¹å¼åˆ’åˆ†ï¼Œäº¦å¯åˆ†ä¸ºå¹¿æ’­æ–°çš„å•ä¸ªæ•°æ®å’ŒåŒæ­¥ä¸€ç»„åŒç±»å‹æ•°æ®</p>
<ul>
<li>handle()ï¼šä¸»åŠ¨è¯·æ±‚çš„å›è°ƒå‡½æ•°</li>
</ul>
<p>åœ¨èŠ‚ç‚¹é—´é€šä¿¡æ—¶ï¼Œé™¤äº†ä¸»åŠ¨äº’ç›¸é€šçŸ¥å¤–ï¼Œè¿˜éœ€è¦ä¸€ç§è¢«è¯·æ±‚è°ƒç”¨çš„é€šä¿¡ï¼Œä½¿ç”¨handleå‡½æ•°æ¥å®ç°å›è°ƒ</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="params">(pm *ProtocolManager)</span> <span class="title">handle</span><span class="params">(p *peer)</span> <span class="title">error</span></span> &#123;</div><div class="line">    td, head, genesis := pm.blockchain.Status()</div><div class="line">    p.Handshake(pm.networkId, td, head, genesis)</div><div class="line"></div><div class="line">    <span class="keyword">if</span> rw, ok := p.rw.(*meteredMsgReadWriter); ok &#123;</div><div class="line">        rm.Init(p.version)</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    pm.peers.Register(p)</div><div class="line">    <span class="keyword">defer</span> pm.removePeer(p.id)</div><div class="line"></div><div class="line">    pm.downloader.RegisterPeer(p.id, p.version, p)</div><div class="line"></div><div class="line">    pm.syncTransactions(p)</div><div class="line">    ...</div><div class="line">    <span class="keyword">for</span> &#123;</div><div class="line">        <span class="keyword">if</span> err := pm.handleMsg(p); err != <span class="literal">nil</span> &#123;</div><div class="line">            <span class="keyword">return</span> err</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>handleå‡½æ•°çš„é€»è¾‘ä¸ºä¸å¯¹æ–¹ç¡®å®šçŠ¶æ€ï¼Œåˆå§‹åŒ–è¯»å†™é€šé“ï¼Œå°†è¦è®¿é—®çš„èŠ‚ç‚¹å­˜å…¥ç›¸é‚»åˆ—è¡¨ï¼Œåœ¨Downloaderæˆå‘˜æ³¨å†ŒèŠ‚ç‚¹ï¼Œå‘å¯¹æ–¹èŠ‚ç‚¹å‘é€è¯·æ±‚ï¼Œç›‘å¬è¿”å›çš„æ¶ˆæ¯å¹¶è¿›è¡Œå¤„ç†</p>
<h3 id="å»ºç«‹æ–°peerè¿æ¥"><a href="#å»ºç«‹æ–°peerè¿æ¥" class="headerlink" title="å»ºç«‹æ–°peerè¿æ¥"></a>å»ºç«‹æ–°peerè¿æ¥</h3><p>Node.Start()ä¸­é¦–å…ˆä¼šåˆ›å»ºp2p.Server{}ï¼Œå°†Nodeä¸­è½½å…¥çš„æ‰€æœ‰<service>å®ç°ä½“ä¸­çš„Protocoléƒ½ä½œä¸ºServer.Protocolsåˆ—è¡¨ï¼Œå¯åŠ¨Serverå¯¹è±¡ï¼Œå¹¶å°†Serverå¯¹è±¡ä½œä¸ºå‚æ•°å»é€ä¸€å¯åŠ¨æ¯ä¸ª<service>å®ç°ä½“,ProtocolManager.Protocolsæœ€ç»ˆè¢«å¯¼å…¥äº†p2p.Server.Protocols</service></service></p>
<h3 id="æ–‡ç« æ¥æº"><a href="#æ–‡ç« æ¥æº" class="headerlink" title="æ–‡ç« æ¥æº:"></a>æ–‡ç« æ¥æº:</h3><blockquote>
<p><a href="https://blog.csdn.net/screscent/article/details/79416251" target="_blank" rel="external">https://blog.csdn.net/screscent/article/details/79416251</a></p>
<p><a href="https://blog.csdn.net/screscent/article/details/79416318" target="_blank" rel="external">https://blog.csdn.net/screscent/article/details/79416318</a></p>
<p><a href="http://baijiahao.baidu.com/s?id=1604499731426119688&amp;wfr=spider&amp;for=pc" target="_blank" rel="external">http://baijiahao.baidu.com/s?id=1604499731426119688&amp;wfr=spider&amp;for=pc</a></p>
<p><a href="https://blog.csdn.net/teaspring/article/details/78455046" target="_blank" rel="external">https://blog.csdn.net/teaspring/article/details/78455046</a></p>
</blockquote>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;ä»¥å¤ªåŠæºä»£ç åˆ†æ&quot;&gt;&lt;a href=&quot;#ä»¥å¤ªåŠæºä»£ç åˆ†æ&quot; class=&quot;headerlink&quot; title=&quot;ä»¥å¤ªåŠæºä»£ç åˆ†æ&quot;&gt;&lt;/a&gt;ä»¥å¤ªåŠæºä»£ç åˆ†æ&lt;/h2&gt;&lt;h3 id=&quot;P2Påº•å±‚é€šä¿¡&quot;&gt;&lt;a href=&quot;#P2Påº•å±‚é€šä¿¡&quot; class=&quot;headerlink&quot; title=&quot;P2Påº•å±‚é€šä¿¡&quot;&gt;&lt;/a&gt;P2Påº•å±‚é€šä¿¡&lt;/h3&gt;&lt;p&gt;P2På³å¯¹ç­‰ç½‘ç»œï¼Œæ˜¯ä¸€ç§åœ¨å¯¹ç­‰è€…ï¼ˆPeerï¼‰ä¹‹é—´åˆ†é…ä»»åŠ¡å’Œå·¥ä½œè´Ÿè½½çš„åˆ†å¸ƒå¼åº”ç”¨æ¶æ„&lt;/p&gt;
&lt;p&gt;ç½‘ç»œä¸­æ‰€æœ‰çš„ä¸ªä½“åœ°ä½å’ŒåŠŸèƒ½ä¸Šæ˜¯å¹³ç­‰çš„&lt;/p&gt;
&lt;p&gt;å¦å¤–ç½‘ç»œä¸­çš„ä¸ªä½“ä¸éœ€è¦ä¸å…¶ä»–æ‰€æœ‰ä¸ªä½“ä¿æŒé€šä¿¡ï¼Œåªéœ€è¦ä¸ç›¸é‚»ä¸ªä½“ä¿æŒé€šä¿¡&lt;/p&gt;
&lt;p&gt;ä»¥å¤ªåŠä½¿ç”¨äº†kademliaç½‘ç»œï¼Œæ˜¯ä¸€ç§åˆ†å¸ƒå¼æ•£åˆ—è¡¨(DHT)æŠ€æœ¯ï¼Œä»¥å¼‚æˆ–è¿ç®—ä¸ºè·ç¦»åº¦é‡åŸºç¡€&lt;/p&gt;
    
    </summary>
    
      <category term="æŠ€æœ¯" scheme="http://jiaotingyu.me/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
      <category term="Golang" scheme="http://jiaotingyu.me/tags/Golang/"/>
    
      <category term="ä»¥å¤ªåŠ" scheme="http://jiaotingyu.me/tags/%E4%BB%A5%E5%A4%AA%E5%9D%8A/"/>
    
  </entry>
  
  <entry>
    <title>Golangå­¦ä¹ ç¬”è®°ï¼ˆå…­ï¼‰</title>
    <link href="http://jiaotingyu.me/2018/09/20/Golang%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%88%E5%85%AD%EF%BC%89/"/>
    <id>http://jiaotingyu.me/2018/09/20/Golangå­¦ä¹ ç¬”è®°ï¼ˆå…­ï¼‰/</id>
    <published>2018-09-19T16:00:00.000Z</published>
    <updated>2020-05-19T08:46:40.338Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Golangè®°å½•"><a href="#Golangè®°å½•" class="headerlink" title="Golangè®°å½•"></a>Golangè®°å½•</h2><p><strong>copyå¤åˆ¶ä¼šæ¯”ç­‰å·å¤åˆ¶æ…¢ã€‚ä½†æ˜¯copyå¤åˆ¶ä¸ºå€¼å¤åˆ¶ï¼Œæ”¹å˜åŸåˆ‡ç‰‡çš„å€¼ä¸ä¼šå½±å“æ–°åˆ‡ç‰‡ã€‚è€Œç­‰å·å¤åˆ¶ä¸ºæŒ‡é’ˆå¤åˆ¶ï¼Œæ”¹å˜åŸåˆ‡ç‰‡æˆ–æ–°åˆ‡ç‰‡éƒ½ä¼šå¯¹å¦ä¸€ä¸ªäº§ç”Ÿå½±å“</strong>ã€‚</p>
<a id="more"></a>
<h4 id="c-å£°æ˜æ•°ç»„"><a href="#c-å£°æ˜æ•°ç»„" class="headerlink" title="c++å£°æ˜æ•°ç»„"></a>c++å£°æ˜æ•°ç»„</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//é™æ€ å®šä¹‰äº†æ•°ç»„arrayï¼Œå¹¶æœªå¯¹æ•°ç»„è¿›è¡Œåˆå§‹åŒ– </span></div><div class="line"><span class="keyword">int</span> array[<span class="number">100</span>]; </div><div class="line"><span class="comment">//é™æ€ å®šä¹‰å¹¶åˆå§‹åŒ–äº†æ•°ç»„</span></div><div class="line">array <span class="keyword">int</span> array[<span class="number">100</span>] = &#123;<span class="number">1</span>ï¼Œ<span class="number">2</span>&#125;; </div><div class="line"><span class="comment">//åŠ¨æ€ åˆ†é…äº†é•¿åº¦ä¸º100çš„æ•°ç»„</span></div><div class="line">array <span class="keyword">int</span>* array = <span class="built_in">new</span> <span class="keyword">int</span>[<span class="number">100</span>];  </div><div class="line"><span class="built_in">delete</span> []array; </div><div class="line"><span class="comment">//åŠ¨æ€ ä¸ºé•¿åº¦ä¸º100çš„æ•°ç»„arrayåˆå§‹åŒ–å‰ä¸¤ä¸ªå…ƒç´  </span></div><div class="line"><span class="keyword">int</span>* array = <span class="built_in">new</span> <span class="keyword">int</span>[<span class="number">100</span>](<span class="number">1</span>ï¼Œ<span class="number">2</span>); </div><div class="line"><span class="built_in">delete</span> []array;</div></pre></td></tr></table></figure>
<h4 id="golang-å£°æ˜æ•°ç»„"><a href="#golang-å£°æ˜æ•°ç»„" class="headerlink" title="golang å£°æ˜æ•°ç»„"></a>golang å£°æ˜æ•°ç»„</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//ç¬¬ä¸€ç§ </span></div><div class="line"><span class="comment">//var &lt;æ•°ç»„åç§°&gt; [&lt;æ•°ç»„é•¿åº¦&gt;]&lt;æ•°ç»„å…ƒç´ &gt; </span></div><div class="line"><span class="keyword">var</span> arr [<span class="number">2</span>]<span class="keyword">int</span> </div><div class="line">arr[<span class="number">0</span>]=<span class="number">1</span> </div><div class="line">arr[<span class="number">1</span>]=<span class="number">2</span> </div><div class="line"></div><div class="line"><span class="comment">//ç¬¬äºŒç§ </span></div><div class="line"><span class="comment">//var &lt;æ•°ç»„åç§°&gt; = [&lt;æ•°ç»„é•¿åº¦&gt;]&lt;æ•°ç»„å…ƒç´ &gt;&#123;å…ƒç´ 1,å…ƒç´ 2,...&#125; </span></div><div class="line"><span class="keyword">var</span> arr = [<span class="number">2</span>]<span class="keyword">int</span>&#123;<span class="number">1</span>,<span class="number">2</span>&#125; </div><div class="line"><span class="comment">//æˆ–è€… </span></div><div class="line">arr := [<span class="number">2</span>]<span class="keyword">int</span>&#123;<span class="number">1</span>,<span class="number">2</span>&#125; </div><div class="line"></div><div class="line"><span class="comment">//ç¬¬ä¸‰ç§ </span></div><div class="line"><span class="comment">//var &lt;æ•°ç»„åç§°&gt; [&lt;æ•°ç»„é•¿åº¦&gt;]&lt;æ•°ç»„å…ƒç´ &gt; = [...]&lt;å…ƒç´ ç±»å‹&gt;&#123;å…ƒç´ 1,å…ƒç´ 2,...&#125; </span></div><div class="line"><span class="keyword">var</span> arr = [...]<span class="keyword">int</span>&#123;<span class="number">1</span>,<span class="number">2</span>&#125; </div><div class="line"><span class="comment">//æˆ–è€… </span></div><div class="line">arr := [...]<span class="keyword">int</span>&#123;<span class="number">1</span>,<span class="number">2</span>&#125; </div><div class="line"></div><div class="line"><span class="comment">//ç¬¬å››ç§ </span></div><div class="line"><span class="comment">//var &lt;æ•°ç»„åç§°&gt; [&lt;æ•°ç»„é•¿åº¦&gt;]&lt;æ•°ç»„å…ƒç´ &gt; = [...]&lt;å…ƒç´ ç±»å‹&gt;&#123;ç´¢å¼•1:å…ƒç´ 1,ç´¢å¼•2:å…ƒç´ 2,...&#125;</span></div><div class="line"><span class="keyword">var</span> arr = [...]<span class="keyword">int</span>&#123;<span class="number">1</span>:<span class="number">1</span>,<span class="number">0</span>:<span class="number">2</span>&#125; </div><div class="line"><span class="comment">//æˆ–è€… </span></div><div class="line">arr := [...]<span class="keyword">int</span>&#123;<span class="number">1</span>:<span class="number">1</span>,<span class="number">0</span>:<span class="number">2</span>&#125;</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Golangè®°å½•&quot;&gt;&lt;a href=&quot;#Golangè®°å½•&quot; class=&quot;headerlink&quot; title=&quot;Golangè®°å½•&quot;&gt;&lt;/a&gt;Golangè®°å½•&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;copyå¤åˆ¶ä¼šæ¯”ç­‰å·å¤åˆ¶æ…¢ã€‚ä½†æ˜¯copyå¤åˆ¶ä¸ºå€¼å¤åˆ¶ï¼Œæ”¹å˜åŸåˆ‡ç‰‡çš„å€¼ä¸ä¼šå½±å“æ–°åˆ‡ç‰‡ã€‚è€Œç­‰å·å¤åˆ¶ä¸ºæŒ‡é’ˆå¤åˆ¶ï¼Œæ”¹å˜åŸåˆ‡ç‰‡æˆ–æ–°åˆ‡ç‰‡éƒ½ä¼šå¯¹å¦ä¸€ä¸ªäº§ç”Ÿå½±å“&lt;/strong&gt;ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="æŠ€æœ¯" scheme="http://jiaotingyu.me/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
      <category term="Golang" scheme="http://jiaotingyu.me/tags/Golang/"/>
    
  </entry>
  
  <entry>
    <title>ä»¥å¤ªåŠå­¦ä¹ ç¬”è®°ï¼ˆåäºŒï¼‰</title>
    <link href="http://jiaotingyu.me/2018/09/20/%E4%BB%A5%E5%A4%AA%E5%9D%8A%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%88%E5%8D%81%E4%BA%8C%EF%BC%89/"/>
    <id>http://jiaotingyu.me/2018/09/20/ä»¥å¤ªåŠå­¦ä¹ ç¬”è®°ï¼ˆåäºŒï¼‰/</id>
    <published>2018-09-19T16:00:00.000Z</published>
    <updated>2020-05-18T15:27:48.760Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ä»¥å¤ªåŠæºä»£ç "><a href="#ä»¥å¤ªåŠæºä»£ç " class="headerlink" title="ä»¥å¤ªåŠæºä»£ç "></a>ä»¥å¤ªåŠæºä»£ç </h2><h3 id="å…±è¯†ç®—æ³•"><a href="#å…±è¯†ç®—æ³•" class="headerlink" title="å…±è¯†ç®—æ³•"></a>å…±è¯†ç®—æ³•</h3><p>å…±è¯†ç®—æ³•ä½¿ç”¨Engineæ¥å£ï¼Œåˆ†ä¸ºä¸¤ç§å®ç°æ–¹å¼ï¼š</p>
<ol>
<li><p>åŸºäºè¿ç®—èƒ½åŠ›çš„Ethashç®—æ³•</p>
</li>
<li><p>åŸºäºâ€œåŒè¡Œâ€è®¤è¯çš„Cliqueç®—æ³•</p>
<a id="more"></a>
</li>
</ol>
<p>Engineæ¥å£çš„å‡½æ•°åŒ…æ‹¬ä»¥ä¸‹ï¼š</p>
<ul>
<li><p>VerifyHeader()ï¼ŒVerifyHeaders()ï¼ŒVerifyUncles()ï¼šéªŒè¯åŒºå—çš„æˆå‘˜æ˜¯å¦åˆç†</p>
</li>
<li><p>Prepare()ï¼šåœ¨Headeråˆ›å»ºæ—¶è°ƒç”¨ï¼Œå¯¹Difficultyç­‰å±æ€§èµ‹å€¼</p>
</li>
<li><p>Finalize()ï¼šåœ¨åŒºå—çš„æ•°æ®æˆå‘˜éƒ½èµ‹å€¼å®Œæ¯•æ˜¯ï¼Œç”ŸæˆRootï¼ŒTxHashï¼ŒUncleHashï¼ŒReceiptHashç­‰æˆå‘˜</p>
</li>
<li><p>Seal()ï¼šå¯¹æ‰§è¡Œè¿‡Finalizeå‡½æ•°çš„åŒºå—è¿›è¡Œæˆæƒï¼ŒæˆåŠŸè¿”å›åŒºå—çš„æ‰€æœ‰æˆå‘˜ï¼Œè¯¥åŒºå—å°±æ˜¯å®ŒæˆåŒºå—ï¼Œå¯ä»¥è¢«å¹¿æ’­ä¹Ÿå¯ä»¥æ’å…¥åˆ°åŒºå—é“¾</p>
</li>
<li><p>VerifySeal()ï¼šç”¨æ¥ç¡®å®šåŒºå—æ˜¯å¦å·²ç»Sealæ“ä½œ</p>
</li>
</ul>
<h3 id="Ethashå…±è¯†ç®—æ³•"><a href="#Ethashå…±è¯†ç®—æ³•" class="headerlink" title="Ethashå…±è¯†ç®—æ³•"></a>Ethashå…±è¯†ç®—æ³•</h3><p>Ethashç§°ä¸ºPoW(Proof-of-Work)</p>
<p>åŸºæœ¬åŸç†å…¬å¼ä¸ºï¼š</p>
<p>$$<br>$$ RAND(h, n)  &lt;=  M / d $$<br>$$<br>Mè¡¨ç¤ºä¸€ä¸ªæå¤§çš„æ•°ï¼Œdè¡¨ç¤ºHeaderæˆå‘˜Difficulty</p>
<p>RAND()ç”¨æ¥äº§ç”Ÿéšæœºæ•°ï¼Œhæ˜¯Headerçš„å“ˆå¸Œå€¼ï¼Œnè¡¨ç¤ºHeaderæˆå‘˜Nonce</p>
<p>è¯¥å…¬å¼è¡¨ç¤ºåœ¨æœ€å¤§ä¸è¶…è¿‡Mçš„èŒƒå›´å†…ï¼Œæ‰¾åˆ°ä¸€ä¸ªéšæœºæ•°æ•°ï¼Œå¦‚æœè¿™ä¸ªæ•°ç¬¦åˆæ¡ä»¶(&lt;=M/d)ï¼Œé‚£ä¹ˆå°±è®¤ä¸ºSeal()æˆåŠŸ</p>
<h3 id="mine-å‡½æ•°"><a href="#mine-å‡½æ•°" class="headerlink" title="mine()å‡½æ•°"></a>mine()å‡½æ•°</h3><p>åœ¨å®ç°Seal()å‡½æ•°è¿‡ç¨‹ä¸­ï¼Œä¼šä»¥å¤šçº¿ç¨‹çš„æ–¹å¼å¹¶è¡Œè°ƒç”¨mine()å‡½æ•°ï¼Œçº¿ç¨‹ä¸ªæ•°ç­‰äºEthash.threads</p>
<p>ä¸»è¦ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="params">(ethash *Ethash)</span> <span class="title">mine</span><span class="params">(block *Block, id <span class="keyword">int</span>, seed <span class="keyword">uint64</span>, abort <span class="keyword">chan</span> <span class="keyword">struct</span>&#123;&#125;, found <span class="keyword">chan</span> *Block)</span></span> &#123;</div><div class="line">    <span class="keyword">var</span> (</div><div class="line">        header = block.Header()</div><div class="line">        hash   = header.HashNoNonce().Bytes()</div><div class="line">        target = <span class="built_in">new</span>(big.Int).Div(maxUint256, header.Difficulty)</div><div class="line">        number = header.Number.Uint64()</div><div class="line">        dataset = ethash.dataset(number)</div><div class="line">        nonce  = seed</div><div class="line">    )</div><div class="line">    <span class="keyword">for</span> &#123;</div><div class="line">        <span class="keyword">select</span> &#123;</div><div class="line">        <span class="keyword">case</span> &lt;-abort:</div><div class="line">            ...; <span class="keyword">return</span></div><div class="line">        <span class="keyword">default</span>:</div><div class="line">            digest, result := hashimotoFull(dataset, hash, nonce) <span class="comment">// compute the PoW value of this nonce</span></div><div class="line">            <span class="keyword">if</span> <span class="built_in">new</span>(big.Int).SetBytes(result).Cmp(target) &lt;= <span class="number">0</span> &#123; <span class="comment">// x.Cmp(y) &lt;= 0 means x &lt;= y</span></div><div class="line">                header = types.CopyHeader(header)</div><div class="line">                header.Nonce = types.EncodeNonce(nonce)</div><div class="line">                header.MixDigest = common.BytesToHash(digest)</div><div class="line">                found&lt;- block.WithSeal(header)</div><div class="line">                <span class="keyword">return</span></div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        nonce++</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å‡½æ•°å®šä¹‰äº†ä¸€ç»„å±€éƒ¨å˜é‡ï¼Œç„¶åæ˜¯ä¸€ä¸ªforå¾ªç¯ï¼Œè°ƒç”¨hashimotoFull()ï¼Œå½“å‡½æ•°çš„è¿”å›å€¼ç¬¦åˆæ¡ä»¶æ—¶ï¼Œå¤åˆ¶Headerå¯¹è±¡ï¼ŒNonceã€MixDigestèµ‹å€¼ï¼Œè¿”å›æˆæƒè¿‡çš„åŒºå—</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">hashimotoFull</span><span class="params">(dataset []<span class="keyword">uint32</span>, hash []<span class="keyword">byte</span>, nonce <span class="keyword">uint64</span>)</span> <span class="params">([]<span class="keyword">byte</span>, []<span class="keyword">byte</span>)</span></span> &#123;</div><div class="line">    lookup := <span class="function"><span class="keyword">func</span><span class="params">(index <span class="keyword">uint32</span>)</span> []<span class="title">uint32</span></span> &#123;</div><div class="line">        offset := index * hashWords</div><div class="line">        <span class="keyword">return</span> dataset[offset : offset+hashWords]</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> hashimoto(hash, nonce, <span class="keyword">uint64</span>(<span class="built_in">len</span>(dataset))*<span class="number">4</span>, lookup)</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">hashimotoLight</span>ï¼ˆ<span class="title">size</span> <span class="title">uint64</span>, <span class="title">cache</span> []<span class="title">uint32</span>, <span class="title">hash</span> []<span class="title">byte</span>, <span class="title">nonce</span> <span class="title">uint64</span>ï¼‰ <span class="params">([]<span class="keyword">byte</span>, []<span class="keyword">byte</span>)</span></span> &#123;</div><div class="line">    lookup := <span class="function"><span class="keyword">func</span><span class="params">(index <span class="keyword">uint32</span>)</span> []<span class="title">uint32</span></span> &#123;</div><div class="line">        rawData := generateDatasetItem(cache, index, keccak512)</div><div class="line">        data := <span class="built_in">make</span>([]<span class="keyword">uint32</span>, <span class="built_in">len</span>(rawData)/<span class="number">4</span>)</div><div class="line">        <span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="built_in">len</span>(data); i++ &#123;</div><div class="line">            data[i] = binary.LittleEndian.Uint32(rawData[i*<span class="number">4</span>:])</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> data</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> hashimoto(hash, nonce, size, lookup)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä»¥ä¸Šä¸¤ä¸ªå‡½æ•°ç±»ä¼¼ï¼Œéƒ½è¿”å›hashimoto()ï¼Œç›¸æ¯”äºLightå‡½æ•°ï¼ŒFullå‡½æ•°è°ƒç”¨çš„@sizeå‚æ•°æ›´å¤§ï¼Œlookupä¹Ÿæ›´å¤§ã€‚Fullå‡½æ•°æ˜¯Seal()è°ƒç”¨çš„ï¼ŒLight()æ˜¯VerifySeal()å‡†å¤‡çš„</p>
<h3 id="hashimoto-å‡½æ•°"><a href="#hashimoto-å‡½æ•°" class="headerlink" title="hashimoto()å‡½æ•°"></a>hashimoto()å‡½æ•°</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// consensus/ethash/algorithm.go</span></div><div class="line">  <span class="function"><span class="keyword">func</span> <span class="title">hashimoto</span><span class="params">(hash []<span class="keyword">byte</span>, nonce <span class="keyword">uint64</span>, size <span class="keyword">uint64</span>, lookup(index <span class="keyword">uint32</span>)</span> []<span class="title">uint32</span>) <span class="params">(digest []<span class="keyword">byte</span>, result []<span class="keyword">byte</span>)</span></span></div></pre></td></tr></table></figure>
<p>ä¼ å…¥çš„å‚æ•°åŒ…æ‹¬ï¼š</p>
<ul>
<li>hash åŒºå—å“ˆå¸Œå€¼</li>
<li>nonce åŒºå—nonce</li>
<li>lookup() éçº¿æ€§è¡¨æŸ¥æ‰¾çš„å“ˆå¸Œå‡½æ•°</li>
<li>size æŸ¥æ‰¾çš„éçº¿æ€§è¡¨æ ¼çš„å®¹é‡</li>
<li>digest 32bytesçš„å­—èŠ‚ä¸²</li>
<li>result 32bytesçš„å­—èŠ‚ä¸²</li>
</ul>
<p><img src="https://s1.ax1x.com/2018/07/14/PMdGWR.png" alt="PMdGWR.png"></p>
<p>ç»è¿‡ä¸€ç³»åˆ—å¤šæ¬¡ã€å¤šç§çš„å“ˆå¸Œè¿ç®—ï¼Œhashimoto()è¿”å›ä¸¤ä¸ªé•¿åº¦å‡ä¸º32çš„byteæ•°ç»„ digest[]å’Œresult[]</p>
<h3 id="Cliqueå…±è¯†ç®—æ³•"><a href="#Cliqueå…±è¯†ç®—æ³•" class="headerlink" title="Cliqueå…±è¯†ç®—æ³•"></a>Cliqueå…±è¯†ç®—æ³•</h3><p>Cliqueç®—æ³•åˆç§°Proof-of-Authortiy(PoA)</p>
<p>Cliqueç®—æ³•å®ç°å…¬å¼ï¼š</p>
<p>$$ n = F(pr, h) $$</p>
<p>F()æ˜¯æ¤­åœ†æ›²çº¿æ•°å­—ç­¾åç®—æ³•(ECDSA)ï¼Œnæ˜¯ç”Ÿæˆçš„æ•°å­—ç­¾åï¼Œpræ˜¯å…¬é’¥ï¼Œhæ˜¯è¢«åŠ å¯†çš„å†…å®¹</p>
<p>Clique.Seal()å‡½æ•°çš„åŸºæœ¬é€»è¾‘å°±æ˜¯ï¼šæœ‰ä¸€ä¸ªAddressç±»å‹åœ°å€ç”¨ä½œæ•°å­—ç­¾åçš„å…¬é’¥ï¼Œå¦‚æœå®ƒæ˜¯å·²è®¤è¯çš„ï¼Œåˆ™æ‰§è¡ŒæŒ‡å®šçš„æ•°å­—ç­¾åç®—æ³•</p>
<p>Cliqueçš„è®¤è¯æœºåˆ¶åŒ…å«ä»¥ä¸‹è§„åˆ™</p>
<ul>
<li>æ‰€æœ‰çš„åœ°å€åˆ†ä¸ºå·²è®¤è¯å’Œæœªè®¤è¯çš„</li>
<li>å·²è®¤è¯å’Œæœªè®¤è¯å¯ä»¥äº’ç›¸è½¬æ¢ï¼Œå¿…é¡»é€šè¿‡æŠ•ç¥¨æœºåˆ¶å®Œæˆ</li>
<li>ä¸€å¼ æŠ•ç¥¨åŒ…æ‹¬ï¼šæŠ•ç¥¨æ–¹åœ°å€ï¼Œè¢«æŠ•ç¥¨åœ°å€ï¼Œå’Œè¢«æŠ•ç¥¨åœ°å€çš„æ–°è®¤è¯çŠ¶æ€</li>
<li>ä»»æ„åœ°å€Aåªèƒ½ç»™åœ°å€BæŠ•ä¸€å¼ ç¥¨</li>
</ul>
<p>Cliqueç®—æ³•ä¸­çš„æŠ•ç¥¨ç³»ç»Ÿçš„å·§å¦™ä¹‹å¤„åœ¨äºï¼Œæ¯å¼ æŠ•ç¥¨å¹¶ä¸æ˜¯æŸä¸ªæŠ•ç¥¨æ–¹ä¸»åŠ¨â€œæŠ•â€å‡ºæ¥çš„ï¼Œè€Œæ˜¯éšæœºç»„åˆå‡ºæ¥çš„</p>
<p><img src="https://s1.ax1x.com/2018/07/14/PMw1nf.png" alt="PMw1nf.png"></p>
<p>æ–°åŒºå—çš„Coinbaseæ˜¯ä¸€ä¸ªéšæœºçš„è¢«æŠ•ç¥¨åœ°å€</p>
<p>é¦–å…ˆä»proposalsä¸­ç­›é€‰å‡ºæœ‰æ•ˆçš„ä¸è®°åæŠ•ç¥¨ï¼Œè·å–æœ‰æ•ˆçš„è¢«æŠ•ç¥¨åœ°å€åˆ—è¡¨ï¼Œéšæœºé€‰å–ä¸€ä¸ªåœ°å€ä½œä¸ºCoinbaseã€‚æ–°åŒºå—çš„Coinbaseä¼šåœ¨åé¢çš„è®¤è¯ç¯èŠ‚å½“ä½œè¢«æŠ•ç¥¨åœ°å€</p>
<h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><ul>
<li><p>Ethashç®—æ³•(PoW)åŸºäºè¿ç®—èƒ½åŠ›æ¥ç­›é€‰å‡ºæŒ–æ˜åŒºå—çš„è·èƒœè€…ï¼Œè¿ç®—è¿‡ç¨‹ä¸­ä½¿ç”¨äº†å¤§é‡ã€å¤šæ¬¡ã€å¤šç§çš„å“ˆå¸Œå‡½æ•°ï¼Œé€šè¿‡æé«˜çš„è®¡ç®—èµ„æºæ¶ˆè€—ï¼Œæ¥é™åˆ¶æŸäº›èŠ‚ç‚¹é€šè¿‡è¶…å¸¸è§„çš„è®¡ç®—èƒ½åŠ›è½»æ˜“å½¢æˆâ€œä¸­å¿ƒåŒ–â€å€¾å‘</p>
</li>
<li><p>Cliqueç®—æ³•(PoA)åˆ©ç”¨æ•°å­—ç­¾åç®—æ³•å®ŒæˆSealæ“ä½œï¼Œç­¾åæ‰€ç”¨å…¬é’¥å¿…é¡»æ˜¯å·²è®¤è¯çš„ã€‚æ‰€æœ‰è®¤è¯åœ°å€åŸºäºç‰¹æ®Šçš„æŠ•ç¥¨åœ°å€è¿›è¡ŒåŠ¨æ€ç®¡ç†ï¼Œè®°åæŠ•ç¥¨ç”±ä¸è®°åæŠ•ç¥¨å’ŒæŠ•ç¥¨æ–¹åœ°å€éšæœºç»„åˆè€Œæˆï¼Œæœç»é‡å¤çš„ä¸è®°åæŠ•ç¥¨ï¼Œä¸¥æ ¼é™åˆ¶å¤–éƒ¨ä»£ç æ¶æ„æ“çºµæŠ•ç¥¨æ•°æ®</p>
</li>
<li><p>ä»¥å¤ªåŠè¿˜åœ¨åŒºå—ç»“æ„ä¸­å¢åŠ äº†å”åŒºå—(uncles)æˆå‘˜ä»¥åŠ å¤§è®¡ç®—èµ„æºçš„æ¶ˆè€—ï¼Œå¹¶é€šè¿‡åœ¨äº¤æ˜“æ‰§è¡Œç¯èŠ‚å¯¹å”åŒºå—ä½œè€…(æŒ–æ˜è€…)çš„å¥–åŠ±ï¼Œä»¥æ”¶ç›Šæœºåˆ¶æ¥è°ƒåŠ¨ç½‘ç»œä¸­å„èŠ‚ç‚¹è¿ç®—èµ„æºåˆ†å¸ƒæ›´åŠ å‡åŒ€ã€‚</p>
</li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;ä»¥å¤ªåŠæºä»£ç &quot;&gt;&lt;a href=&quot;#ä»¥å¤ªåŠæºä»£ç &quot; class=&quot;headerlink&quot; title=&quot;ä»¥å¤ªåŠæºä»£ç &quot;&gt;&lt;/a&gt;ä»¥å¤ªåŠæºä»£ç &lt;/h2&gt;&lt;h3 id=&quot;å…±è¯†ç®—æ³•&quot;&gt;&lt;a href=&quot;#å…±è¯†ç®—æ³•&quot; class=&quot;headerlink&quot; title=&quot;å…±è¯†ç®—æ³•&quot;&gt;&lt;/a&gt;å…±è¯†ç®—æ³•&lt;/h3&gt;&lt;p&gt;å…±è¯†ç®—æ³•ä½¿ç”¨Engineæ¥å£ï¼Œåˆ†ä¸ºä¸¤ç§å®ç°æ–¹å¼ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;p&gt;åŸºäºè¿ç®—èƒ½åŠ›çš„Ethashç®—æ³•&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;åŸºäºâ€œåŒè¡Œâ€è®¤è¯çš„Cliqueç®—æ³•&lt;/p&gt;
    
    </summary>
    
      <category term="æŠ€æœ¯" scheme="http://jiaotingyu.me/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
      <category term="Golang" scheme="http://jiaotingyu.me/tags/Golang/"/>
    
      <category term="ä»¥å¤ªåŠ" scheme="http://jiaotingyu.me/tags/%E4%BB%A5%E5%A4%AA%E5%9D%8A/"/>
    
  </entry>
  
  <entry>
    <title>Golangå­¦ä¹ ç¬”è®°ï¼ˆäº”ï¼‰</title>
    <link href="http://jiaotingyu.me/2018/09/19/Golang%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%94%EF%BC%89/"/>
    <id>http://jiaotingyu.me/2018/09/19/Golangå­¦ä¹ ç¬”è®°ï¼ˆäº”ï¼‰/</id>
    <published>2018-09-18T16:00:00.000Z</published>
    <updated>2020-05-19T08:42:25.921Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Goè¯­è¨€ç‰¹æ€§"><a href="#Goè¯­è¨€ç‰¹æ€§" class="headerlink" title="Goè¯­è¨€ç‰¹æ€§"></a>Goè¯­è¨€ç‰¹æ€§</h2><a id="more"></a>
<ul>
<li>å¯ç›´æ¥ç¼–è¯‘æˆæœºå™¨ç ï¼Œç›´æ¥ç”Ÿæˆå¯æ‰§è¡ŒäºŒè¿›åˆ¶æ–‡ä»¶</li>
<li>é™æ€ç±»å‹è¯­è¨€ï¼Œå¯ä»¥åœ¨ç¼–è¯‘çš„æ—¶å€™æ£€æŸ¥å‡ºæ¥éšè—çš„å¤§å¤šæ•°é—®é¢˜<ul>
<li>åŠ¨æ€ç±»å‹è¯­è¨€ï¼šæ˜¯æŒ‡åœ¨è¿è¡ŒæœŸé—´æ‰å»åšæ•°æ®ç±»å‹æ£€æŸ¥çš„è¯­è¨€ï¼Œè¯´çš„æ˜¯<strong>æ•°æ®ç±»å‹</strong></li>
<li>åŠ¨æ€è¯­è¨€ï¼šè¯´çš„æ˜¯è¿è¡Œæ˜¯æ”¹å˜ç»“æ„ï¼Œè¯´çš„æ˜¯<strong>ä»£ç ç»“æ„</strong></li>
<li>é™æ€ç±»å‹è¯­è¨€ï¼šé™æ€è¯­è¨€çš„æ•°æ®ç±»å‹æ˜¯åœ¨ç¼–è¯‘æœŸé—´ï¼ˆæˆ–è¿è¡Œä¹‹å‰ï¼‰ç¡®å®šçš„ï¼Œç¼–å†™ä»£ç çš„æ—¶å€™è¦æ˜ç¡®ç¡®å®šå˜é‡çš„æ•°æ®ç±»å‹</li>
<li>é™æ€è¯­è¨€ï¼šä¸åŠ¨æ€è¯­è¨€ç›¸å¯¹åº”çš„ï¼Œè¿è¡Œæ—¶ç»“æ„ä¸å¯å˜çš„è¯­è¨€å°±æ˜¯é™æ€è¯­è¨€</li>
</ul>
</li>
<li>å¤§é‡çš„ç¬¬ä¸‰æ–¹åŒ…å¯ä»¥ä½¿ç”¨</li>
<li>è¯­è¨€å±‚é¢æ”¯æŒå¹¶å‘ go helloï¼ˆï¼‰</li>
<li>æ”¯æŒåƒåœ¾å›æ”¶</li>
<li>è¯­è¨€ç®€æ´ï¼Œå…³é”®å­—åªæœ‰25ä¸ªï¼Œæ”¯æŒç»§æ‰¿ã€é‡è½½ã€å¯¹è±¡</li>
<li>è·¨å¹³å°ï¼Œå¼•ç”¨plan9çš„ä»£ç ï¼Œä¸ä¾èµ–ç³»ç»Ÿä¿¡æ¯<ul>
<li>Plan9æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼æ“ä½œç³»ç»Ÿï¼Œå®ƒèƒ½æŠŠç½‘ç»œä¸Šä¸€åˆ‡çš„èµ„æºå½“ä½œæ–‡ä»¶æ¥è¿›è¡Œä½¿ç”¨ã€‚Plan9ä¸­æœ€æœ¬è´¨çš„æ€æƒ³æ˜¯â€œä¸€åˆ‡çš†æ˜¯æ–‡ä»¶â€</li>
</ul>
</li>
</ul>
<h2 id="Goè¯­è¨€çš„ä¼˜åŠ£"><a href="#Goè¯­è¨€çš„ä¼˜åŠ£" class="headerlink" title="Goè¯­è¨€çš„ä¼˜åŠ£"></a>Goè¯­è¨€çš„ä¼˜åŠ£</h2><ul>
<li>Goè¯­è¨€é€‚åˆåšæœåŠ¡ç«¯ç¨‹åºï¼Œä¾‹å¦‚å„ç§webç¨‹åºï¼ŒæœåŠ¡å™¨è½¯ä»¶ï¼Œå‘½ä»¤è¡Œå·¥å…·</li>
<li>Goè¯­è¨€ä¸é€‚åˆå¼€å‘æœ‰å›¾å½¢ç•Œé¢çš„åº”ç”¨ç¨‹åºï¼Œå®˜æ–¹æ²¡æœ‰æä¾›ç›¸å…³çš„å›¾å½¢åº“</li>
<li>ä¸æ”¯æŒå¤šæ€<ul>
<li>å¤šæ€ï¼šå¤šæ€æ€§æ˜¯å…è®¸ä½ å°†çˆ¶å¯¹è±¡è®¾ç½®æˆä¸ºå’Œä¸€ä¸ªæˆ–æ›´å¤šçš„ä»–çš„å­å¯¹è±¡ç›¸ç­‰çš„æŠ€æœ¯ï¼Œèµ‹å€¼ä¹‹åï¼Œçˆ¶å¯¹è±¡å°±å¯ä»¥æ ¹æ®å½“å‰èµ‹å€¼ç»™å®ƒçš„å­å¯¹è±¡çš„ç‰¹æ€§ä»¥ä¸åŒçš„æ–¹å¼è¿ä½œã€‚ç®€å•çš„è¯´ï¼šå…è®¸å°†å­ç±»ç±»å‹çš„æŒ‡é’ˆèµ‹å€¼ç»™çˆ¶ç±»ç±»å‹çš„æŒ‡é’ˆï¼ˆä¸€ä¸ªæ¥å£ï¼Œå¤šç§æ–¹æ³•ï¼‰ã€‚<br>C++ æ”¯æŒä¸¤ç§å¤šæ€æ€§ï¼šç¼–è¯‘æ—¶å¤šæ€æ€§ï¼Œè¿è¡Œæ—¶å¤šæ€æ€§ã€‚<br>aã€ç¼–è¯‘æ—¶å¤šæ€æ€§ï¼ˆé™æ€å¤šæ€ï¼‰ï¼šé€šè¿‡é‡è½½å‡½æ•°å®ç°<br>bã€è¿è¡Œæ—¶å¤šæ€æ€§ï¼ˆåŠ¨æ€å¤šæ€ï¼‰ï¼šé€šè¿‡è™šå‡½æ•°å®ç°ã€‚</li>
</ul>
</li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Goè¯­è¨€ç‰¹æ€§&quot;&gt;&lt;a href=&quot;#Goè¯­è¨€ç‰¹æ€§&quot; class=&quot;headerlink&quot; title=&quot;Goè¯­è¨€ç‰¹æ€§&quot;&gt;&lt;/a&gt;Goè¯­è¨€ç‰¹æ€§&lt;/h2&gt;
    
    </summary>
    
      <category term="æŠ€æœ¯" scheme="http://jiaotingyu.me/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
      <category term="Golang" scheme="http://jiaotingyu.me/tags/Golang/"/>
    
  </entry>
  
  <entry>
    <title>ä»¥å¤ªåŠå­¦ä¹ ç¬”è®°ï¼ˆåä¸€ï¼‰</title>
    <link href="http://jiaotingyu.me/2018/09/17/%E4%BB%A5%E5%A4%AA%E5%9D%8A%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%88%E5%8D%81%E4%B8%80%EF%BC%89/"/>
    <id>http://jiaotingyu.me/2018/09/17/ä»¥å¤ªåŠå­¦ä¹ ç¬”è®°ï¼ˆåä¸€ï¼‰/</id>
    <published>2018-09-16T16:00:00.000Z</published>
    <updated>2020-05-18T15:28:30.873Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ä»¥å¤ªåŠæºä»£ç "><a href="#ä»¥å¤ªåŠæºä»£ç " class="headerlink" title="ä»¥å¤ªåŠæºä»£ç "></a>ä»¥å¤ªåŠæºä»£ç </h2><h3 id="æŒ–çŸ¿"><a href="#æŒ–çŸ¿" class="headerlink" title="æŒ–çŸ¿"></a>æŒ–çŸ¿</h3><p>åœ¨ä»¥å¤ªåŠä¸­mineråŒ…è´Ÿè´£æä¾›æ–°æŒ–çš„åŒºå—</p>
<p>å…¬å…±ç±»Minerç”¨äºå®ç°æŒ–çŸ¿åŠŸèƒ½ï¼Œé‡Œé¢åŒ…å«ä¸€ä¸ªworkerç±»å‹çš„æˆå‘˜å˜é‡ï¼Œwokeré‡Œé¢æœ‰ä¸€ç»„Agentæ¥å£ç±»å‹å¯¹è±¡</p>
<p>Workç»“æ„ä½“ç”¨äºæºå¸¦æ•°æ®</p>
<p>æ•°æ®ä¼ è¾“è¿‡ç¨‹ï¼šworderæŠŠworkå¯¹è±¡å‘é€ç»™æ¯ä¸ªAgentï¼Œå…¶ä¸­çš„Agentå®ŒæˆæŒ–çŸ¿æ˜¯ï¼Œå°†ä¸€ä¸ªç»è¿‡æˆæƒçš„BlockåŠ ä¸ŠWorkè¿”å›ç»™worder</p>
<p>ä¸€ä¸ªæ–°åŒºå—è¢«æŒ–æ˜ä»£ç å®ç°åˆ†ä¸ºä¸¤æ­¥ï¼š</p>
<ol>
<li><p>ç»„è£…ä¸€ä¸ªæ–°åŒºå—ï¼Œè¿™ä¸ªåŒºå—å„ä¸ªæ•°æ®åŸºæœ¬å®Œæ•´ï¼Œå¹¶ä¸”æ‰€æœ‰äº¤æ˜“æ‰§è¡Œå®Œæ¯•ï¼Œæ‰€æœ‰æ”¶æ®éƒ½è®°å½•å®Œæ¯•</p>
</li>
<li><p>è¡¥å…¨åŒºå—å…¶å®ƒçš„æˆå‘˜å±æ€§ï¼Œå®Œæˆæˆæƒ</p>
<a id="more"></a>
</li>
</ol>
<h3 id="mineråŒ…è§£æ"><a href="#mineråŒ…è§£æ" class="headerlink" title="mineråŒ…è§£æ"></a>mineråŒ…è§£æ</h3><p>Minerç±»</p>
<ul>
<li><p>New()ï¼šåœ¨å¯¹minerçš„æˆå‘˜å˜é‡åˆå§‹åŒ–å®Œæˆåï¼Œåˆ›å»ºworkerå¯¹è±¡ï¼Œåˆ›å»ºå®Œæˆåè¿è¡Œminer.Update()å‡½æ•°</p>
</li>
<li><p>Update()ï¼šUpdateç›‘å¬æœ‰å…³Downloaderçš„äº‹ä»¶ï¼Œå½“æ”¶åˆ°Downloaderçš„StartEventæ—¶ï¼Œè¯´æ˜æ­£åœ¨ä¸‹è½½æ–°åŒºå—ï¼Œæ­¤æ—¶åœæ­¢æŒ–æ˜å·¥ä½œï¼Œç»§ç»­ç›‘å¬ï¼›å½“æ”¶åˆ°DoneEventæˆ–FailEventæ—¶ï¼Œè¯´æ˜ä¸‹è½½å®Œæˆæˆ–ä¸‹è½½å¤±è´¥ï¼Œåˆ™ç»§ç»­æŒ–æ˜æ–°åŒºå—ï¼Œåœæ­¢ç›‘å¬</p>
</li>
</ul>
<p>Workerç±»</p>
<ul>
<li><p>Update()ï¼šç›‘å¬ChainHeadEventï¼ŒChainSideEventï¼ŒTxPreEventå‡ ä¸ªäº‹ä»¶</p>
<ul>
<li>ChainHeadEventäº‹ä»¶æ˜¯åŒºå—é“¾ä¸­åŠ å…¥äº†ä¸€ä¸ªæ–°çš„åŒºå—ä½œä¸ºé“¾å¤´ï¼Œworkerä¼šç«‹åˆ»å¼€å§‹å‡†å¤‡æŒ–æ˜</li>
<li>ChainSideEventäº‹ä»¶æ˜¯åŒºå—é“¾ä¸­åŠ å…¥ä¸€ä¸ªæ–°åŒºå—ä½œä¸ºé“¾å¤´çš„æ—æ”¯ï¼Œworkerä¼šæŠŠåŒºå—åŠ å…¥possibleUncles[]ï¼Œä½œä¸ºæ–°åŒºå—å¯èƒ½çš„Uncle</li>
<li>TxPreEventäº‹ä»¶æ˜¯ä¸€ä¸ªæ–°çš„äº¤æ˜“txåŠ å…¥TxPoolï¼ŒworkeræŠŠtxåŠ å…¥Work.txsæ•°ç»„</li>
</ul>
</li>
<li><p>wait()ï¼šè¯¥å‡½æ•°ä¼šä¸€ç›´ç­‰å¾…Agentå‘é€å›æ¥æ–°çš„Blockå’ŒWorkå¯¹è±¡</p>
</li>
<li><p>commitNewWork()ï¼šå®Œæˆå¾…æŒ–æ˜åŒºå—çš„ç»„è£…</p>
</li>
</ul>
<p>CpuAgentç±»</p>
<ul>
<li><p>update()ï¼šä¸€ç›´ç›‘å¬ç›¸å…³channelï¼Œå¦‚æœæ”¶åˆ°Workå¯¹è±¡ï¼Œå¯åŠ¨mine()å‡½æ•°ï¼›å¦‚æœæ”¶åˆ°åœæ­¢æ¶ˆæ¯ï¼Œé€€å‡ºä¸€åˆ‡ç›¸å…³æ“ä½œ</p>
</li>
<li><p>mine()ï¼šè°ƒç”¨Engine.Seal()å‡½æ•°ï¼Œå¯¹åŒºå—è¿›è¡Œæˆæƒï¼Œå¦‚æœæˆåŠŸï¼Œå°†Blockå’ŒWorkä¸€èµ·å‘é€ç»™worker</p>
</li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;ä»¥å¤ªåŠæºä»£ç &quot;&gt;&lt;a href=&quot;#ä»¥å¤ªåŠæºä»£ç &quot; class=&quot;headerlink&quot; title=&quot;ä»¥å¤ªåŠæºä»£ç &quot;&gt;&lt;/a&gt;ä»¥å¤ªåŠæºä»£ç &lt;/h2&gt;&lt;h3 id=&quot;æŒ–çŸ¿&quot;&gt;&lt;a href=&quot;#æŒ–çŸ¿&quot; class=&quot;headerlink&quot; title=&quot;æŒ–çŸ¿&quot;&gt;&lt;/a&gt;æŒ–çŸ¿&lt;/h3&gt;&lt;p&gt;åœ¨ä»¥å¤ªåŠä¸­mineråŒ…è´Ÿè´£æä¾›æ–°æŒ–çš„åŒºå—&lt;/p&gt;
&lt;p&gt;å…¬å…±ç±»Minerç”¨äºå®ç°æŒ–çŸ¿åŠŸèƒ½ï¼Œé‡Œé¢åŒ…å«ä¸€ä¸ªworkerç±»å‹çš„æˆå‘˜å˜é‡ï¼Œwokeré‡Œé¢æœ‰ä¸€ç»„Agentæ¥å£ç±»å‹å¯¹è±¡&lt;/p&gt;
&lt;p&gt;Workç»“æ„ä½“ç”¨äºæºå¸¦æ•°æ®&lt;/p&gt;
&lt;p&gt;æ•°æ®ä¼ è¾“è¿‡ç¨‹ï¼šworderæŠŠworkå¯¹è±¡å‘é€ç»™æ¯ä¸ªAgentï¼Œå…¶ä¸­çš„Agentå®ŒæˆæŒ–çŸ¿æ˜¯ï¼Œå°†ä¸€ä¸ªç»è¿‡æˆæƒçš„BlockåŠ ä¸ŠWorkè¿”å›ç»™worder&lt;/p&gt;
&lt;p&gt;ä¸€ä¸ªæ–°åŒºå—è¢«æŒ–æ˜ä»£ç å®ç°åˆ†ä¸ºä¸¤æ­¥ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;p&gt;ç»„è£…ä¸€ä¸ªæ–°åŒºå—ï¼Œè¿™ä¸ªåŒºå—å„ä¸ªæ•°æ®åŸºæœ¬å®Œæ•´ï¼Œå¹¶ä¸”æ‰€æœ‰äº¤æ˜“æ‰§è¡Œå®Œæ¯•ï¼Œæ‰€æœ‰æ”¶æ®éƒ½è®°å½•å®Œæ¯•&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;è¡¥å…¨åŒºå—å…¶å®ƒçš„æˆå‘˜å±æ€§ï¼Œå®Œæˆæˆæƒ&lt;/p&gt;
    
    </summary>
    
      <category term="æŠ€æœ¯" scheme="http://jiaotingyu.me/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
      <category term="Golang" scheme="http://jiaotingyu.me/tags/Golang/"/>
    
      <category term="ä»¥å¤ªåŠ" scheme="http://jiaotingyu.me/tags/%E4%BB%A5%E5%A4%AA%E5%9D%8A/"/>
    
  </entry>
  
  <entry>
    <title>ä»¥å¤ªåŠå­¦ä¹ ç¬”è®°ï¼ˆåï¼‰</title>
    <link href="http://jiaotingyu.me/2018/09/15/%E4%BB%A5%E5%A4%AA%E5%9D%8A%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%88%E5%8D%81%EF%BC%89/"/>
    <id>http://jiaotingyu.me/2018/09/15/ä»¥å¤ªåŠå­¦ä¹ ç¬”è®°ï¼ˆåï¼‰/</id>
    <published>2018-09-14T16:00:00.000Z</published>
    <updated>2020-05-18T15:27:42.473Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ä»¥å¤ªåŠæºä»£ç "><a href="#ä»¥å¤ªåŠæºä»£ç " class="headerlink" title="ä»¥å¤ªåŠæºä»£ç "></a>ä»¥å¤ªåŠæºä»£ç </h2><p>ä»¥å¤ªåŠä¸­æ‰€æœ‰çš„æ•°æ®éƒ½æ˜¯ä»¥é”®å€¼å¯¹çš„å½¢å¼å­˜åœ¨ï¼Œä½¿ç”¨çš„åº•å±‚æ•°æ®åº“LevelDB</p>
<p>äº¤æ˜“æ“ä½œçš„è®°å½•ä»¥åŠç›¸å…³çš„æ•°æ®æ„æˆäº†åŒºå—</p>
<p>äº¤æ˜“çš„ç»“æœä»¥è´¦æˆ·çš„çŠ¶æ€å­˜åœ¨</p>
<a id="more"></a>
<p>å„ä¸ªæ•°æ®å•å…ƒå±‚æ¬¡å¦‚ä¸‹å›¾ï¼š</p>
<p><a href="https://imgchr.com/i/PKkL26" target="_blank" rel="external"><img src="https://s1.ax1x.com/2018/07/12/PKkL26.png" alt="PKkL26.png"></a></p>
<p>å„ä¸ªæ•°æ®å•å…ƒä½¿ç”¨Merkle-PatriciaTrie(MPT)æ•°æ®ç»“æ„ç»„ç»‡ç®¡ç†æ•°æ®</p>
<h3 id="åŒºå—Block"><a href="#åŒºå—Block" class="headerlink" title="åŒºå—Block"></a>åŒºå—Block</h3><p>è´¦æˆ·çš„æ´»åŠ¨éƒ½æ˜¯åœ¨åŒºå—ä¸­å­˜å‚¨ï¼Œæ¯ä¸ªåŒºå—éƒ½æœ‰ä¸€ä¸ªäº¤æ˜“å¯¹è±¡çš„åˆ—è¡¨</p>
<p>äº¤æ˜“çš„ç»“æœç”±ä¸€ä¸ªReceiptå¯¹è±¡å’Œä¸€ç»„Logå¯¹è±¡è®°å½•</p>
<p>ä¸åŒçš„åŒºå—é€šè¿‡ParentHashæŒ‡é’ˆä¸²è”æˆå•å‘é“¾è¡¨</p>
<p>åŒºå—çš„ç»“æ„åˆ†ä¸ºHeaderå’ŒBody</p>
<ul>
<li><p>Headerçš„æˆå‘˜å˜é‡ï¼š</p>
<ul>
<li>ParentHashï¼šæŒ‡å‘çˆ¶åŒºå—çš„æŒ‡é’ˆï¼Œæ¯ä¸ªåŒºå—æœ‰ä¸”åªæœ‰ä¸€ä¸ªçˆ¶åŒºå—</li>
<li>Coinbaseï¼šåŒºå—çš„çŸ¿å·¥åœ°å€</li>
<li>UncleHashï¼šåŒºå—ç»“æ„ä½“æˆå‘˜unclesçš„RLPï¼ˆRecursive Length Prefixï¼Œé€’å½’é•¿åº¦å‰ç¼€ç¼–ç ï¼‰å“ˆå¸Œå€¼</li>
<li>Rootï¼šStateDBä¸­çš„çŠ¶æ€æ ‘çš„æ ¹èŠ‚ç‚¹çš„RLPå“ˆå¸Œå€¼</li>
<li>TxHashï¼šTxæ ‘çš„æ ¹èŠ‚ç‚¹çš„RLPå“ˆå¸Œå€¼</li>
<li>ReceiptHashï¼šæ¥æ”¶æ ‘çš„æ ¹èŠ‚ç‚¹çš„RLPå“ˆå¸Œå€¼</li>
<li>Bloomï¼šè¿‡æ»¤å™¨ï¼Œç”¨æ¥åˆ¤æ–­logå¯¹è±¡æ˜¯å¦å­˜åœ¨</li>
<li>Difficultyï¼šåŒºå—éš¾åº¦</li>
<li>Numberï¼šåŒºå—åºå·</li>
<li>Timeï¼šåŒºå—åˆ›å»ºæ—¶é—´</li>
<li>GasLimitï¼šåŒºå—æ‰€æœ‰Gasæ¶ˆè€—ä¸Šé™</li>
<li>GasUsedï¼šåŒºå—çš„æ“ä½œæ‰§è¡Œå®é™…æ¶ˆè€—çš„Gasæ€»å’Œ</li>
<li>Nonceï¼š64ä½å“ˆå¸Œæ•°</li>
</ul>
</li>
<li><p>Bodyçš„æˆå‘˜å˜é‡ï¼š</p>
<ul>
<li>tdï¼ˆtotalDifficultyï¼‰æ•´ä¸ªåŒºå—é“¾è¡¨æ‰€æœ‰çš„åŒºå—Difficultyçš„æ€»å’Œ</li>
<li>Uncles ä¸ºäº†é˜²æ­¢ä»¥å¤ªåŠç½‘ç»œæ³¢åŠ¨è¿‡å¤§</li>
</ul>
</li>
</ul>
<p>blockçš„å”¯ä¸€æ ‡è¯†ç¬¦å°±æ˜¯Headeræˆå‘˜çš„RLPå“ˆå¸Œå€¼</p>
<h3 id="åŒºå—é“¾æ“ä½œ"><a href="#åŒºå—é“¾æ“ä½œ" class="headerlink" title="åŒºå—é“¾æ“ä½œ"></a>åŒºå—é“¾æ“ä½œ</h3><ul>
<li><p>æŸ¥æ‰¾ åŒºå—é“¾ä¸­å­˜åœ¨æˆå‘˜currentBlockï¼ŒæŒ‡å‘å½“å‰æœ€æ–°çš„åŒºå—</p>
</li>
<li><p>æ’å…¥å’Œåˆ é™¤ åŒºå—é“¾çš„headerä¸­å­˜åœ¨ParentHashçš„å‘å‰æŒ‡é’ˆï¼Œè¿™ä¸ªå€¼ä¸èƒ½éšæ„ä¿®æ”¹ï¼Œå½“éœ€è¦æ’å…¥æ—¶ï¼Œä»æ–°çš„headerå¼€å§‹å›æº¯ï¼Œä¿è¯æ‰€æœ‰çš„parentéƒ½å†™å…¥æ•°æ®åº“ï¼Œä¸€èˆ¬æ’å…¥å’Œåˆ é™¤æ—¶åŒæ—¶å‡ºç°çš„</p>
</li>
</ul>
<h3 id="Merkle-Patricia-Trie-MPT"><a href="#Merkle-Patricia-Trie-MPT" class="headerlink" title="Merkle-Patricia Trie(MPT)"></a>Merkle-Patricia Trie(MPT)</h3><p>MPTæ˜¯ä»¥å¤ªåŠè‡ªå®šä¹‰çš„æ ‘å½¢æ•°æ®ç»“æ„</p>
<p>MPT çš„èŠ‚ç‚¹åˆ†ä¸ºå››ç§ï¼š</p>
<ul>
<li>fullNodeï¼šå¯ä»¥æºå¸¦å¤šä¸ªå­èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹</li>
<li>shortNodeï¼šä»…æœ‰ä¸€ä¸ªå­èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹</li>
<li>valueNodeï¼šMPTä¸­çš„å­èŠ‚ç‚¹</li>
<li>hashNodeï¼šfullNodeæˆ–è€…shortNodeçš„RLPå“ˆå¸Œå€¼</li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;ä»¥å¤ªåŠæºä»£ç &quot;&gt;&lt;a href=&quot;#ä»¥å¤ªåŠæºä»£ç &quot; class=&quot;headerlink&quot; title=&quot;ä»¥å¤ªåŠæºä»£ç &quot;&gt;&lt;/a&gt;ä»¥å¤ªåŠæºä»£ç &lt;/h2&gt;&lt;p&gt;ä»¥å¤ªåŠä¸­æ‰€æœ‰çš„æ•°æ®éƒ½æ˜¯ä»¥é”®å€¼å¯¹çš„å½¢å¼å­˜åœ¨ï¼Œä½¿ç”¨çš„åº•å±‚æ•°æ®åº“LevelDB&lt;/p&gt;
&lt;p&gt;äº¤æ˜“æ“ä½œçš„è®°å½•ä»¥åŠç›¸å…³çš„æ•°æ®æ„æˆäº†åŒºå—&lt;/p&gt;
&lt;p&gt;äº¤æ˜“çš„ç»“æœä»¥è´¦æˆ·çš„çŠ¶æ€å­˜åœ¨&lt;/p&gt;
    
    </summary>
    
      <category term="æŠ€æœ¯" scheme="http://jiaotingyu.me/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
      <category term="Golang" scheme="http://jiaotingyu.me/tags/Golang/"/>
    
      <category term="ä»¥å¤ªåŠ" scheme="http://jiaotingyu.me/tags/%E4%BB%A5%E5%A4%AA%E5%9D%8A/"/>
    
  </entry>
  
  <entry>
    <title>ä»¥å¤ªåŠå­¦ä¹ ç¬”è®°ï¼ˆä¹ï¼‰</title>
    <link href="http://jiaotingyu.me/2018/09/14/%E4%BB%A5%E5%A4%AA%E5%9D%8A%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B9%9D%EF%BC%89/"/>
    <id>http://jiaotingyu.me/2018/09/14/ä»¥å¤ªåŠå­¦ä¹ ç¬”è®°ï¼ˆä¹ï¼‰/</id>
    <published>2018-09-13T16:00:00.000Z</published>
    <updated>2020-05-18T15:27:06.128Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ä»¥å¤ªåŠæºç åˆ†æ"><a href="#ä»¥å¤ªåŠæºç åˆ†æ" class="headerlink" title="ä»¥å¤ªåŠæºç åˆ†æ"></a>ä»¥å¤ªåŠæºç åˆ†æ</h2><a id="more"></a>
<h3 id="mainå‡½æ•°åˆ†æ"><a href="#mainå‡½æ•°åˆ†æ" class="headerlink" title="mainå‡½æ•°åˆ†æ"></a>mainå‡½æ•°åˆ†æ</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">HandleAction</span><span class="params">(action <span class="keyword">interface</span>&#123;&#125;, context *Context)</span> <span class="params">(err error)</span></span> &#123;</div><div class="line">        <span class="keyword">if</span> a, ok := action.(ActionFunc); ok &#123;</div><div class="line">            <span class="keyword">return</span> a(context)</div><div class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> a, ok := action.(<span class="function"><span class="keyword">func</span><span class="params">(*Context)</span> <span class="title">error</span>); <span class="title">ok</span></span> &#123;</div><div class="line">            <span class="keyword">return</span> a(context)</div><div class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> a, ok := action.(<span class="function"><span class="keyword">func</span><span class="params">(*Context)</span>); <span class="title">ok</span></span> &#123; <span class="comment">// deprecated function signature</span></div><div class="line">            a(context)</div><div class="line">            <span class="keyword">return</span> <span class="literal">nil</span></div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            <span class="keyword">return</span> errInvalidActionType</div><div class="line">        &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å…¶ä¸­actionç±»å‹ä¸ºç¬¬äºŒä¸ªåˆ†æ”¯ï¼Œæ‰§è¡Œa(context)ï¼Œè¿™æ—¶ä¼šè°ƒç”¨App.init()åˆå§‹åŒ–çš„consoleCommand</p>
<h3 id="åˆ†æconsoleCommandå‡½æ•°"><a href="#åˆ†æconsoleCommandå‡½æ•°" class="headerlink" title="åˆ†æconsoleCommandå‡½æ•°"></a>åˆ†æconsoleCommandå‡½æ•°</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">consoleCommand = cli.Command&#123;</div><div class="line">        Action:   utils.MigrateFlags(localConsole),</div><div class="line">        Name:     <span class="string">"console"</span>,</div><div class="line">        Usage:    <span class="string">"Start an interactive JavaScript environment"</span>,</div><div class="line">        Flags:    <span class="built_in">append</span>(<span class="built_in">append</span>(<span class="built_in">append</span>(nodeFlags, rpcFlags...), consoleFlags...), whisperFlags...),</div><div class="line">        Category: <span class="string">"CONSOLE COMMANDS"</span>,</div><div class="line">        Description: <span class="string">`</span></div><div class="line">The Geth console is an interactive shell for the JavaScript runtime environment</div><div class="line">which exposes a node admin interface as well as the Ãapp JavaScript API.</div><div class="line">See https://github.com/ethereum/go-ethereum/wiki/Javascipt-Console.`,</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>consoleCommandä¸­åŒ…å«çš„Actionä¼šæ‰§è¡ŒlocalConsoleå‡½æ•°</p>
<h3 id="åˆ†ælocalConsoleå‡½æ•°"><a href="#åˆ†ælocalConsoleå‡½æ•°" class="headerlink" title="åˆ†ælocalConsoleå‡½æ•°"></a>åˆ†ælocalConsoleå‡½æ•°</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">localConsole</span><span class="params">(ctx *cli.Context)</span> <span class="title">error</span></span> &#123;</div><div class="line">    <span class="comment">// Create and start the node based on the CLI flags</span></div><div class="line">    node := makeFullNode(ctx)</div><div class="line">    startNode(ctx, node)</div><div class="line">    <span class="keyword">defer</span> node.Stop()</div><div class="line"></div><div class="line">    <span class="comment">// Attach to the newly started node and start the JavaScript console</span></div><div class="line">    client, err := node.Attach()</div><div class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</div><div class="line">        utils.Fatalf(<span class="string">"Failed to attach to the inproc geth: %v"</span>, err)</div><div class="line">    &#125;</div><div class="line">    config := console.Config&#123;</div><div class="line">        DataDir: utils.MakeDataDir(ctx),</div><div class="line">        DocRoot: ctx.GlobalString(utils.JSpathFlag.Name),</div><div class="line">        Client:  client,</div><div class="line">        Preload: utils.MakeConsolePreloads(ctx),</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    console, err := console.New(config)</div><div class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</div><div class="line">        utils.Fatalf(<span class="string">"Failed to start the JavaScript console: %v"</span>, err)</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">defer</span> console.Stop(<span class="literal">false</span>)</div><div class="line"></div><div class="line">    <span class="comment">// If only a short execution was requested, evaluate and return</span></div><div class="line">    <span class="keyword">if</span> script := ctx.GlobalString(utils.ExecFlag.Name); script != <span class="string">""</span> &#123;</div><div class="line">        console.Evaluate(script)</div><div class="line">        <span class="keyword">return</span> <span class="literal">nil</span></div><div class="line">    &#125;</div><div class="line">    <span class="comment">// Otherwise print the welcome screen and enter interactive mode</span></div><div class="line">    console.Welcome()</div><div class="line">    console.Interactive()</div><div class="line"></div><div class="line">    <span class="keyword">return</span> <span class="literal">nil</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>localConsoleå‡½æ•°åˆ†ä¸º3å—åŠŸèƒ½ï¼š</strong></p>
<ol>
<li><p>åˆ›å»ºå¹¶å¯åŠ¨ä¸€ä¸ªèŠ‚ç‚¹ï¼Œåœ¨ç»“æŸæ—¶åœæ­¢èŠ‚ç‚¹</p>
</li>
<li><p>å¯åŠ¨ä¸€ä¸ªjsæ§åˆ¶å°å¹¶ä¸”ä¸è¿æ¥åˆšåˆ›å»ºçš„èŠ‚ç‚¹</p>
</li>
<li><p>è¾“å‡ºæ¬¢è¿ä¿¡æ¯</p>
</li>
</ol>
<h3 id="åˆ†æmakeFullNodeå‡½æ•°"><a href="#åˆ†æmakeFullNodeå‡½æ•°" class="headerlink" title="åˆ†æmakeFullNodeå‡½æ•°"></a>åˆ†æmakeFullNodeå‡½æ•°</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">makeFullNode</span><span class="params">(ctx *cli.Context)</span> *<span class="title">node</span>.<span class="title">Node</span></span> &#123;</div><div class="line">    stack, cfg := makeConfigNode(ctx)</div><div class="line"></div><div class="line">    utils.RegisterEthService(stack, &amp;cfg.Eth)</div><div class="line"></div><div class="line">    <span class="comment">// Whisper must be explicitly enabled by specifying at least 1 whisper flag or in dev mode</span></div><div class="line">    shhEnabled := enableWhisper(ctx)</div><div class="line">    shhAutoEnabled := !ctx.GlobalIsSet(utils.WhisperEnabledFlag.Name) &amp;&amp; ctx.GlobalIsSet(utils.DevModeFlag.Name)</div><div class="line">    <span class="keyword">if</span> shhEnabled || shhAutoEnabled &#123;</div><div class="line">        <span class="keyword">if</span> ctx.GlobalIsSet(utils.WhisperMaxMessageSizeFlag.Name) &#123;</div><div class="line">            cfg.Shh.MaxMessageSize = <span class="keyword">uint32</span>(ctx.Int(utils.WhisperMaxMessageSizeFlag.Name))</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span> ctx.GlobalIsSet(utils.WhisperMinPOWFlag.Name) &#123;</div><div class="line">            cfg.Shh.MinimumAcceptedPOW = ctx.Float64(utils.WhisperMinPOWFlag.Name)</div><div class="line">        &#125;</div><div class="line">        utils.RegisterShhService(stack, &amp;cfg.Shh)</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">// Add the Ethereum Stats daemon if requested.</span></div><div class="line">    <span class="keyword">if</span> cfg.Ethstats.URL != <span class="string">""</span> &#123;</div><div class="line">        utils.RegisterEthStatsService(stack, cfg.Ethstats.URL)</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">// Add the release oracle service so it boots along with node.</span></div><div class="line">    <span class="keyword">if</span> err := stack.Register(<span class="function"><span class="keyword">func</span><span class="params">(ctx *node.ServiceContext)</span> <span class="params">(node.Service, error)</span></span> &#123;</div><div class="line">        config := release.Config&#123;</div><div class="line">            Oracle: relOracle,</div><div class="line">            Major:  <span class="keyword">uint32</span>(params.VersionMajor),</div><div class="line">            Minor:  <span class="keyword">uint32</span>(params.VersionMinor),</div><div class="line">            Patch:  <span class="keyword">uint32</span>(params.VersionPatch),</div><div class="line">        &#125;</div><div class="line">        commit, _ := hex.DecodeString(gitCommit)</div><div class="line">        <span class="built_in">copy</span>(config.Commit[:], commit)</div><div class="line">        <span class="keyword">return</span> release.NewReleaseService(ctx, config)</div><div class="line">    &#125;); err != <span class="literal">nil</span> &#123;</div><div class="line">        utils.Fatalf(<span class="string">"Failed to register the Geth release oracle service: %v"</span>, err)</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> stack</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>é¦–å…ˆä½¿ç”¨makeConfigNodeå‡½æ•°åˆ›å»ºnodeï¼Œç„¶åæ·»åŠ ä¸€ä¸ªå’ŒèŠ‚ç‚¹åŒæ—¶å¯åŠ¨çš„æœåŠ¡</p>
<h3 id="åˆ†æmakeConfigNodeå‡½æ•°"><a href="#åˆ†æmakeConfigNodeå‡½æ•°" class="headerlink" title="åˆ†æmakeConfigNodeå‡½æ•°"></a>åˆ†æmakeConfigNodeå‡½æ•°</h3><pre><code>func makeConfigNode(ctx *cli.Context) (*node.Node, gethConfig) {
    // Load defaults.
    cfg := gethConfig{
        Eth:  eth.DefaultConfig,
        Shh:  whisper.DefaultConfig,
        Node: defaultNodeConfig(),
    }

    // Load config file.
    if file := ctx.GlobalString(configFileFlag.Name); file != &quot;&quot; {
        if err := loadConfig(file, &amp;cfg); err != nil {
            utils.Fatalf(&quot;%v&quot;, err)
        }
    }

    // Apply flags.
    utils.SetNodeConfig(ctx, &amp;cfg.Node)
    stack, err := node.New(&amp;cfg.Node)
    if err != nil {
        utils.Fatalf(&quot;Failed to create the protocol stack: %v&quot;, err)
    }
    utils.SetEthConfig(ctx, stack, &amp;cfg.Eth)
    if ctx.GlobalIsSet(utils.EthStatsURLFlag.Name) {
        cfg.Ethstats.URL = ctx.GlobalString(utils.EthStatsURLFlag.Name)
    }

    utils.SetShhConfig(ctx, stack, &amp;cfg.Shh)

    return stack, cfg
}
</code></pre><p>å‡½æ•°å…ˆåˆå§‹åŒ–configå¹¶èµ‹å€¼ï¼Œç„¶ååˆå§‹åŒ–ä¸€ä¸ªnodeï¼Œnodeåˆ›å»ºå®Œæˆä»¥åè®¾ç½®EhtConfigå’ŒShhConfig</p>
<h3 id="åˆ†ænode-Newå‡½æ•°"><a href="#åˆ†ænode-Newå‡½æ•°" class="headerlink" title="åˆ†ænode.Newå‡½æ•°"></a>åˆ†ænode.Newå‡½æ•°</h3><p>-</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">New</span><span class="params">(conf *Config)</span> <span class="params">(*Node, error)</span></span> &#123;</div><div class="line">    <span class="comment">// Copy config and resolve the datadir so future changes to the current</span></div><div class="line">    <span class="comment">// working directory don't affect the node.</span></div><div class="line">    confCopy := *conf</div><div class="line">    conf = &amp;confCopy</div><div class="line">    <span class="keyword">if</span> conf.DataDir != <span class="string">""</span> &#123;</div><div class="line">        absdatadir, err := filepath.Abs(conf.DataDir)</div><div class="line">        <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</div><div class="line">            <span class="keyword">return</span> <span class="literal">nil</span>, err</div><div class="line">        &#125;</div><div class="line">        conf.DataDir = absdatadir</div><div class="line">    &#125;</div><div class="line">    <span class="comment">// Ensure that the instance name doesn't cause weird conflicts with</span></div><div class="line">    <span class="comment">// other files in the data directory.</span></div><div class="line">    <span class="keyword">if</span> strings.ContainsAny(conf.Name, <span class="string">`/\`</span>) &#123;</div><div class="line">        <span class="keyword">return</span> <span class="literal">nil</span>, errors.New(<span class="string">`Config.Name must not contain '/' or '\'`</span>)</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span> conf.Name == datadirDefaultKeyStore &#123;</div><div class="line">        <span class="keyword">return</span> <span class="literal">nil</span>, errors.New(<span class="string">`Config.Name cannot be "`</span> + datadirDefaultKeyStore + <span class="string">`"`</span>)</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span> strings.HasSuffix(conf.Name, <span class="string">".ipc"</span>) &#123;</div><div class="line">        <span class="keyword">return</span> <span class="literal">nil</span>, errors.New(<span class="string">`Config.Name cannot end in ".ipc"`</span>)</div><div class="line">    &#125;</div><div class="line">    <span class="comment">// Ensure that the AccountManager method works before the node has started.</span></div><div class="line">    <span class="comment">// We rely on this in cmd/geth.</span></div><div class="line">    am, ephemeralKeystore, err := makeAccountManager(conf)</div><div class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</div><div class="line">        <span class="keyword">return</span> <span class="literal">nil</span>, err</div><div class="line">    &#125;</div><div class="line">    <span class="comment">// Note: any interaction with Config that would create/touch files</span></div><div class="line">    <span class="comment">// in the data directory or instance directory is delayed until Start.</span></div><div class="line">    <span class="keyword">return</span> &amp;Node&#123;</div><div class="line">        accman:            am,</div><div class="line">        ephemeralKeystore: ephemeralKeystore,</div><div class="line">        config:            conf,</div><div class="line">        serviceFuncs:      []ServiceConstructor&#123;&#125;,</div><div class="line">        ipcEndpoint:       conf.IPCEndpoint(),</div><div class="line">        httpEndpoint:      conf.HTTPEndpoint(),</div><div class="line">        wsEndpoint:        conf.WSEndpoint(),</div><div class="line">        eventmux:          <span class="built_in">new</span>(event.TypeMux),</div><div class="line">    &#125;, <span class="literal">nil</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>é¦–å…ˆå°†ä¿å­˜è·¯å¾„è½¬æ¢ä¸ºç»å¯¹è·¯å¾„å¹¶è¿›è¡Œåˆæ³•æ€§éªŒè¯ï¼Œåœ¨èŠ‚ç‚¹å¼€å§‹å‰æ‰§è¡ŒAccountManagerï¼Œæœ€åä¸€æ­¥æ‰æ˜¯çœŸæ­£çš„åˆ›å»ºèŠ‚ç‚¹</p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;ä»¥å¤ªåŠæºç åˆ†æ&quot;&gt;&lt;a href=&quot;#ä»¥å¤ªåŠæºç åˆ†æ&quot; class=&quot;headerlink&quot; title=&quot;ä»¥å¤ªåŠæºç åˆ†æ&quot;&gt;&lt;/a&gt;ä»¥å¤ªåŠæºç åˆ†æ&lt;/h2&gt;
    
    </summary>
    
      <category term="æŠ€æœ¯" scheme="http://jiaotingyu.me/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
      <category term="Golang" scheme="http://jiaotingyu.me/tags/Golang/"/>
    
      <category term="ä»¥å¤ªåŠ" scheme="http://jiaotingyu.me/tags/%E4%BB%A5%E5%A4%AA%E5%9D%8A/"/>
    
  </entry>
  
  <entry>
    <title>ä»¥å¤ªåŠå­¦ä¹ ç¬”è®°ï¼ˆå…«ï¼‰</title>
    <link href="http://jiaotingyu.me/2018/09/11/%E4%BB%A5%E5%A4%AA%E5%9D%8A%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%88%E5%85%AB%EF%BC%89/"/>
    <id>http://jiaotingyu.me/2018/09/11/ä»¥å¤ªåŠå­¦ä¹ ç¬”è®°ï¼ˆå…«ï¼‰/</id>
    <published>2018-09-10T16:00:00.000Z</published>
    <updated>2020-05-18T15:26:56.954Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ä»¥å¤ªåŠæºç åˆ†æ"><a href="#ä»¥å¤ªåŠæºç åˆ†æ" class="headerlink" title="ä»¥å¤ªåŠæºç åˆ†æ"></a>ä»¥å¤ªåŠæºç åˆ†æ</h2><h3 id="ä»¥å¤ªåŠç¯å¢ƒæ­å»º"><a href="#ä»¥å¤ªåŠç¯å¢ƒæ­å»º" class="headerlink" title="ä»¥å¤ªåŠç¯å¢ƒæ­å»º"></a>ä»¥å¤ªåŠç¯å¢ƒæ­å»º</h3><p>æ­å»ºgoç¯å¢ƒ ç¼–è¯‘æºç </p>
<p>ç¼–è¯‘å®Œæˆåä¼šç”Ÿæˆä»¥ä¸‹æŒ‡ä»¤</p>
<ol>
<li><p>abigen æºä»£ç ç”Ÿæˆå™¨ï¼Œå°†æ™ºèƒ½åˆçº¦è½¬æ¢ä¸ºGo packageï¼Œç¼–è¯‘Solidityæºæ–‡ä»¶</p>
</li>
<li><p>bootnod ç”¨ä½œè½»é‡çº§çš„èŠ‚ç‚¹å¼•å¯¼å·¥å…·</p>
</li>
<li><p>evm å¯ä»¥è¿è¡Œå­—èŠ‚ç çš„ä»¥å¤ªåŠè™šæ‹Ÿæœºï¼Œå¯ä»¥å¯¹evmæ“ä½œç è¿›è¡Œå°è£…</p>
</li>
<li><p>geth ä»¥å¤ªåŠä¸»è¦çš„æ‰§è¡Œå®¢æˆ·ç«¯ï¼Œå¤šç”¨é€”å‘½ä»¤è¡Œå·¥å…·</p>
</li>
<li><p>rlpdump å¼€å‘å®ç”¨å·¥å…·ï¼Œå¯å°†äºŒè¿›åˆ¶RLPï¼ˆé€’å½’é•¿åº¦å‰ç¼€ï¼‰ï¼ˆä»¥å¤ªåŠåè®®ç½‘ç»œä»¥åŠå…±è¯†ä½¿ç”¨çš„æ•°æ®ç¼–ç ï¼‰è½¬å‚¨å­˜è‡³ç”¨æˆ·å‹å¥½çš„åˆ†å±‚è¡¨ç¤º</p>
</li>
<li><p>puppeth å‘½ä»¤è¡Œæ‰§è¡Œé¡µé¢çš„å‘å¯¼ç¨‹åºï¼Œç”¨äºåˆ›å»ºæ–°çš„ä»¥å¤ªåŠç½‘ç»œ</p>
</li>
<li><p>swarm swarmçš„å®ˆæŠ¤ç¨‹åºå’Œå·¥å…·ï¼ˆswarm æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼å­˜å‚¨å¹³å°å’Œå†…å®¹åˆ†å‘æœåŠ¡ï¼‰</p>
<a id="more"></a>
</li>
</ol>
<h3 id="geth"><a href="#geth" class="headerlink" title="geth"></a>geth</h3><p>gethå­å‘½ä»¤åˆ†ä¸ºä»¥ä¸‹å‡ ç§</p>
<ul>
<li><p>accountï¼šè´¦æˆ·ç®¡ç†</p>
</li>
<li><p>attachï¼šé“¾æ¥åˆ°jsç¯å¢ƒ</p>
</li>
<li><p>bugï¼šæŠ¥å‘Šgethåº“çš„é”™è¯¯</p>
</li>
<li><p>consoleï¼šå¼€å¯ä¸€ä¸ªjsäº¤äº’ç¯å¢ƒ</p>
</li>
<li><p>copydbï¼šå°†é€‰ä¸­åŒºå—é“¾çš„æ•°æ®å¤åˆ¶åˆ°æœ¬åœ°</p>
</li>
<li><p>dumpï¼šåˆ é™¤æŒ‡å®šåŒºå—</p>
</li>
<li><p>dumpconfigï¼šæ˜¾ç¤ºé…ç½®å€¼</p>
</li>
<li><p>exportï¼šå¯¼å‡ºåŒºå—é“¾æ•°æ®</p>
</li>
<li><p>importï¼šå¯¼å…¥åŒºå—é“¾æ•°æ®</p>
</li>
<li><p>initï¼šåˆå§‹åŒ–ä¸€ä¸ªæ–°çš„åˆå§‹åŒºå—ï¼ˆåˆ›ä¸–åŒºå—ï¼‰</p>
</li>
<li><p>jsï¼šæ‰§è¡ŒæŒ‡å®šçš„jsæ–‡ä»¶</p>
</li>
<li><p>licenseï¼šå±•ç¤ºè®¸å¯ä¿¡æ¯</p>
</li>
<li><p>makecacheï¼šç”Ÿæˆç”¨äºæµ‹è¯•çš„ethashæ ¡éªŒç¼“å­˜ï¼ˆethashæ˜¯å·¥ä½œé‡è¯æ˜ç®—æ³•ï¼‰</p>
</li>
<li><p>makedagï¼šç”Ÿæˆç”¨äºæµ‹è¯•çš„ethashæŒ–çŸ¿DAGï¼ˆDAGæ˜¯æ¯”ç‰¹å¸æ‰©å®¹æ–¹æ¡ˆï¼‰</p>
</li>
<li><p>monitorï¼šç›‘è§†èŠ‚ç‚¹æƒå€¼</p>
</li>
<li><p>removedbï¼šç§»é™¤åŒºå—é“¾ä»¥åŠçŠ¶æ€æ•°æ®åº“</p>
</li>
<li><p>versionï¼šæ˜¾ç¤ºç‰ˆæœ¬å·</p>
</li>
<li><p>walletï¼šç®¡ç†ä»¥å¤ªåŠé’±åŒ…</p>
</li>
</ul>
<h3 id="åˆ†æmainå‡½æ•°"><a href="#åˆ†æmainå‡½æ•°" class="headerlink" title="åˆ†æmainå‡½æ•°"></a>åˆ†æmainå‡½æ•°</h3><p>é¦–å…ˆä½¿ç”¨initåˆå§‹åŒ–å˜é‡å‚æ•°</p>
<p>mianæ–¹æ³•</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</div><div class="line">    <span class="keyword">if</span> err := app.Run(os.Args); err != <span class="literal">nil</span> &#123;</div><div class="line">        fmt.Fprintln(os.Stderr, err)</div><div class="line">        os.Exit(<span class="number">1</span>)</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è°ƒç”¨äº†app.Runå‡½æ•°</p>
<p>Runæ–¹æ³•è§£æäº†è¾“å…¥çš„å‚æ•°ï¼Œå¹¶ä¸”å°†å‘½ä»¤ä¿å­˜åˆ°contextä¸­ï¼Œç„¶åè°ƒç”¨HandleActionæ¥å¤„ç†å‘½ä»¤</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">HandleAction</span><span class="params">(action <span class="keyword">interface</span>&#123;&#125;, context *Context)</span> <span class="params">(err error)</span></span> &#123;</div><div class="line">    <span class="keyword">if</span> a, ok := action.(ActionFunc); ok &#123;</div><div class="line">        <span class="keyword">return</span> a(context)</div><div class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> a, ok := action.(<span class="function"><span class="keyword">func</span><span class="params">(*Context)</span> <span class="title">error</span>); <span class="title">ok</span></span> &#123;</div><div class="line">        <span class="keyword">return</span> a(context)</div><div class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> a, ok := action.(<span class="function"><span class="keyword">func</span><span class="params">(*Context)</span>); <span class="title">ok</span></span> &#123; <span class="comment">// deprecated function signature</span></div><div class="line">        a(context)</div><div class="line">        <span class="keyword">return</span> <span class="literal">nil</span></div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">        <span class="keyword">return</span> errInvalidActionType</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;ä»¥å¤ªåŠæºç åˆ†æ&quot;&gt;&lt;a href=&quot;#ä»¥å¤ªåŠæºç åˆ†æ&quot; class=&quot;headerlink&quot; title=&quot;ä»¥å¤ªåŠæºç åˆ†æ&quot;&gt;&lt;/a&gt;ä»¥å¤ªåŠæºç åˆ†æ&lt;/h2&gt;&lt;h3 id=&quot;ä»¥å¤ªåŠç¯å¢ƒæ­å»º&quot;&gt;&lt;a href=&quot;#ä»¥å¤ªåŠç¯å¢ƒæ­å»º&quot; class=&quot;headerlink&quot; title=&quot;ä»¥å¤ªåŠç¯å¢ƒæ­å»º&quot;&gt;&lt;/a&gt;ä»¥å¤ªåŠç¯å¢ƒæ­å»º&lt;/h3&gt;&lt;p&gt;æ­å»ºgoç¯å¢ƒ ç¼–è¯‘æºç &lt;/p&gt;
&lt;p&gt;ç¼–è¯‘å®Œæˆåä¼šç”Ÿæˆä»¥ä¸‹æŒ‡ä»¤&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;p&gt;abigen æºä»£ç ç”Ÿæˆå™¨ï¼Œå°†æ™ºèƒ½åˆçº¦è½¬æ¢ä¸ºGo packageï¼Œç¼–è¯‘Solidityæºæ–‡ä»¶&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;bootnod ç”¨ä½œè½»é‡çº§çš„èŠ‚ç‚¹å¼•å¯¼å·¥å…·&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;evm å¯ä»¥è¿è¡Œå­—èŠ‚ç çš„ä»¥å¤ªåŠè™šæ‹Ÿæœºï¼Œå¯ä»¥å¯¹evmæ“ä½œç è¿›è¡Œå°è£…&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;geth ä»¥å¤ªåŠä¸»è¦çš„æ‰§è¡Œå®¢æˆ·ç«¯ï¼Œå¤šç”¨é€”å‘½ä»¤è¡Œå·¥å…·&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;rlpdump å¼€å‘å®ç”¨å·¥å…·ï¼Œå¯å°†äºŒè¿›åˆ¶RLPï¼ˆé€’å½’é•¿åº¦å‰ç¼€ï¼‰ï¼ˆä»¥å¤ªåŠåè®®ç½‘ç»œä»¥åŠå…±è¯†ä½¿ç”¨çš„æ•°æ®ç¼–ç ï¼‰è½¬å‚¨å­˜è‡³ç”¨æˆ·å‹å¥½çš„åˆ†å±‚è¡¨ç¤º&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;puppeth å‘½ä»¤è¡Œæ‰§è¡Œé¡µé¢çš„å‘å¯¼ç¨‹åºï¼Œç”¨äºåˆ›å»ºæ–°çš„ä»¥å¤ªåŠç½‘ç»œ&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;swarm swarmçš„å®ˆæŠ¤ç¨‹åºå’Œå·¥å…·ï¼ˆswarm æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼å­˜å‚¨å¹³å°å’Œå†…å®¹åˆ†å‘æœåŠ¡ï¼‰&lt;/p&gt;
    
    </summary>
    
      <category term="æŠ€æœ¯" scheme="http://jiaotingyu.me/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
      <category term="Golang" scheme="http://jiaotingyu.me/tags/Golang/"/>
    
      <category term="ä»¥å¤ªåŠ" scheme="http://jiaotingyu.me/tags/%E4%BB%A5%E5%A4%AA%E5%9D%8A/"/>
    
  </entry>
  
</feed>
